!function(){"use strict";angular.module("epguNgRoute",["ngRoute","epguUser"]).config(["$routeProvider","$locationProvider",function(o,e){e.html5Mode(!0).hashPrefix("!");function n(s,l){return["$q","$rootScope","UserService","$http",function(e,t,r,o){var n=e.defer(),i=function(){return!!t.formsWithoutAuth&&-1!=t.formsWithoutAuth.split(",").indexOf(window.location.pathname)},a=function(){t.userLoading?setTimeout(a,50):null==t.user||$.isEmptyObject(t.user)?i()?n.resolve():n.reject({invalidRights:!0}):!l||t.user.al>=l?n.resolve():n.reject({invalidAL:!0})};return s&&!1===t.userLoading&&(t.userLoading=!0,r.load()),a(),n.promise}]}o.whenAuthorized=function(e,t,r){return t.resolve=t.resolve||{},t.resolve.hasRight=n(r),o.when(e,t)},o.whenAuthorizedAL15=function(e,t,r){return t.resolve=t.resolve||{},t.resolve.hasRight=n(r,15),o.when(e,t)},o.whenAuthorizedAL20=function(e,t,r){return t.resolve=t.resolve||{},t.resolve.hasRight=n(r,20),o.when(e,t)},o.otherwise({controller:"error404Ctrl",templateUrl:window.templatePath+(window.mobileVersion?"/tpl/error-mob-b0b987708a.html":"/tpl/error-6622e02a3e.html")})}])}(),function(){"use strict";angular.module("errorPage",["ngRoute"]).config(["$routeProvider",function(e){var t=window.templatePath+(window.mobileVersion?"/tpl/error-mob-b0b987708a.html":"/tpl/error-6622e02a3e.html");e.when("/500",{controller:"error500Ctrl",templateUrl:t}).when("/404",{controller:"error404Ctrl",templateUrl:t})}]).controller("error404Ctrl",["$scope","$rootScope","$location",function(e,t,r){window.location=t.betaUrl+"404"}]).controller("error500Ctrl",["$scope","$rootScope",function(e,t){window.location=t.betaUrl+"500"}])}(),function(){"use strict";angular.module("subscription",["ngRoute"]).config(["$routeProvider",function(e){e.when("/unsubscribe",{controller:"subscriptionCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?"/tpl/subscription-mob-4b3d024995.html":"/tpl/subscription-48108c7dca.html")})}]).controller("subscriptionCtrl",["$scope","$rootScope","$routeParams","$location",function(e,t,r,o){switch(e.routeParams=r,e.loading=!0,e.error=!1,t.breadcrumbs=[],t.pageNameCls="error-page",e.errorImg=t.staticDomainUrl+"htdocs/img/pelmen_sad-39004bcea0.gif",e.status=e.routeParams.status,e.email=e.routeParams.email,e.event=e.routeParams.event,e.status||o.url("/404"),e.status){case"fail":e.header="Не удалось отменить подписку",e.text="Настроить получение предложений и новостей Госуслуг"+(e.email?" на email "+e.email:"")+' можно в <a href="'+t.lkUrl+'notification-setup">личном кабинете</a>',e.buttonTitle="Настройка уведомлений",e.buttonUrl=t.lkUrl+"notification-setup",metricReachGoal24845174("unsubscribe",{unsubscribe_fail:e.event?{event:e.event}:{}});break;case"success":e.header="Подписка отменена",e.text="Вы успешно отказались от получения предложений и новостей Госуслуг на email "+e.email+'.<br>Настройки уведомлений всегда можно изменить в <a href="'+t.lkUrl+'notification-setup">личном кабинете</a>',e.buttonTitle="Каталог услуг",e.buttonUrl=t.betaUrl+"category",metricReachGoal24845174("unsubscribe",{unsubscribe_ok:e.event?{event:e.event}:{}});break;default:r={},o.url("/404")}}])}(),function(){"use strict";angular.module("feedbackPage",["ngRoute","ngUpload","bindHtmlCompile"]).config(["$routeProvider",function(r){var o={"/feedback":{controller:"feedbackCtrl",templateUrl:window.psoFeedbackEnabled?window.templatePath+"/tpl/feedback/notFeedback-d804cd1fd5.html":window.notFeedbackEnabled?window.templatePath+(SmartPhone.isPhone()?"/tpl/feedback/feedback-overload-mob-65c27dd800.html":"/tpl/feedback/feedback-overload-624f37cfaf.html"):window.templatePath+"/tpl/feedback/feedback-2fe7b927c5.html",resolve:{loadFeedbackCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/feedback-07dacba2d4.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/feedback-min-832096ec7c.1682593322983.js")}]}},"/feedback/:result":{controller:"feedbackResultCtrl",templateUrl:window.templatePath+"/tpl/feedback/feedback-result-4a11c815cd.html",resolve:{loadFeedbackCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/feedback-07dacba2d4.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/feedback-min-832096ec7c.1682593322983.js")}]}}};Object.keys(o).forEach(function(e){var t=o[e];t.resolve=t.resolve||{},t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}],r.when(e,o[e]).when(e+"/o/:okato",t)})}])}(),function(){"use strict";angular.module("fnsPage",["ngRoute","ui.mask"]).config(["$routeProvider",function(r){var o={"/10002/1/form":{redirectTo:function(e,t){return t.replace("/10002/1/form","/10002/form")}},"/fnsPay2Error":{controller:"fnsPayErrorCtrl",templateUrl:window.templatePath+"/tpl/fns-pay-error-f04d3b8136.html",resolve:{loadFnsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/fns-dd34d3c12b.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/fns-min-ad3497780b.1682593322983.js")}]}},"/10002/form":{controller:"fnsSearchCtrl",templateUrl:window.templatePath+(window.mobileVersion?"/tpl/fns-search-mob-2a38e53ef7.html":"/tpl/fns-search-52ae78dafe.html"),resolve:{loadFnsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/fns-dd34d3c12b.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/fns-min-ad3497780b.1682593322983.js")}]}},"/10002/form/order/:order":{controller:"fnsSearchCtrl",templateUrl:window.templatePath+(window.mobileVersion?"/tpl/fns-search-mob-2a38e53ef7.html":"/tpl/fns-search-52ae78dafe.html"),resolve:{loadFnsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/fns-dd34d3c12b.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/fns-min-ad3497780b.1682593322983.js")}]}},"/10002/inn":{controller:"innSearchCtrl",templateUrl:window.templatePath+(window.mobileVersion?"/tpl/inn-search-mob-675bc39256.html":"/tpl/inn-search-5f2cdf9d11.html"),resolve:{loadFnsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/fns-dd34d3c12b.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/fns-min-ad3497780b.1682593322983.js")}]}},"/10002/result":{controller:"fnsResultCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()?"/tpl/fns-result-mob-3fa7396814.html":"/tpl/fns-result-pad-d39ba75e1a.html":"/tpl/fns-result-325788ee9c.html"),resolve:{loadFnsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/fns-dd34d3c12b.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/fns-min-ad3497780b.1682593322983.js")}]}},"/10002/result/:informer":{controller:"fnsResultCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()?"/tpl/fns-result-mob-3fa7396814.html":"/tpl/fns-result-pad-d39ba75e1a.html":"/tpl/fns-result-325788ee9c.html"),resolve:{loadFnsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/fns-dd34d3c12b.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/fns-min-ad3497780b.1682593322983.js")}]}}},n=["/10002/1/form","/fnsPay2Error","/10002/form"];Object.keys(o).forEach(function(t){var e;window.redirectMap&&window.redirectMap.some(function(e){return e.from===t})||(e=o[t],"/10002/1/form"!==t&&(e.resolve=e.resolve||{},e.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}]),-1<n.indexOf(t)?r.whenAuthorized(t,o[t]).whenAuthorized(t+"/o/:okato",e):r.whenAuthorizedAL15(t,o[t]).whenAuthorizedAL15(t+"/o/:okato",e))})}])}(),function(){"use strict";angular.module("formServerPage",["ngRoute"]).config(["$routeProvider",function(r){var o={"/10077/1/form":{controller:"universityPageMainCtrl",templateUrl:window.templatePath+"/tpl/university/university-form-4ebdeba591.html",resolve:{loadUniversityPageMainCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/lib/university-b81781199c.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/university-min-1d68009ba0.1682593322983.js")}]}},"/:passportId:\\d{5,6}|mfc/:targetId:\\d{1,3}/form":{controller:"formCtrl",templateUrl:window.templatePath+"/tpl/form-server-c9911ebc36.html",resolve:{loadPlayer:["$ocLazyLoad","$rootScope",function(e,t){return e.load(t.formPlayerUrl+"/player.portal.min.js?"+t.formPlayerResourceVersion)}]}},"/:passportId:\\d{5,6}|mfc/:targetId:\\d{1,3}/order/:orderId":{controller:"formCtrl",templateUrl:window.templatePath+"/tpl/form-server-c9911ebc36.html",resolve:{loadPlayer:["$ocLazyLoad","$rootScope",function(e,t){return e.load(t.formPlayerUrl+"/player.portal.min.js?"+t.formPlayerResourceVersion)}]}},"/:passportId:\\d{5,6}|mfc/:targetId:\\d{1,3}/form/order/:orderId":{controller:"formCtrl",templateUrl:window.templatePath+"/tpl/form-server-c9911ebc36.html",resolve:{loadPlayer:["$ocLazyLoad","$rootScope",function(e,t){return e.load(t.formPlayerUrl+"/player.portal.min.js?"+t.formPlayerResourceVersion)}]}},"/:passportId:\\d{5,6}|mfc/:targetId:\\d{1,3}/booking":{controller:"formCtrl",templateUrl:window.templatePath+"/tpl/form-server-c9911ebc36.html",resolve:{loadPlayer:["$ocLazyLoad","$rootScope",function(e,t){return e.load(t.formPlayerUrl+"/player.portal.min.js?"+t.formPlayerResourceVersion)}]}},"/:passportId:\\d{5,6}/:targetId:\\d{1,3}/mfc":{controller:"formCtrl",templateUrl:window.templatePath+"/tpl/form-server-c9911ebc36.html",resolve:{loadPlayer:["$ocLazyLoad","$rootScope",function(e,t){return e.load(t.formPlayerUrl+"/player.portal.min.js?"+t.formPlayerResourceVersion)}]}}};Object.keys(o).forEach(function(e){var t=o[e];t.resolve=t.resolve||{},t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}],r.whenAuthorized(e,o[e]).whenAuthorized(e+"/o/:okato",t)})}]).controller("formCtrl",["$scope","$rootScope","$routeParams","$location","RegionService","$route","DisclaimerService","CatalogService","UserService","CheckFormLimitations","$q","$timeout",function(g,v,y,b,o,e,n,r,t,i,a,s){g.passCode=y.passportId,g.epguCode=y.targetId,v.pageNameCls="form-server",g.formLoading=!0,v.breadcrumbs=[];function l(e){var t=/(booking|mfc)/.test(b.path())?["EQUEUE_ALTER_new_fs","EQUEUE_MFC_new_fs","EQUEUE_INVITE_new_fs"]:"new_fs",r=["voteDate","startDate","endDate","regNums","oikNums","fedServiceExtId","fedServiceMnemonic","regServiceExtId","regServiceMnemonic","homeVotingServiceExtId","homeVotingServiceMnemonic"],o=(e.data.additionalAttributes&&(P=!!e.data.additionalAttributes.find(function(e){return-1!==t.indexOf(e.name)&&e.value}),C=!!e.data.additionalAttributes.find(function(e){return"in_widget"===e.name&&e.value})),g.version=P?"new":"old",v.breadcrumbs=[],v.serviceGroup=e.data.colorCode,e.data.passport.services.find(function(e){return e.selected}));if(o){var n=function(){y.passportId&&y.targetId&&(b.path("/"+y.passportId+"/"+y.targetId+"/info"),b.replace())};if(/(booking|mfc)/.test(b.path())){var i,a,s=/booking/.test(b.path())?"equeue_alter":"equeue_mfc",l=/booking/.test(b.path())?"equeue_invite":"equeue_mfc",c=new RegExp(s+"_target","i"),u=new RegExp(s+"_mnemonic","i"),d=new RegExp(l+"_target","i"),p=new RegExp(l+"_mnemonic","i"),s=b.search().parentOrderId||"",m=(e.data.additionalAttributes.forEach(function(e){d.test(e.name)&&(i=e.value),p.test(e.name)&&(a=e.value)}),e.data.additionalAttributes.find(function(e){return c.test(e.name)})),h=e.data.additionalAttributes.find(function(e){return u.test(e.name)}),l="equeue_invite"==l&&i&&a&&o.id&&o.id.lid;if(l&&s)m=e.data.additionalAttributes.find(function(e){return d.test(e.name)}),h=e.data.additionalAttributes.find(function(e){return p.test(e.name)});else if(l&&!s&&!m&&!h)return E=!0,g.formLoading=!1,g.errorUrl={title:"Что-то пошло не так",text:"Попробуйте записаться на прием заново."};if(!(m&&h&&o.id&&o.id.lid))return n();w=angular.extend(S,{mnemonic:h.value,serviceTargetExtId:m.value,parentTarget:o.id.lid,parentOrderId:s,parentOrderSelectedRegion:b.search().parentOrderSelectedRegion||"",parentTargetName:o.fullTitle,editLink:b.search().editLink||"",bookId:b.search().bookId||"",isIncomingWidget:C}),T.ext_id&&(w.mfcParentTarget=T.ext_id,(l=e.data.additionalAttributes.find(function(e){return"mfcParentTargetName"===e.name})).value)&&(w.mfcParentTargetName=l.value)}else{if(!/(form|order)/.test(b.path()))return n();{if(!o.id||!o.id.eid)return n();var f={};e.data.additionalAttributes.forEach(function(e){r.includes(e.name)&&(f[e.name]=e.value)}),w=angular.extend(S,{mnemonic:o.id.eid,serviceTargetExtId:o.id.lid,isIncomingWidget:C,electionsSettings:f})}}}}function c(e){var t="/404error";if(e.status)switch(e.status){case 404:b.url(t="/404error");break;case 500:g.errorUrl={title:"Что-то пошло не так",text:"К сожалению, черновик не может быть использован для получения услуги. Пожалуйста, попробуйте получить её заново."};break;default:b.url(t)}}var w,u,S={serviceTargetExtId:y.target,orderId:y.orderId||(b.search().orderId?b.search().orderId:""),rURL:b.search().rURL||""},P=!1,C=!1,E=!1,T={};y.passportId&&y.targetId&&(u=function(e){g.regionNotSupported=!0,g.formLoading=!1,g.noSubscribeRegion=e},i.checkLimitations(y.passportId,y.targetId,y.orderId).then(function(){var e=b.search(),t=a.defer();"mfc"===y.passportId?e.mfcCode||e.ext_id?(T[e.mfcCode?"mfcCode":"ext_id"]=e.mfcCode||e.ext_id,o.checkRegionHasMfc().then(t.resolve,function(){u(!0),t.reject()})):(c({status:404}),t.reject()):t.resolve(),t.promise.then(function(){r.getService(y.passportId,y.targetId,null,null,!1,T).then(function(t){var e;function r(){E||(P?(g.formConfig=w,g.formLoading=!1):(window._oldLoaded?g.formConfig=w:__oldFormPlayer(function(){window._oldLoaded=!0,$.each(PGU.form,function(e,t){"function"==typeof t&&t.inherits&&t.inherits(PGU.form.Base)&&!t.hasOwnProperty("className")&&(t.prototype.className=e)}),g.formConfig=w,v.$$phase||g.$apply()}),$(document).on("form-server-loaded",function(){g.$$phase?g.formLoading=!1:g.$apply(function(){g.formLoading=!1})}),$(document).on("form-server-error",function(e,t){g.$$phase?(g.formLoading=!1,g.error=t,g.error.title=t.title||"Что-то пошло не так"):g.$apply(function(){g.formLoading=!1,g.error=t,g.error.title=t.title||"Что-то пошло не так"})}),$(document).on("payment-init-call",function(e,t){v.initPayment(t.uin,!1,"","",t.customAbsUrl,t.customAdditionalAttrs)})))}t&&t.data&&"group"===t.data.responseType?b.path("/"+y.passportId+"/"+y.targetId):(t&&t.data.passport&&t.data.passport.id&&v.$emit("withFRGUServiceID-event",t.data.passport.currentServiceTargetExtId),e=(e=t.data.additionalAttributes.find(function(e){return"EQUEUE_ALTER_MNEMONIC"==e.name&&e.value}))&&e.value?e.value:"",(e=window.location.href.indexOf("/booking")<0?"":e)&&t.data.passport&&t.data.passport.icons&&t.data.passport.icons.length?v.passportIcons=t.data.passport.icons:v.passportIcons=[],n.serviceDisclaimerApi(t.data.stateOrg[t.data.stateOrg.length-1].id,t.data.passport.id,t.data.passport.currentServiceTargetExtId,e),t.data&&t.data.description&&t.data.description.paymentInfo&&(v.paymentInfo=t.data.description.paymentInfo.payments),t&&t.data&&t.data.passport&&Array.isArray(t.data.passport.services)&&(v.servicesIdFRGU=t.data.passport.id,t.data.additionalAttributes.find(function(e){return"REGION_CHECK"==e.name&&e.value})?(g.regionNotSuppportedError=null,o.check(!0,y.passportId,y.targetId).then(function(e){!e||e.errorCode?(u(),e&&e.errorCode&&(g.regionNotSuppportedError=e)):(l(t),r())})):(l(t),r())))},c)})},function(e){400===e.status&&(g.errorUrl={title:"Подача услуги невозможна",text:e.data.error})})),v.$on("region-changed",function(){e.reload()})}]).directive("epguFormPlayer",[function(){function e(e,t,o,r,n,i){function a(){o.formConfig=angular.extend(o.formConfig,{user:t.user,esia:t.originalUserData,logined:t.logined,assuranceLevel:t.assuranceLevel,globalRole:t.globalRole,orgType:t.orgType,scopeFNS:t.scopeFNS,siaWebHost:t.siaWebHost,siaWebHostEdit:t.lcUrl,lkUrl:t.lkUrl,totalOrderFileSize:t.totalOrderFileSize,geoCodingCacheEnabled:t.geoCodingCacheEnabled,userSelectedRegion:t.userSelectedRegion,userSelectedRegionName:t.userSelectedRegionName,lkApiUrl:t.lkApi,nsiApiUrl:t.nsiApi,electionApiUrl:t.electionApiUrl,catalogApiUrl:t.catalogApi,paymentInfo:t.paymentInfo,timingApi:t.timingApi,discountEnabled:t.discountEnabled,urlParams:n.$$search,passportIcons:t.passportIcons,esepPopupFormUrl:t.esepPopupFormUrl,smsNotificationsEnabled:t.smsNotificationsEnabled,thankYouPageDelay:+t.thankYouPageDelay,yandexMapsApiKey:t.yandexMapsApiKey,enterpriseYandexMapsEnabled:t.enterpriseYandexMapsEnabled,orderSmsConfRestrictionPerUser:t.orderSmsConfRestrictionPerUser,orderSmsConfDaysRestriction:t.orderSmsConfDaysRestriction,sopUrl:t.sopUrl,sopTestUrl:t.sopTestUrl,sopAuthData:t.sopAuthData,globalSFDadataDebounce:t.globalSFDadataDebounce,sessionToken:t.settings&&t.settings.accessToken||readCookie("acc_t")}),"new"!=o.version&&(FormPlayer.env.timingApi=t.timingApi,FormPlayer.initialize(o.formConfig),PGU.Events.subscribe(":quizEnabled",function(e,t){o.$apply(function(){o.quizEnabled=!0})})),o.quiz={passportId:i.passportId,targetId:i.targetId,quizNeedOffset:!0}}t.$on(":quizEnabled",function(){o.quizEnabled=!0}),e.afterLoad().then(function(){var r;o.formConfig?a():r=o.$watch("formConfig",function(e,t){e&&(a(),r())})})}return e.$inject=["UserService","$rootScope","$scope","$timeout","$location","$routeParams"],{template:'<div> <div data-ng-show="!settings && !error" data-throbber="throbber-big" data-show-heading="true"></div>   <epgu-widget  epgu-settings="formConfig" data-ng-if="formConfig && version == \'new\'"></epgu-widget>   <div data-ng-show="version == \'old\' && formConfig">       <div class="pf-form"></div>       <input id="baseUrl" type="hidden" type="text" value="/modules/"/>   </div>   <div class="form-server-quiz"><epgu-quiz data-ng-if="quizEnabled" quiz="quiz" check=true></epgu-quiz></div></div>',controller:e,scope:{formConfig:"=",version:"@",error:"@"}}}])}(),function(){"use strict";angular.module("fsspPage",["ngRoute","ui.mask"]).config(["$routeProvider",function(r){var o={"/10003/1/form":{redirectTo:function(e,t){return t.replace("/10003/1/form","/10003/form")}},"/10003/form":{controller:"fsspSearchCtrl",templateUrl:window.templatePath+(window.mobileVersion?"/tpl/fssp-search-mob-650a3d2e72.html":"/tpl/fssp-search-853a7ef01d.html"),resolve:{loadFsspCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/fssp-f86dfda21b.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/fssp-min-8b965bec7e.1682593322983.js")}]}},"/10003/form/order/:order":{controller:"fsspSearchCtrl",templateUrl:window.templatePath+(window.mobileVersion?"/tpl/fssp-search-mob-650a3d2e72.html":"/tpl/fssp-search-853a7ef01d.html"),resolve:{loadFsspCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/fssp-f86dfda21b.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/fssp-min-8b965bec7e.1682593322983.js")}]}},"/10003/result":{controller:"fsspResultCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()?"/tpl/fssp-result-mob-c26b30b5e9.html":"/tpl/fssp-result-pad-d1bbeb38eb.html":"/tpl/fssp-result-fa5be3ec53.html"),resolve:{loadFsspCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/fssp-f86dfda21b.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/fssp-min-8b965bec7e.1682593322983.js")}]}},"/10003/result/:informer":{controller:"fsspResultCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()?"/tpl/fssp-result-mob-c26b30b5e9.html":"/tpl/fssp-result-pad-d1bbeb38eb.html":"/tpl/fssp-result-fa5be3ec53.html"),resolve:{loadFsspCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/fssp-f86dfda21b.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/fssp-min-8b965bec7e.1682593322983.js")}]}}};Object.keys(o).forEach(function(t){var e;window.redirectMap&&window.redirectMap.some(function(e){return e.from===t})||(e=o[t],"/10003/1/form"!==t&&(e.resolve=e.resolve||{},e.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}]),r.whenAuthorized(t,o[t]).whenAuthorized(t+"/o/:okato",e))})}])}(),function(){"use strict";angular.module("gibddPage",["ngRoute","ui.mask","yaMap","ngAnimate"]).config(["$routeProvider",function(r){var o={"/10001/1/form":{redirectTo:function(e,t){return t.replace("/10001/1/form","/10001/form")}},"/10001/form":{controller:"gibddSearchCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()?"/tpl/gibdd/gibdd-search-mob-95c9c0c91d.html":"/tpl/gibdd/gibdd-search-pad-50961b9f5b.html":"/tpl/gibdd/gibdd-search-67777b3d2a.html"),resolve:{loadGibddCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/gibdd-2c8943d24f.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/gibdd-min-346996dfb0.1682593322983.js")}]}},"/10001/form/order/:order":{controller:"gibddSearchCtrl",templateUrl:window.templatePath+(window.mobileVersion?"/tpl/gibdd/gibdd-search-mob-95c9c0c91d.html":"/tpl/gibdd/gibdd-search-67777b3d2a.html"),resolve:{loadGibddCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/gibdd-2c8943d24f.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/gibdd-min-346996dfb0.1682593322983.js")}]}},"/10001/result":{controller:"gibddResultCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()?"/tpl/gibdd/gibdd-result-mob-b9dd3d401e.html":"/tpl/gibdd/gibdd-result-pad-a8e0833a60.html":"/tpl/gibdd/gibdd-result-626aabaa7a.html"),reloadOnSearch:!1,resolve:{loadGibddCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/gibdd-2c8943d24f.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/gibdd-min-346996dfb0.1682593322983.js")}]}},"/10001/result/:informer":{controller:"gibddResultCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()?"/tpl/gibdd/gibdd-result-mob-b9dd3d401e.html":"/tpl/gibdd/gibdd-result-pad-a8e0833a60.html":"/tpl/gibdd/gibdd-result-626aabaa7a.html"),reloadOnSearch:!1,resolve:{loadGibddCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/gibdd-2c8943d24f.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/gibdd-min-346996dfb0.1682593322983.js")}]}},"/10001/details":{controller:"gibddDetailsCtrl",templateUrl:window.templatePath+"/tpl/gibdd/gibdd-details-mob-cfd571675d.html",reloadOnSearch:!1,resolve:{loadGibddCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/gibdd-2c8943d24f.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/gibdd-min-346996dfb0.1682593322983.js")}]}},"/10001/map":{controller:"gibddMapCtrl",templateUrl:window.templatePath+"/tpl/gibdd/gibdd-map-mob-a742ede393.html",reloadOnSearch:!1,resolve:{loadGibddCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/gibdd-2c8943d24f.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/gibdd-min-346996dfb0.1682593322983.js")}]}},"/10001/article":{controller:"gibddArticleCtrl",templateUrl:window.templatePath+"/tpl/gibdd/gibdd-article-mob-1ae776af49.html",reloadOnSearch:!1,resolve:{loadGibddCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/gibdd-2c8943d24f.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/gibdd-min-346996dfb0.1682593322983.js")}]}}};Object.keys(o).forEach(function(t){var e;window.redirectMap&&window.redirectMap.some(function(e){return e.from===t})||(e=o[t],"/10001/1/form"!==t&&(e.resolve=e.resolve||{},e.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}]),r.whenAuthorized(t,o[t]).whenAuthorized(t+"/o/:okato",e))})}])}(),function(){"use strict";angular.module("indexPage",["ngRoute","ngAnimate"]).directive("easter",function(){function e(t,r,e){t.show=!1,r.bind("click",function(){t.show||(t.$apply(function(){t.show=!0;var e=$('<img src="'+window.stylePath+"/img/animation_hand_"+(Math.round(2*Math.random())+1)+'.gif"/>');r.append(e)}),setTimeout(function(){t.$apply(function(){t.show=!1,r.empty()})},3300))})}return e.$inject=["$scope","$element","$rootScope"],{template:'<div class="easter-egg"></div>',restrict:"E",replace:!0,controller:e}}).config(["$routeProvider",function(e){var t;"PARTNERS"!==window.viewType&&(t={controller:"indexCtrl",templateUrl:window.templatePath+"/tpl/index/index-71c7d90d28.html",resolve:{loadProfileNotificationsCtrl:["$ocLazyLoad","$rootScope","GetLazyLoadFile",function(e,t,r){return!t.userId||r.get(window.templatePath+"/js/js/profile-notifications-6d8c2d3e58.1682593322983.js",window.templatePath+"/js/lib/profile-notifications-min-c1078547ce.1682593322983.js")}],checkRegionCtrl:["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}]},reloadOnSearch:!1},e.when("/",t).when("/r/:region",t).when("/o/:okato",t))}]).controller("indexCtrl",["$scope","$rootScope","$http","$timeout","CatalogService","CMSService","$location","InformersService","ThrobberService","userTypeService","PopularSpriteIconList","FilteredFeedState","ShowLkFeeds","MainPageMetric","MainPageService","MainPageSeoService","LkService","ToggleCookie",function(i,a,e,r,t,o,n,s,l,c,u,d,p,m,h,f,g,v){!a.nodejsEnabled||"/"!==location.pathname||"P"!==c.getUserType().userTypeGosBar||a.userId||a.userType&&"P"!==a.userType||location.reload();var y=c.getUserType().rootPath;function b(){var e,t="/"==n.path()||-1!=n.path().indexOf("/r/")?s.getMessagesWithDuty:s.getMessages,r=[];for(e in t)"D"!=t[e].object.state&&r.push(t[e]);return r.length||a.$emit("informerStatus",!1),r}"/"!=c.getUserType().rootPath&&n.path(y),a.goToNewPortal=function(){location.href="/new"},a.breadcrumbs=[],a.pageNameCls="index-page",i.currentBanner=0,i.loading=!0,i.popularActive=!0,i.popularSwitcher={toggle:function(e){(i.popularActive=e)?m.send("services"):(m.send("situation"),this.getSituations())},getSituations:function(){i.popularSituation||(i.situationThrobber=!0,t.getPopularOccasions(c.getUserType().occasionType).then(function(e){e&&e.data&&(i.situationThrobber=!1,i.popularSituation=e.data)}))}},i.setPopularOffset=function(e){return"dk"===a.version?e%3==0||(2*e+1)%3==0:"pad"===a.version&&e%3==0},i.sendFeedMetric=function(){m.send("feedRow")},i.sliderThrobber=l.setThrobber("sliderThrobber"),i.popularThrobber=l.setThrobber("popularThrobber"),i.lines="dk"==a.version?3:"pad"==a.version?4:9,i.direction="right",i.getImageFormSprite=function(e){return-1!=u.list.indexOf(e)},i.setImageSpriteCls=function(e){return"sprite-icon-"+e},i.setNotificationsLink=function(){p.init()},a.mainServiceData&&!a.mainServiceData.P&&h.clear(),(a.userId||"P"===c.getUserType().userTypeGosBar?t.getPopular:h.getAll)().then(function(e){e&&(i.popular=a.userId||"P"===c.getUserType().userTypeGosBar?e.data:e.popular),i.loading=!1,i.popularThrobber=l.toggleThrobber("popularThrobber",function(e){i.sliderThrobber=e})},function(){i.loading=!1,i.errorMainPageService=!0,i.popularThrobber=l.toggleThrobber("popularThrobber",function(e){i.sliderThrobber=e})}),a.detectRegionDf.promise.then(function(){o.getTargetPlaces("main_banner_1,main_banner_2,main_banner_3,main_banner_4,main_banner_faq,main_banner_seo,school2019,main_banner_2_POS,main_banner_complaints").then(function(t){Object.keys(t).forEach(function(e){i[e]=t[e].list,"main_banner_4"!==e&&(i[e+"_len"]=t[e].list?t[e].list.length:0),0==t[e].list.length&&(i[e]=t[e][e+"_bg"])}),r(function(){i.sliderThrobber=l.toggleThrobber("sliderThrobber",function(e){i.popularThrobber=e})})},function(){i.sliderThrobber=l.toggleThrobber("sliderThrobber",function(e){i.popularThrobber=e})})}),a.$on("informerStatus",function(e,t){i.informerDuty.loading||(i.initInformer=!0,i.isActiveInformer=t,a.isActiveInformer=t)}),a.userId&&(i.informers=b(),i.informerDuty={loading:!0,hide:!1},i.mainInformers={sortInformers:function(){var e=b(),t=e.pop(),r=[],o=[],n=[];e.forEach(function(e){(parseFloat(e.object.data.total)?r:o).push(e)}),(n=n.concat(r,o)).push(t),4==n.length&&i.informerDutyEnabled&&n.splice(3,1),1!=n.length||i.informerDutyEnabled||i.informerDuty.loading?(i.isActiveInformer=!0,a.isActiveInformer=!0):(i.isActiveInformer=!1,a.isActiveInformer=!1),i.mainInformers.informers=n}},i.$watch("informers",function(){i.mainInformers.sortInformers()},!0),a.$on("informerDutyEnabled",function(e,t){i.informerDutyEnabled=!0,i.mainInformers.sortInformers(),t||m.send("informerShow","service")}),a.$on("informerDutyDisabled",function(){i.informerDutyEnabled=!1,i.informerDuty=!1,i.mainInformers.sortInformers()})),f.setSeoInfo()}]).config(["$routeProvider",function(r){var o={"/entrepreneur":{controller:"legalIndexCtrl",templateUrl:window.templatePath+"/tpl/index/index-legal-1057f5eeb4.html",resolve:{loadProfileNotificationsCtrl:["$ocLazyLoad","$rootScope","GetLazyLoadFile",function(e,t,r){return!t.userId||r.get(window.templatePath+"/js/js/profile-notifications-6d8c2d3e58.1682593322983.js",window.templatePath+"/js/lib/profile-notifications-min-c1078547ce.1682593322983.js")}],checkRegionCtrl:["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}]}},"/legal-entity":{controller:"legalIndexCtrl",templateUrl:window.templatePath+"/tpl/index/index-legal-1057f5eeb4.html",resolve:{loadProfileNotificationsCtrl:["$ocLazyLoad","$rootScope","GetLazyLoadFile",function(e,t,r){return!t.userId||r.get(window.templatePath+"/js/js/profile-notifications-6d8c2d3e58.1682593322983.js",window.templatePath+"/js/lib/profile-notifications-min-c1078547ce.1682593322983.js")}],checkRegionCtrl:["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}]}}};Object.keys(o).forEach(function(e){var t=o[e];t.resolve=t.resolve||{},t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}],r.when(e,o[e]).when(e+"/o/:okato",t)})}]).controller("legalIndexCtrl",["$scope","$rootScope","$http","$timeout","CatalogService","CMSService","$location","InformersService","ThrobberService","userTypeService","PopularSpriteIconList","FilteredFeedState","ShowLkFeeds","MainPageMetric","MainPageService","MainPageSeoService","KndInformerService","$q",function(i,t,e,o,r,n,a,s,l,c,u,d,p,m,h,f,g,v){t.breadcrumbs=[],i.currentBanner=0,i.loading=!0,i.partnersDomen=t.partnersUrl.replace(/\/$/g,"");var y={L:{path:"/legal-entity",bannerPlaces:"main_banner_1_EMPLOYEE,main_banner_2_EMPLOYEE,main_banner_3_EMPLOYEE,main_banner_4_EMPLOYEE,main_banner_faq_EMPLOYEE,main_banner_seo_EMPLOYEE,main_banner_links_EMPLOYEE",postfix:"_EMPLOYEE",informers:["gibdd","receipt"]},B:{path:"/entrepreneur",bannerPlaces:"main_banner_1_BUSINESSMAN,main_banner_2_BUSINESSMAN,main_banner_3_BUSINESSMAN,main_banner_4_BUSINESSMAN,main_banner_faq_BUSINESSMAN,main_banner_seo_BUSINESSMAN,main_banner_links_BUSINESSMAN",postfix:"_BUSINESSMAN",informers:["gibdd","fssp","receipt"]}},b=y.L.path===a.path()?"L":"B",w=y[b];function S(){var e,t=s.getMessagesWithDuty,r=[];for(e in t)("D"!=t[e].object.state&&-1!==w.informers.indexOf(e)&&i.userCanSeeInformers||"receipt"===e)&&r.push(t[e]);return r}function P(){var e=!!t.user.groups&&t.user.groups.find(function(e){return["ESIA","PGU"].includes(e.itSystem)&&"ORG_ADMIN"===e.grp_id});i.userCanSeeInformers=(t.user.isOrgChief||e)&&t.userType===b&&t.userId&&!t.user.branchOid,i.informers=(i.informers=S(),i.mainInformers={sortInformers:function(){var e=S(),t=e.pop(),r=[],o=[],n=[];e.forEach(function(e){(parseFloat(e.object.data.total)?r:o).push(e)}),(n=n.concat(r,o)).push(t),i.mainInformers.informers=n}},void i.$watch("informers",function(){i.mainInformers.sortInformers()},!0)),i.userCanSeeInformers&&!t.informerKnd&&(t.informerKnd={data:"",state:"U",title:"Информация о проверках",updateMessage:"Идет поиск"},g.getInformerData().then(function(e){(t.informerKnd=e)&&"F"!=e.state&&"D"!=e.state&&(t.informerKnd.informerData=t.informerKnd.getStatuses())}).catch(function(e){t.informerKnd.state="F",console.log("checkRightsAndShowInformers - error",e)}),g.getRisksCount().then(function(e){t.knoRisksCount=e&&e.data&&e.data.orgRiskCount}))}t.userTypeGosBar!=b&&(t.userTypeGosBar=b),i.fromMainType="B"==b?"emain":"lmain",t.pageNameCls="index-page "+("L"==b?"ul-main-page":"ip-main-page"),i.setNotificationsLink=function(){p.init()},i.sliderThrobber=l.setThrobber("sliderThrobber"),i.popularThrobber=l.setThrobber("popularThrobber"),t.detectRegionDf.promise.then(function(){n.getTargetPlaces(w.bannerPlaces).then(function(e){for(var t in e){var r=t.replace(w.postfix,"");i[r]=e[t].list,"main_banner_4"!==r&&(i[r+"_len"]=e[t].list?e[t].list.length:0),0==e[t].list.length&&(i[r]=e[t][t+"_bg"])}o(function(){i.sliderThrobber=l.toggleThrobber("sliderThrobber",function(e){i.popularThrobber=e})})},function(){i.sliderThrobber=l.toggleThrobber("sliderThrobber",function(e){i.popularThrobber=e})})}),t.userId&&(Object.keys(t.user).length&&!t.userLoading?P():t.$on("user-loaded",P)),i.setPopularOffset=function(e){return"dk"===t.version?e%3==0||(2*e+1)%3==0:"pad"===t.version&&e%3==0},i.popular=[],t.mainServiceData&&!t.mainServiceData[b]&&h.clear(),h.getAll().then(function(e){e&&(i.popularSrv=t.userId?e.popularAuth:e.popular,i.popularLs=e.ls||[],i.partnersSrv=e.partners&&e.partners.products||[],i.popularThrobber=l.toggleThrobber("popularThrobber",function(e){i.sliderThrobber=e}),i.loading=!1)}).catch(function(e){i.errorMainPageService=!0,console.log(e)}),i.popularActive=!0,i.popularSwitcher=function(e){(i.popularActive=e)?m.send("services"):(m.send("situation"),m.legalEntitySend("Жизненные ситуации","Вкладка ЖС"))},i.howToRegister=function(e){e&&(e.preventDefault(),e.stopPropagation()),m.legalEntitySend("Как зарегистрироваться"),location.href="help/faq/popular/1"},i.bannerClick=function(e,t){var r;"A"===e.target.tagName&&(m.legalEntitySend((r={banner:{text:"Баннеры",key:"href"},business:{text:"Рекомендуем для бизнеса",key:"innerText"},useful:{text:"Полезные ссылки для юридических лиц",key:"innerText"}})[t].text,e.target[r[t].key]),e.stopPropagation())},i.itemClick=function(e,t,r,o){e&&(e.preventDefault(),e.stopPropagation()),m.legalEntitySend(t,r),location.href=o}}]).factory("MainPageSeoService",["$rootScope","$location",function(r,o){return{setSeoInfo:function(){var e,t={metaTitle:"Портал государственных услуг Российской Федерации",metaDescription:"Единый портал государственных услуг для жителей Российской Федерации. На портале госуслуг можно записаться к врачу, получить загранпаспорт, записать ребенка в детский сад, проверить и оплатить штрафы или судебную задолженность.",metaKeyWords:"госуслуги, госпортал, государственные услуги, главная страница"};r.manualRegions&&(e=r.manualRegions[o.$$path.replace("/r/","")])&&e.cases&&(t.metaTitle=t.metaTitle.replace("Российской Федерации",e.cases[1]),t.metaDescription=t.metaDescription.replace("Российской Федерации",e.cases[1]),t.metaKeyWords=t.metaKeyWords+", "+e.cases[0]),updateSeoData(t)}}}])}(),function(){"use strict";angular.module("landingPage",["ngRoute"]).config(["$routeProvider",function(e){window.isLk&&e.when("/profile/landing",{controller:"landingCtrl",templateUrl:window.templatePath+(window.mobileVersion?"/tpl/landing-mob-ec343b53dc.html":"/tpl/landing-5b51295299.html")}).when("/profile/landing/o/:okato",{controller:"landingCtrl",templateUrl:window.templatePath+(window.mobileVersion?"/tpl/landing-mob-ec343b53dc.html":"/tpl/landing-5b51295299.html"),resolve:{checkRegionCtrl:["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}]}})}]).controller("landingCtrl",["$scope","$rootScope","$location",function(e,t,r){t.breadcrumbs=[],t.pageNameCls="landing-page"}])}(),function(){"use strict";angular.module("paymentPage",["ngRoute"]).factory("PaymentService",["$rootScope","$location","$routeParams","$http","$anchorScroll","PerformanceService","$moment","ToggleCookie","NewPaySwitcher",function(h,f,g,v,i,y,b,e,s){var w={phone:h.user.mobilePhone,requestCommissions:!1,canPay:!0,metersValid:!0,meters:[],metersRequired:!1,metersActive:!1,isFk:!1,showQuittance:!0};function n(e){return!isNaN(e.summ)&&(null==e.amountMin||e.summ>=e.amountMin)&&(null==e.amountMax||e.summ<=e.amountMax)}function S(e,t){var r,o,t=(r="multi"==t?e:w.billSumms).main;if(t)return o=0,r.approvedSums=[],e=r.details||[],w.canPay=!0,t.isEditable||0==e.length?n(t)?(o=t.summ,r.approvedSums.push({summId:t.summId,amount:t.summ}),angular.forEach(e,function(e){r.approvedSums.push({summId:e.summId,amount:e.summ})})):w.canPay=!1:(o=0,angular.forEach(e,function(e){n(e)?(o=(+o+ +e.summ).toFixed(2),r.approvedSums.push({summId:e.summId,amount:e.summ})):w.canPay=!1}),r.approvedSums.push({summId:t.summId,amount:o})),e=r.additional,angular.forEach(e,function(e){e.enabled?n(e)?(r.approvedSums.push({summId:e.summId,amount:e.summ}),o+=e.summ):w.canPay=!1:e.visible||r.approvedSums.push({summId:e.summId,amount:e.summ})}),o}function P(e){if(w.payMethodGroups={bankCard:{title:"Оплата банковской картой",label:"Банковская карта",icons:["MC","MA","VISA","MIR"]},payService:{title:"Оплата через платежный сервис",label:"Платежный сервис",icons:[]},mphone:{title:"Оплата со счета мобильного телефона",label:"Мобильный платеж",icons:[]},emoney:{title:"Оплата электронным кошельком",label:"Электронный кошелек",icons:[]}},e.payOptions&&0<e.payOptions.length){w.myTypes=[],w.operatorsArr=[],w.emoneyArr=[],w.payServicesArr=[],w.types={},w.hasPayOptions=!0,angular.forEach(e.payOptions,function(e){var t;e.paymentInstrument?(w.myTypes.push(e),(w.types[e.paymentInstrument.code]=e).code=e.paymentInstrument.code,t=e.cardInfo&&e.cardInfo.cardTypeCode&&e.cardInfo.cardTypeCode.toUpperCase(),e.itemTitle=e.paymentInstrument.name&&e.paymentInstrument.name.slice(-4),e.cardTitle="**** "+e.itemTitle,e.icon=t):"MPHONE"===e.payMethodGroup.code?(w.types[e.paySystem.code]=e,(w.operators[e.paySystem.code]=e).code=e.paySystem.code,e.itemTitle=e.paySystem.name,e.icon=e.paySystem.code.replace("pps_mts_","").toUpperCase(),w.operatorsArr.push(e),w.payMethodGroups.mphone.icons.push(e.icon)):"EMONEY"===e.payMethodGroup.code?(w.types[e.payMethod.code]=e,(w.emoney[e.payMethod.code]=e).code=e.payMethod.code,e.itemTitle=e.payMethod.name,e.icon=e.payMethod.code.toUpperCase(),w.emoneyArr.push(e),w.payMethodGroups.emoney.icons.push(e.icon)):"CONTACTLESS"===e.payMethodGroup.code?(e.payMethod.code="GooglePay_mobi"===e.payMethod.code?"GOOGLE_PAY":e.payMethod.code,"GOOGLE_PAY"===e.payMethod.code.toUpperCase()&&SmartPhone.isIOS()||(w.types[e.payMethod.code]=e,(w.payServices[e.payMethod.code]=e).code=e.payMethod.code,e.itemTitle=e.payMethod.name,e.icon=e.payMethod.code.toUpperCase(),w.payServicesArr.push(e),w.payMethodGroups.payService.icons.push(e.icon))):(w.types[e.payMethod.code]=e).code=e.payMethod.code}),w.tabs=[],w.payMethodsArr={};var t,e=[];if(w.myTypes&&w.myTypes.length&&w.types.BANK_CARD&&(e=w.myTypes.slice()).sort(o),w.types.BANK_CARD&&((t=angular.copy(w.types.BANK_CARD)).itemTitle="Другая карта",t.new_card=!0,e.push(t),w.payMethodsArr.bankCard=e),w.operatorsArr.length?w.payMethodsArr.mphone=w.operatorsArr:delete w.payMethodGroups.mphone,w.emoneyArr.length?w.payMethodsArr.emoney=w.emoneyArr:delete w.payMethodGroups.emoney,w.payServicesArr.length?w.payMethodsArr.payService=w.payServicesArr:delete w.payMethodGroups.payService,w.payMethodGroupsCount=Object.keys(w.payMethodGroups).length,w.tabs.length){if(w.tabsModel){for(var r=0;r<w.tabs.length;r++)if(w.tabsModel.code==w.tabs[r].code){w.tabsModel=w.tabs[r];break}}else w.tabsModel=w.tabs[0];w.activTab||(w.activTab=w.tabs[0].code)}if(w.activeGroup||(w.activeGroup="bankCard",w.lastActiveGroup="bankCard",w.groupToSelect="bankCard"),w.selectedItem&&w.selectedItem.code){for(r=0;r<w.payMethodsArr[w.activeGroup].length;r++)if(w.selectedItem.code===w.payMethodsArr[w.activeGroup][r].code){w.selectedItem=w.payMethodsArr[w.activeGroup][r];break}}else w.selectedItem=w.payMethodsArr.bankCard[0];w.types.BANK_CARD||0!==w.operatorsArr.length||0!==w.emoneyArr.length||(w.hasPayOptions=!1),w.placeholders={bankCard:"",mphone:"Выберите оператора",emoney:"Выберите систему"}}else w.hasPayOptions=!1}function o(e,t){return t.code-e.code}function C(e,t){for(var r="multi"===t?w.bills[e.billId]:w,o=!1,n=0;n<e.billSumm.amounts.length;n++){var i=e.billSumm.amounts[n];i.enabled=!0,i.visible=!0,r.billSumms.details||(r.billSumms.details=[]),r.billSumms.additional||(r.billSumms.additional=[]),i.isDetalisation?(r.billSumms.details.push(i),!o&&i.isEditable&&(o=!0)):i.sumType&&"MAIN"==i.sumType.code?r.billSumms.main=i:(r.billSumms.additional.push(i),i.enabled=!1),i.isEditable&&"multi"!==t&&(r.details.sumIsEditable=!0,i.summInput={hideErrorsOnBlur:!0,money:!0,modelOptions:"{updateOn: 'default blur',debounce: {'default': 700,'blur': 0}}"},i.amountMin&&(i.summInput.min=parseFloat(i.amountMin)),i.amountMax)&&(i.summInput.max=parseFloat(i.amountMax))}r.billSumms.main.isEditable&&o&&(r.billSumms.main.isEditable=!1),r.total=r.billSumms.main.summ}function a(e){e=e.split("-");return new Date(e[1]+"/"+e[2]+"/"+e[0])}function l(e){var t=[];return t.push({index:0,name:"января"}),t.push({index:1,name:"февраля"}),t.push({index:2,name:"марта"}),t.push({index:3,name:"апреля"}),t.push({index:4,name:"мая"}),t.push({index:5,name:"июня"}),t.push({index:6,name:"июля"}),t.push({index:7,name:"августа"}),t.push({index:8,name:"сентября"}),t.push({index:9,name:"октября"}),t.push({index:10,name:"ноября"}),t.push({index:11,name:"декабря"}),(e.getDate()+" "+t[e.getMonth()].name+" "+e.getFullYear()).toLowerCase()}function E(e,t){var r="multi"===t?w.bills[e.billId]:w;if(r.isDiscountApplied=!1,r.discountDateAsString=void 0,r.originalAmount=void 0,r.isMultiplierSize=!1,r.portalDiscountValue=null,e&&e.addAttrs&&e.addAttrs.attrs){for(var o=void 0,n=0;n<e.addAttrs.attrs.length;n++){var i=e.addAttrs.attrs[n];"OriginalAmount"==i.name&&(r.originalAmount=parseFloat(Math.round(100*i.value)/100).toFixed(2),r.isDiscountApplied=!0),"DiscountDate"==i.name&&(o=a(i.value),r.discountDate=o),"MultiplierSize"==i.name&&(r.isMultiplierSize=!0,r.portalDiscountValue=i.value+"%"),"DiscountSize"==i.name&&(r.gibddDiscountValue=i.value+"%"),"ReceiverPdfName"==i.name&&(e.ReceiverPdfName=r.ReceiverPdfName=i.value),"type_doc"==i.name&&(e.docType=i.value),"number_doc"==i.name&&(e.docNumber=i.value)}r.isDiscountApplied&&!r.isMultiplierSize&&(r.discountDateAsString=l(o),r.discountDateFormated=b(r.discountDate).format("DD.MM.YYYY")),r.isDiscountApplied&&r.isMultiplierSize&&(r.portalDiscount=!0)}}h.$on("user-loaded",function(){w.phone=h.user.mobilePhone});var c={};return{data:w,billById:!1,isGkh:!1,initPayment:function(e,t,r,o,n,i){var a;h.isEmbeddedZkh?(h.ipshAdditionalAttrs=r,w.serviceUrl=n||f.absUrl(),c.fromPlayerForm=!!n,c.returnUrl=c.fromPlayerForm&&w.serviceUrl||"",a={breadcrumbs:h.breadcrumbs,group:h.serviceGroup},c[e]=a,sessionStorage.getItem("multipay")&&sessionStorage.removeItem("multipay"),h.multiPayRetrunUrl=void 0,"/pay"!==f.path()||h.disableMetric?document.getElementById("pay_with_uin_gibdd")&&!h.disableMetric?metricReachGoal("gibdd_uin"):document.getElementById("pay_with_uin_fns")&&!h.disableMetric?metricReachGoal("tax_uin"):document.getElementById("pay_with_uin_fssp")&&!h.disableMetric&&metricReachGoal("law_uin"):metricReachGoal("pay_goto_uin"),t?f.url("/payment/"+e).search("details","1"):$("html").is(".ie9")?f.url("/payment/"+e):o?"geps"==o?f.url("/payment/"+e).search("details","1"):f.url("/payment/"+e).search({details:"1",utm_source:o}):i?f.url("/payment/"+e).search(i):f.url("/payment/"+e)):s.initPaymentNew(e,t,r,o,n,i)},initMultiPay:function(e,t,r,o){h.multiPayIds=e,h.ipshAdditionalAttrs=t,h.multiPayRetrunUrl=o,sessionStorage.setItem("multipay",JSON.stringify({ids:e,returnUrl:o})),f.url("/payment/multiPay").search({utm_source:r})},calculateTotal:S,getCommissions:function(){var e;w.canPay&&(w.requestCommissions=!0,e={billSumm:w.billSumms.approvedSums},v({method:"POST",url:h.lkApi+"paygate/beta/commissions/"+w.details.bill.billId,withCredentials:!0,data:JSON.stringify(e)}).then(function(e){P(e.data),w.requestCommissions=!1},function(e){w.requestCommissions=!1,w.canPay=!1}))},parseDiscountDate:a,convertDateToString:l,getDraftId:function(e){return v({method:"GET",url:h.gepsApiUrl+"messages/ipg",withCredentials:!0,params:e})},getBreadcrumbs:function(e,t){e=c[e];return null==e||0==e.breadcrumbs.length?t:e.breadcrumbs.concat(t)},getGroup:function(e){e=c[e];if(null!=e)return e.group},fromPlayerForm:function(e){if(void 0===e)return c.fromPlayerForm;c.fromPlayerForm=e},returnUrl:function(e){if(void 0===e)return c.returnUrl;c.returnUrl=e},createPayment:function(e,s,l,t){var c,r,o,u,d=this,n=(this.data.details.bills?(c=!0,r=this.data.bills):o=this.data.details.bill,h.ipshAdditionalAttrs||null),e={payMethodCode:e.payMethod.code,paySystemCode:e.paySystem.code,expectedFee:e.fee,paymentInstrumentId:e.paymentInstrument?e.paymentInstrument.code:null,hash:e.hash},i=(t&&(e.payInstrumentCode=t),{paymentOrder:e});c?(i.paymentOrderItemList={},i.paymentOrderItemList.paymentOrderItems=[],u=0,Object.keys(r).forEach(function(e){i.paymentOrderItemList.paymentOrderItems.push({billId:e,billSumms:r[e].billSumms.approvedSums}),u++})):i.paymentOrderItem={billId:o.billId,billSumms:w.billSumms.approvedSums},window.isEmbeddedZkh&&(i.interfaceTypeCode="MOBILE"),(w.metersActive||w.metersRequired)&&(i.paymentOrderItem.billPositions=[],angular.forEach(w.meters,function(e){i.paymentOrderItem.billPositions.push({id:e.id,typeCode:e.typeCode,value:e.value})})),!c&&n?i.ipshAdditionalAttrs=n:c&&!$.isEmptyObject(n)&&(i.itemIpshAdditionalAttrs=n),y.measureStart("payment"),d.data.servicePayment&&y.measureStart("paymentPriorBillAuth"),v({method:"POST",url:h.lkApi+"paygate/beta/payment/",data:JSON.stringify(i),withCredentials:!0}).then(function(e){if(!e||e.data.error&&0!=e.data.error.errorCode)e&&e.data.error&&10==e.data.error.errorCode&&y.measureEnd("payment",1,{BrowserError:10}),"function"==typeof s&&s.call(s,e.data.error);else{e=e.data.content;if(c&&metricReachGoal24845174("multipayment",{multipaymentID:e.multipaymentId,count:u,supplier:d.data.multipaySource}),e.params&&e.params.attrs&&e.params.attrs.length&&e.params.attrs.forEach(function(e){"Email"===e.name&&(e.value=decodeURIComponent(e.value))}),window.isEmbeddedZkh)window.SMUAdapter.notify({eventType:"createPayment",eventParams:[{key:"paymentInfo",value:e}]});else if("AUTHORIZE"==e.interactionTypeCode&&"function"==typeof l)l.call(l);else{var t=e.url,r=e.params.attrs,e=e.httpMethodCode,o="_self";e=e||"post",o=o||"_self";var n,i,a=document.createElement("form");for(n in a.setAttribute("method",e),a.setAttribute("action",t),a.setAttribute("target",o),r)r.hasOwnProperty(n)&&((i=document.createElement("input")).setAttribute("type","hidden"),i.setAttribute("name",r[n].name),i.setAttribute("value",r[n].value),a.appendChild(i));document.body.appendChild(a),a.submit()}}},function(e){d.data.servicePayment&&e&&500===e.status&&y.measureEnd("paymentPriorBillAuth",1,{BrowserError:e.status,utm_source:"paymentPriorBillAuth_no",billNumber:d.data.servicePayment.billNumber.replace("PRIOR",""),epguId:d.data.servicePayment.orderId,userId:h.userId,dateTime:(new Date).getTime()}),s(e)})},deleteInstrument:function(t,r,o){var n=this;v({method:"DELETE",url:h.lkApi+"paygate/beta/api/instrument/"+t,withCredentials:!0}).then(function(e){e.data.error&&0==e.data.error.errorCode?(n.data.myTypes.splice(n.data.myTypes.map(function(e){return e.paymentInstrument?e.paymentInstrument.code:""}).indexOf(t),1),r&&"function"==typeof r&&r.call(r)):(n.data.isFk?n.data.errorByCardDelete=!0:(n.data.error={code:e.data.error.errorCode,message:e.data.error.errorMessage},f.hash("errorBlock"),i()),o&&"function"==typeof o&&o.call(o))},function(){n.data.isFk?n.data.errorByCardDelete=!0:(n.data.error={code:1,message:"Сервис недоступен"},f.hash("errorBlock"),i()),o&&"function"==typeof o&&o.call(o)})},loadBillDetails:function(n,t,i,e,a){var s,r,l=this,o=(angular.extend(l.data,{details:null,myTypes:[],types:{},operators:{},emoney:{},payServices:{},hasPayOptions:!1,emoneyCount:0,billSumms:{total:0,approvedSums:[]},operatorsArr:[],emoneyArr:[],payServicesArr:[],warning:!1,userHasAddress:!0,hasUnidentifiedBills:!1,error:{code:0,message:"Операция выполнена успешно"},selected:null}),h.lkApi+"paygate/beta/add-bill-v3"),c=(l.billById=!!g.details,{});function u(e,t){if(e&&e.error){var r=null;switch(e.error.code){case 6e3:r=6e3;break;case 10:r=10;break;case 5:r=5;break;case 17:r=17}e.hasUnidentifiedBills&&null===r?e.bill&&e.bill.addAttrs&&e.bill.addAttrs.attrs?e.bill.addAttrs.attrs.forEach(function(e){e.name&&"errorCode"==e.name&&(r="01")}):r=4:e.userHasAddress||null!==r||(r=35),null!==r||0!=e.error.code?(o={BrowserError:r||e.error.code},i&&4==r&&(o.utm_source="requisites_not_service"),y.measureEnd("payment",1,o)):i?y.measureEnd("payment",0,{BrowserError:0,utm_source:"requisites_ok"}):y.measureEnd("payment",0)}var o;t&&e&&(e.error&&6e3===e.error.code||500===e.status)&&(o={utm_source:"searchPriorBillAuth_no",billNumber:n.replace("PRIOR",""),epguId:a&&a.value,userId:h.userId,dateTime:(new Date).getTime()},e.error&&e.error.code?o.ServerError=e.error.code:o.BrowserError=e.status,y.measureEnd("searchPriorBillAuth",1,o))}function d(e){var t;l.data.lastBillNumber=n,l.data.details=e,l.data.error=e.error,l.data.warning=e.warning,l.data.isFk=e.bill&&e.bill.billSource&&"FK"==e.bill.billSource.code,l.data.hasUnidentifiedBills=e.hasUnidentifiedBills,l.data.userHasAddress=e.userHasAddress,l.data.noFee=e.bill&&e.bill.payRequsites&&e.bill.payRequsites.kbk&&(115==e.bill.payRequsites.kbk.slice(3,6)||101<=e.bill.payRequsites.kbk.slice(3,6)&&e.bill.payRequsites.kbk.slice(3,6)<=109),P(e),e.bill&&e.bill.billSumm&&e.bill.billSumm.amounts&&C(e.bill,"mono"),(t=e).bill&&t.bill.billPositions&&t.bill.billPositions.metersAndServices&&0<t.bill.billPositions.metersAndServices.length&&(w.meters=t.bill.billPositions.metersAndServices,w.metersRequired=w.metersActive=t.bill.billPositionsRequired,angular.forEach(w.meters,function(t){t.params?(t.type="select",t.selectModel=t.params.attrs&&0<t.params.attrs.length?t.params.attrs.find(function(e){return e.name==t.value}):null):(t.type="input",t.input={hideErrorsOnBlur:!0},t.input.type="number",t.inputParams&&((t.inputParams.minValue||t.inputParams.maxValue)&&(t.input.type="number"),t.inputParams.minValue&&(t.input.min=t.inputParams.minValue),t.inputParams.maxValue&&(t.input.max=t.inputParams.maxValue),t.inputParams.valueMask)&&(t.input.pattern="/^"+t.inputParams.valueMask.replace(/\\/,"\\")+"$/"),t.visualParams&&(t.visualParams.readOnly&&(t.input.readonly=!0),t.visualParams.required||w.metersRequired)&&(t.input.required=!0,w.metersRequired=!0),t.prevValueDate&&(t.prevValueDate=b(t.prevValueDate).format("DD.MM.YYYY")))})),E(e.bill,"mono"),e.bill&&e.bill.billSource&&("ZKH"==e.bill.billSource.code||"A3"==e.bill.billSource.code)&&(l.isGkh=!0),e.bill&&e.bill.addAttrs&&e.bill.addAttrs.attrs&&e.bill.addAttrs.attrs.forEach(function(e){e.name&&"errorCode"==e.name&&"01"==e.value&&(l.data.error.code="01")}),l.data.billSumms.total=S()}function p(e){var t,r,o;l.data.details=e,l.data.hasUnidentifiedBills=e.hasUnidentifiedBills,l.data.userHasAddress=e.userHasAddress,l.billById=!0,l.data.selectedItem=void 0,l.data.bills={},P(e),e.bills&&e.bills.forEach(function(e){e&&(l.data.bills[e.billId]={billSumms:{total:0,approvedSums:[]}},C(e,"multi"),E(e,"multi"),l.data.bills[e.billId].billSumms.total=S(l.data.bills[e.billId].billSumms,"multi"),s)&&h.multiPayIds.push(e.billId)}),l.data.billSumms||(l.data.billSumms={}),l.data.billSumms.total=(t=l.data.bills,r=0,Object.keys(t).forEach(function(e){r+=t[e].billSumms.total}),r),o=l.data.bills,w.minDiscountDate=void 0,w.discountSize=void 0,w.generalOriginalAmount=0,Object.keys(o).forEach(function(e){(!w.minDiscountDate||w.minDate>o[e].discountDate)&&(w.minDiscountDate=o[e].discountDate),!w.discountSize&&o[e].gibddDiscountValue&&(w.discountSize=o[e].gibddDiscountValue),o[e].originalAmount?w.generalOriginalAmount+=Number(o[e].originalAmount):w.generalOriginalAmount+=Number(o[e].total)}),w.minDiscountDate&&(w.minDiscountDate=b(w.minDiscountDate).format("DD.MM.YYYY"));s?l.data.multipaySource="nalog.ru":f.search().utm_source&&(l.data.multipaySource={gibdd_inf:"GIBDD",fns_inf:"FNS",fssp_inf:"FSSP"}[f.search().utm_source]),metricReachGoal24845174("create_multipayment",{count:e.bills.length,source:l.data.multipaySource})}"multiPay"==g.bill?(l.data.isMultiPay=!0,f.search().reqId?(s=!0,c.reqId=f.search().reqId):c.billIds=n.toString()):(l.data.isMultiPay=!1,n&&(g.details?c.billIds=encodeURIComponent(n):c.billNumber=encodeURIComponent(n))),c.subscribe=!0,e&&angular.extend(c,e),(l.data.serviceUrl||f.search().returnUrl)&&(r=l.data.serviceUrl||f.search().returnUrl,c.returnUrl=decodeURIComponent(r));var m=/^PRIOR/.test(n)&&e&&"ORDER"===e.senderTypeCode&&a&&"epgu_order_id"===a.name;m&&(y.measureStart("searchPriorBillAuth"),l.data.servicePayment={billNumber:n,orderId:a.value}),i?(h.paymentDataFromRequisitesRequest=!0,d(i),u(i)):v({method:"POST",url:o,data:a?{attrs:[a]}:{},params:c,withCredentials:!0}).success(function(e){e&&e.error?(0==e.error.code&&e.errors&&e.errors.length&&0!=e.errors[0].code&&(e.error.code=e.errors[0].code),0==e.error.code?(l.data.isMultiPay?p:d)(e):(l.data.error=e.error,l.data.error.fkSmevVersion=e.fkSmevVersion,l.data.error.requestId=e.requestId,l.data.isMultiPay||(l.data.billNumber=n))):l.data.error={code:1,message:"Сервис недоступен"},t.call(t,e),u(e,m)}).catch(function(e){e&&504===e.status?l.data.error.code=6e3:l.data.error={code:1,message:"Сервис недоступен"},t.call(t),y.measureEnd("payment",1,{ServiceError:1}),m&&u(e,m)})},getBillsList:function(e,t){var r=this;v({method:"GET",url:h.lkApi+"fns/bills/?reqId="+e,withCredentials:!0}).success(function(e){e&&e.error||(r.data.error={code:1,message:"Сервис недоступен"}),"function"==typeof t&&t.call(t,e)}).error(function(){r.data.error={code:1,message:"Сервис недоступен"},"function"==typeof t&&t.call(t)})}}}]).config(["$routeProvider",function(r){var o={"/payment/multiPay/:bill/quittance":{controller:"paymentQuittanceCtrl",templateUrl:window.templatePath+"/tpl/payment/quittance-b85b4a4cad.html"},"/payment/:bill/quittance":{controller:"paymentQuittanceCtrl",templateUrl:window.templatePath+"/tpl/payment/quittance-b85b4a4cad.html"},"/payment/:bill/sms":{controller:"paymentSmsCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()?"/tpl/payment/mobile-payment-mob-af5b47f865.html":"/tpl/payment/mobile-payment-pad-880a44abcd.html":"/tpl/payment/mobile-payment-349da9b593.html")},"/payment/requisites":{controller:"paymentWithRequisites",templateUrl:window.templatePath+"/tpl/payment/payment-requisites-4e7e8e94d2.html"},"/payment/:bill":{controller:"paymentCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()?"/tpl/payment/payment-mob-e1cf42747b.html":"/tpl/payment/payment-pad-bb70f58120.html":"/tpl/payment/payment-f12e328db9.html")},"/payment/bills/:billId":{controller:"paymentBillsCtrl",templateUrl:window.templatePath+"/tpl/payment/payment-bills-bdb8ca47a2.html"}};Object.keys(o).forEach(function(e){var t=o[e];t.resolve=t.resolve||{},t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl&&e.checkRegionCtrl(t.current.params)}],r.whenAuthorized(e,o[e]).whenAuthorized(e+"/o/:okato",t)})}]).controller("metersCtrl",["$scope",function(r){r.data.metersActive=r.data.metersActive||!1,r.$watch("metersForm.$valid",function(e,t){e!==t&&(r.data.metersValid=e)},!0),r.meterChange=function(e,t){t.value=e.name},r.checkNeed=function(){r.data.metersActive=!r.data.metersActive}}]).controller("paymentCtrl",["$scope","$rootScope","$routeParams","PaymentService","$location","$cacheFactory","ngDialog","DisclaimerService","PerformanceService","FormServer","$timeout","GetIpshAdditionalAttrs","$http","$controller",function(i,a,s,l,r,o,n,e,t,c,u,d,p,m){if(window.scrollTo(0,0),"multiPay"==s.bill&&(i.isMultiPay=!0),i.isMultiPay&&!a.multiPayIds)if(sessionStorage.getItem("multipay")){var h=JSON.parse(sessionStorage.getItem("multipay"));a.multiPayIds=h.ids,a.multiPayRetrunUrl=h.returnUrl}else{if(!r.search().reqId)return i.errorObj={error:404},m("error404Ctrl",{$scope:i}),void(i.errorTemplate=window.templatePath+(window.mobileVersion?"/tpl/error-mob-b0b987708a.html":"/tpl/error-6622e02a3e.html"));a.reqId=r.search().reqId,a.multiPayIds=[]}function f(e,r){var o,n;"gibdd"!==r&&"fssp"!==r&&"fns"!==r||(i.isMultiPay?(a.ipshAdditionalAttrs=a.ipshAdditionalAttrs||{},a.multiPayIds.forEach(function(t){n=void 0,i.data&&i.data.details&&i.data.details.bills&&i.data.details.bills.some(function(e){return e.billId==t&&(n=e.billNumber,!0)}),n&&(o=d.get(n,e,r))&&(a.ipshAdditionalAttrs[t]=o)})):(n=l.billById&&i.data.details&&i.data.details.bill&&i.data.details.bill.billNumber?i.data.details.bill.billNumber:s.bill,(o=d.get(n,e,r))&&(a.ipshAdditionalAttrs=o)))}function g(){a.ipshAdditionalAttrs&&!$.isEmptyObject(a.ipshAdditionalAttrs)||(a.fetchComplete?Object.keys(a.informers).forEach(function(e){f(a.informers[e].data,e)}):a.$on("fetchComplete",function(e,t,r){f(t,r)}))}function v(){var e;i.paidBillsFromMultipay=[],i.data&&i.data.details&&i.data.details.bills.forEach(function(e){e.isPaid&&i.paidBillsFromMultipay.push(e.billNumber)}),i.paidBillsFromMultipay.length&&(i.errorMessageTitle=1<i.paidBillsFromMultipay.length?"Начисления оплачены":"Начисление оплачено",e=1<i.paidBillsFromMultipay.length?"начисления с номерами "+i.paidBillsFromMultipay.join(", ")+" оплачены.":"начисление с номером "+i.paidBillsFromMultipay[0]+" оплачено.",i.errorMessageText="По данным Государственной информационной системы о государственных и муниципальных платежах "+e+"<br><br>Вернитесь к списку начислений и повторите выбор.")}t.measureStart("payment"),!a.paymentRefferer||a.disableMetric||a.disableMetric||metricReachGoal(a.paymentRefferer+"pay"),e.paymentDisclaimer(),a.breadcrumbs=l.getBreadcrumbs(s.bill,[{text:"Оплата услуги",href:"/payment/"+s.bill+(l.billById?"?details=1":"")}]),a.serviceGroup=l.getGroup(s.bill),a.pageNameCls="payment-page",i.loading=!0,i.details={},i.isPhone=SmartPhone.isPhone(),i.lkApiUrl=a.lkApi,i.metersError={show:!1},i.returnUrl=l.returnUrl(),i.fromPlayerForm=l.fromPlayerForm(),i.redirectToService=function(e){i.fromPlayerForm?(e.preventDefault(),window.location.href=i.returnUrl):r.path(i.returnUrl)},l.returnUrl(""),l.fromPlayerForm(!1),i.isMultiPay||i.$watch(l.calculateTotal,function(e,t){e!==t&&angular.isDefined(t)&&(i.data.billSumms.total=+e,l.getCommissions())}),i.sendDraftReq=function(){var e,t,r;i.data&&i.data.details&&i.data.details.bill&&i.data.details.bill.billSource&&(e=i.data.details.bill,t="",angular.forEach(e.addAttrs.attrs,function(e){"persAccNumber"==e.name&&(t=e.value)}),t=t||(e.userAccount&&e.userAccount.accountNumber?e.userAccount.accountNumber:""),r=function(){n.open({template:"geps-appeal-warning.html",className:"payment-warning"})},l.getDraftId({billSourceCode:e.billSource.code,billNumber:e.billNumber,to:e.gepsRecipient,accountNumber:t?", л/c "+t:"",supplierName:e.supplierName,billSum:e.amount+"руб"}).success(function(e){e&&e.threadId?window.location.href=a.lkUrl+"/mail/draft/"+e.threadId:r()}).error(function(){r()}))},i.createPayment=function(e,t){i.data.metersValid||!i.data.metersActive&&!i.data.metersRequired?(i.routingToPay=!0,"quittance"==(l.data.selected=e)?i.isMultiPay?r.url("/payment/multiPay/"+t+"/quittance").search("details","1"):r.path("/payment/"+s.bill+"/quittance"):((t=o.get("utilities_bills"))&&t.removeAll(),a.paymentRefferer&&!a.disableMetric&&("qiwi"==e.payMethod.code.toLowerCase()&&metricReachGoal(a.paymentRefferer+"pay_qiwi"),"BANK_CARD"==e.payMethod.code)&&(e.paymentInstrument?metricReachGoal(a.paymentRefferer+"pay_difcard"):metricReachGoal(a.paymentRefferer+"pay_savedcard")),"MPHONE"===e.payMethodGroup.code?r.path("/payment/"+s.bill+"/sms"):l.createPayment(l.data.selected,function(e){var t;e.errorCode&&3003==e.errorCode?i.isMultiPay?(i.loading=!0,l.loadBillDetails(a.multiPayIds,function(e){i.data=l.data,v(),i.loading=!1},null,{ci:!1})):i.bill.isPaid=!0:(t=i.isMultiPay?"начислений":"начисления № "+i.data.details.bill.billNumber,10===e.errorCode?e.errorMessage="Для оплаты "+t+" недостаточно сведений. Для уточнения данных и оплаты обратитесь в ведомство, выставившее начисление.":28===e.errorCode&&(e.errorMessage="Для оплаты  "+t+" недостаточно сведений. Просьба скорректировать <a href='"+a.lcUrl+"?addrlive='>адрес проживания</a> и попробовать снова."),n.open({template:window.templatePath+"/tpl/payment/create-payment-error-4e0303069b.html",className:"payment-warning",data:{text:e.errorMessage}})),i.routingToPay=!1}))):i.metersError.show=!0},i.deleteInstrument=function(e,t){l.deleteInstrument(e,function(){i.$safeApply()}),t.stopPropagation()};function y(){i.data=l.data,i.bill=i.data&&i.data.details&&i.data.details.bill,i.fkPayments=i.data&&i.data.details&&i.data.details.fkPayments,i.billById=l.billById,i.isGkh=l.isGkh,i.loading=!1,g(),b(),a.disableMetric||6e3!=i.data.error.code&&5!=i.data.error.code&&0!=i.data.error.code||(6e3==i.data.error.code?metricReachGoal("unavailable_gisgmp"):i.data.hasUnidentifiedBills&&0==i.data.error.code?a.paymentDataFromRequisitesRequest?metricReachGoal24845174("requisites_not_service"):metricReachGoal("no_org"):5==i.data.error.code?metricReachGoal("no_debt"):i.data.userHasAddress?"PAID"==i.data.details.bill.billStatus.code?metricReachGoal("payed_search_gisgmp"):a.paymentDataFromRequisitesRequest?metricReachGoal24845174("requisites_ok"):metricReachGoal("ok_search_gisgmp"):metricReachGoal("no_profile_adress")),a.paymentDataFromRequisitesRequest=!1}function b(){var e={error:1,title:"Оплата нескольких начислений временно недоступна",type:"type_not",text:"Пожалуйста, вернитесь к услуге и воспользуйтесь оплатой отдельных начислений"};if(i.data.error&&0!=i.data.error.code){switch(i.data.error.code){case 17:i.isMultiPay?i.errorObj={title:"Невозможно совершить оплату",type:"type_warn",text:i.data.error.message}:i.errorObj={error:17,title:"Оплата невозможна",type:"type_not",text:i.data.error.message};break;case 13:i.errorObj={error:13,title:"Начисление оплачено",type:"type_ok",text:"Начисление с номером "+i.data.billNumber+" уже было оплачено."};break;case 30:i.errorObj={error:30,title:"Невозможно оплатить начисление",type:"type_not",text:"Начисление №"+i.data.billNumber+" невозможно оплатить, так как ведомство аннулировало начисление."};break;case 8011:i.errorObj={error:8011,title:"Оплата невозможна",type:"type_not",text:"Некорректный номер начисления."};break;case 80234:i.errorObj={error:80234,title:"Оплата невозможна",type:"type_not",text:"Некорректный номер начисления. Проверьте правильность ввода. Если ошибок не найдено, обратитесь в ведомство, которое выставило счет."};break;case 4:case 5:case 70:i.isMultiPay?i.errorObj={error:70,title:"Оплата выбранных начислений недоступна",type:"type_not",text:"Пожалуйста, вернитесь к услуге и выберите начисления к оплате заново."}:i.errorObj={error:4};break;case 6e3:i.errorObj={error:6e3,message:i.data.error.message},i.subscribeRequestData={type:"UIN",uin:s.bill,fkSmevVersion:i.data.error.fkSmevVersion,requestId:i.data.error.requestId};break;case"01":break;default:i.isMultiPay?i.errorObj=e:i.errorObj={error:i.data.error.code,title:"Оплата невозможна",type:"type_not",text:"Попробуйте повторить попытку позже."}}"mob"==a.version&&(i.errorObj.path=i.errorObj.type&&"type_not"==i.errorObj.type?"htdocs/img/icon/all_be_bad@1x-d46aa7cbfd.svg":"type_ok"==i.errorObj.type?"htdocs/img/icon/all_be_ok-5c1aedcd81.svg":"htdocs/img/icon/all_be_warn@1x-51975a5a17.svg")}i.data.error&&0==i.data.error.code&&!i.data.hasPayOptions&&i.isMultiPay&&(i.errorObj=e)}a.paymentDataFromRequisitesRequest?y():i.isMultiPay?l.loadBillDetails(a.multiPayIds,function(e){i.data=l.data,i.multiPayTotal=i.data.billSumms.total,i.loading=!1,v(),g(),b()}):(h={},m=null,(t=r.search()).orderId?(m={name:"epgu_order_id",value:t.orderId},h.senderTypeCode="ORDER"):t.senderType?h.senderTypeCode=t.senderType:t.details||(h.senderTypeCode="PAY_UIN"),l.loadBillDetails(s.bill,function(e){i.$safeApply(function(){y()})},null,h,m)),/true/i.test(s.noQuittance)&&(l.data.showQuittance=!1);var w={};i.addressCheckbox=!1,i.dadataPlaceholder="Укажите адрес регистрации",i.showInputbottom=!1,i.addressCheckboxChange=function(e){i.addressCheckbox=!i.addressCheckbox,i.addressCheckbox?(i.dadataPlaceholder="Укажите адрес места проживания",i.showInputbottom=!0):(i.dadataPlaceholder="Укажите адрес регистрации",i.showInputbottom=!1)},i.dadataChange=function(e){e&&(w=e)},i.saveAddress=function(){var e=w&&w.addressString;e.value&&!e.valid.isInvalid?e.checkNormalize(e,{done:function(e){i.saveInProcess=!0;var r={1:"region",7:"street",11:"house",12:"frame",13:"building",14:"flat"},o="",n={type:i.addressCheckbox?"PLV":"PRG",countryId:"RUS"};e&&(n.fiasCode=e.fiasCode||"",n.zipCode=e.postIndex||"",e.elements&&e.elements.forEach(function(e){var t=r[e.level];t&&(n[t]=e.data),0<e.level&&e.level<10&&(o+=e.shortType+". "+e.data+", ")}),o)&&(n.addressStr=o.slice(0,o.length-2)),p({url:a.lkApi+"users/address",noTestScope:!0,method:"POST",data:n,withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(function(e){e&&200==e.status&&(i.saveInProcess=!1,a.newAdressSaved=!0)})}}):(console.log("dadata is invalid"),e.valid.isInvalid=!0,e.valid.message="Необходимо заполнить адрес")},i.changeGroup=function(e){i.data.activeGroup?(i.data.lastActiveGroup=i.data.activeGroup,i.data.groupToSelect=i.data.lastActiveGroup,i.data.activeGroup="",i.data.selectedItem={}):(e?(i.data.activeGroup=e,i.data.lastActiveGroup=e):(i.data.activeGroup=i.data.lastActiveGroup,i.data.lastActiveGroup=i.data.activeGroup,i.data.groupToSelect=i.data.lastActiveGroup),"bankCard"!==i.data.activeGroup&&1!==i.data.payMethodsArr[i.data.activeGroup].length||(i.data.selectedItem=i.data.payMethodsArr[i.data.activeGroup][0])),i.noSelected=!1},i.tabChange=function(e,t){i.indexSelectedTab=30*t+1,i.data.activTab!=e&&(i.data.activTab=e,i.noSelected=!1,i.data.selectedItem="bankCard"!=e?{}:i.data.payMethodsArr.bankCard[0])},i.tabChangeWithKeyboard=function(e,t,r){i.noSelected=!1,13==e.which&&i.tabChange(t,r)},i.checkSelect=function(e){$.isEmptyObject(e)?i.noSelected=!0:(i.noSelected=!1,i.createPayment(e))},i.isEmptySelectedItem=function(e){return $.isEmptyObject(e)},i.showPopup_allRequites=function(e){i.showPopup_payRequsites=!0,i.billInPopup=e},i.showDeletePopup=function(e,t){i.card_delete=!0,i.card_to_delete=e,t.stopPropagation()},i.closeErrorPopup=function(){i.showDeleteErrorPopup=!1},i.deleteCard=function(){l.deleteInstrument(i.card_to_delete.code,function(){i.card_delete=!1,i.data.payMethodsArr.bankCard.splice(i.data.payMethodsArr.bankCard.map(function(e){return e.paymentInstrument?e.paymentInstrument.code:""}).indexOf(i.card_to_delete.code),1),i.card_to_delete.code==i.data.selectedItem.code&&(i.data.selectedItem=i.data.payMethodsArr.bankCard[0]),i.$safeApply()},function(){i.card_delete=!1,i.showDeleteErrorPopup=!0})},i.cancelDelete=function(){i.card_delete=!1},i.methodChoose=function(e){i.noSelected=!1,i.data.selectedItem=e},i.methodChooseWithKeyboard=function(e,t){i.noSelected=!1,13==e.which&&(i.data.selectedItem=t)}}]).controller("paymentWithRequisites",["$scope","$rootScope","$location","$http","$httpParamSerializerJQLike","PaymentService","PerformanceService",function(r,t,o,n,i,a,s){t.breadcrumbs=[{text:"Оплата услуги"}],t.pageNameCls="payment-page";var l=angular.copy(o.search()),c=(r.loading=!0,s.measureStart("payment"),u(l),r.passportSeriaField={showErrors:!1,mask:"9999",uiOptions:"{clearOnBlur: false}"},r.passportNumberField={showErrors:!1,mask:"999999",uiOptions:"{clearOnBlur: false}"},r.snilsField={showErrors:!1,mask:"999-999-999 99",uiOptions:"{clearOnBlur: false}"},{20:{code:"inn",title:"Заполните данные ИНН",text:"Для совершения платежа необходимо заполнить Ваш ИНН:",PayerIdType:"21"},21:{code:"pass",title:"Заполните данные паспорта гражданина РФ",text:"Для совершения платежа необходимо заполнить серию и номер Вашего паспорта:",PayerIdType:"01"},22:{code:"snils",title:"Заполните данные СНИЛС",text:"Для совершения платежа необходимо заполнить номер Вашего СНИЛС:",PayerIdType:"14"},ci:!(r.innField={showErrors:!1,mask:"999999999999",uiOptions:"{clearOnBlur: false}"})});function u(e){n({url:t.lkApi+"paygate/beta/add-bill-requisites/",method:"POST",data:i(e),withCredentials:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){e&&e.data&&e.data.error&&(20<=e.data.error.code&&e.data.error.code<=22?(r.errorCode=e.data.error.code,r.failRequisit=c[r.errorCode]):25==e.data.error.code||26==e.data.error.code?(r.errorCode=25,r.payPurpose=e.data.requisites&&e.data.requisites&&e.data.requisites.Purpose,r.recieverPdfName=e.data.requisites&&e.data.requisites&&e.data.requisites.Name,t.disableMetric||metricReachGoal24845174("requisites_flk_no"),s.measureEnd("payment",1,{BrowserError:26,utm_source:"requisites_flk_no"})):0==e.data.error.code?(a.loadBillDetails(e.data.bill.billNumber,null,e.data),o.url("/payment/"+e.data.bill.billNumber)):(r.requestError=!0,r.errorMessage=e.data.error.message)),r.loading=!1},function(e){console.log(e),r.requestError=!0,r.errorMessage=response.data.error.message,r.loading=!1})}r.setRequisit=function(e,t){e&&(l.PayerIdType=r.failRequisit.PayerIdType,l.PayerIdNum=r.failRequisit.PayerIdType+e+(t||""),u(l))}}]).controller("paymentSmsCtrl",["$scope","$rootScope","$location","PaymentService","ngDialog","$routeParams","DisclaimerService",function(t,r,o,n,i,a,e){$.isEmptyObject(n.data)||n.data.lastBillNumber!=a.bill?n.billById?o.path("/payment/"+a.bill).search("details","1"):o.path("/payment/"+a.bill):(e.paymentDisclaimer(),t.billById=n.billById,t.isGkh=n.isGkh,t.data=n.data,t.phoneFields={mask:"+7 (999) 999-99-99",maskSave:t.data.phone.replace(/[^0-9]+/g,"")},console.log(t.data.phone.replace(/[^0-9]+/g,"")),r.breadcrumbs=n.getBreadcrumbs(a.bill,[{text:"Оплата услуги",href:"/payment/"+a.bill+(n.billById?"?details=1":"")},{text:"Оплата с помощью операторов сотовой связи"}]),r.serviceGroup=n.getGroup(a.bill),r.pageNameCls="payment-page",t.maskOptions={mask:"+7 (999) 999-99-99"},t.data&&t.data.phone&&(e=(e=0==(e=t.data.phone).indexOf("+")?e.substr(2):e).replace(/[^0-9\.]+/g,""),t.data.phone=e),t.createPayment=function(){var e=n.data.phone.replace(/^(7|\+7)/,"").replace(/[^\d]/g,"");if(!e.match(/^\d{10}$/))return!1;t.$safeApply(function(){t.processing=!0}),r.paymentRefferer&&!r.disableMetric&&metricReachGoal(r.paymentRefferer+"pay_mobile"),n.createPayment(n.data.selected,function(e){3003===e.errorCode?n.billById?o.path("/payment/"+a.bill).search("details","1"):o.path("/payment/"+a.bill):(10===e.errorCode?e.errorMessage="Для оплаты начисления № "+t.data.details.bill.billNumber+" недостаточно сведений. Для уточнения данных и оплаты обратитесь в ведомство, выставившее начисление.":28===e.errorCode&&(e.errorMessage="Для оплаты начисления № "+t.data.details.bill.billNumber+" недостаточно сведений. Просьба скорректировать <a href='"+r.lcUrl+"?addrlive='>адрес проживания</a> и попробовать снова."),i.open({template:window.templatePath+"/tpl/payment/create-payment-error-4e0303069b.html",className:"payment-warning",data:{text:e.errorMessage}})),t.paymentError=!0,t.processing=!1},function(){t.$safeApply(function(){t.processing=!1,t.success=!0})},e)},t.goBack=function(){o.path("/payment/"+t.data.lastBillNumber)})}]).controller("paymentQuittanceCtrl",["$scope","$rootScope","$location","PaymentService","$routeParams","DisclaimerService","CommonDialog","$http",function(r,e,t,o,n,i,a,s){$.isEmptyObject(o.data)||o.data.lastBillNumber!=n.bill&&!o.data.isMultiPay?o.billById?t.path("/payment/"+n.bill).search("details","1"):t.path("/payment/"+n.bill):(i.paymentDisclaimer(),r.billById=o.billById,r.isGkh=o.isGkh,r.data=o.data,r.fromMultyPay=o.data.isMultiPay,r.billId=r.fromMultyPay?n.bill:r.data.details.bill.billId,r.fromMultyPay?r.data.details.bills.forEach(function(e){e.billId==n.bill&&(r.bill=e,r.obj=e)}):(r.bill=r.data.details.bill,r.obj=r.data),i=r.fromMultyPay?"multiPay":n.bill,e.breadcrumbs=o.getBreadcrumbs(i,[{text:"Оплата услуги",href:"/payment/"+i+(o.billById?"?details=1":"")},{text:"Оплата с помощью квитанции"}]),e.serviceGroup=o.getGroup(i),e.pageNameCls="payment-page",r.email=e.user.email,r.fromMultyPay?r.returnUrl="/payment/multiPay":r.returnUrl="/payment/"+(r.billById?r.data.lastBillNumber+"?details=1":r.data.lastBillNumber),r.goBack=function(){r.fromMultyPay?t.path("/payment/multiPay"):t.path("/payment/"+r.data.lastBillNumber)},r.getQuittance=function(){e.paymentRefferer&&!e.disableMetric&&metricReachGoal(e.paymentRefferer+"pay_recipe"),r.email&&(r.quittanceSending=!0,s({method:"GET",url:e.lkApi+"paygate/beta/sendemail/"+r.billId,withCredentials:!0,params:{email:r.email}}).then(function(e){r.quittanceSending=!1,e&&1==e.data?a.ok("Информация о платеже отправлена на указанный электронный адрес",""):a.error("При отправке квитанции произошла ошибка","Пожалуйста, попробуйте отправить ее еще раз.")},function(){r.quittanceSending=!1,a.error("При отправке квитанции произошла ошибка","Пожалуйста, попробуйте отправить ее еще раз.")}))},r.checkEmbedded=function(e,t){window.isEmbeddedZkh?(e.preventDefault(),window.SMUAdapter.notify({eventType:"showQuittance",eventParams:[{key:"billId",value:r.billId}]})):/touch/.test(e.type)&&(window.open(t),e.preventDefault())},$.isEmptyObject(o.data)?o.loadBillDetails(n.bill,function(e){r.$apply(function(){angular.extend(r,o.data),r.loading=!1})}):(angular.extend(r,o.data),r.loading=!1))}]).controller("paymentBillsCtrl",["$scope","$rootScope","$location","PaymentService","$routeParams","ipCookie",function(i,e,t,r,o,n){i.loading=!0,e.pageNameCls="payment-page",e.breadcrumbs=r.getBreadcrumbs(o.billId,[{text:"Оплата счетов",href:"/payment/bills/"+o.billId}]),r.getBillsList(o.billId,function(e){i.loading=!1;for(var t=e.bills||null,r={},o=0;t.length>o;o++){var n=t[o].supplierName;t[o].paid=t[o].isPaid?"оплачено":"не оплачено",r[n]&&r[n].items?r[n].items.push(t[o]):r[n]={items:[t[o]]}}i.billItems=r})}])}(),function(){"use strict";var a;angular.module("zeroStepPage",["ngRoute"]).config(["$routeProvider",function(n){window.redirectMap&&angular.forEach(window.redirectMap,function(r){r.userType||n.when(r.from,{redirectTo:function(t,e){if(Object.keys(t).forEach(function(e){r.to=r.to.replace(":"+e,t[e])}),!/^(http|\/\/)/.test(r.to))return e.replace(r.from,r.to);location.replace(r.to)}})}),a=[];var i={};angular.forEach(a,function(e){!function t(r,e){var o;e&&(r.parent=e,r.baseUrl=r.baseUrl||e.baseUrl,r.serviceIcon=r.serviceIcon||e.serviceIcon,r.group=r.group||e.group,r.department=r.department||e.department,r.h1=r.h1||e.h1);r.url=r.url||r.baseUrl+(r.subUrl||"");i[r.url]=r;r.childs&&(angular.forEach(r.childs,function(e){t(e,r)}),r.links=r.childs);if(r.links&&(o=r.links.length))for(;o--;)r.links[o].url=r.links[o].url||r.baseUrl+(r.links[o].subUrl||"");n.when(r.url,{controller:"zeroStepCtrl",templateUrl:window.templatePath+"/tpl/zero-step-c993dadaf1.html"}).when(r.url+"/o/:okato",{controller:"zeroStepCtrl",templateUrl:window.templatePath+"/tpl/zero-step-c993dadaf1.html",resolve:{checkRegionCtrl:["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}]}}).when(r.url+"/r/:region",{controller:"zeroStepCtrl",templateUrl:window.templatePath+"/tpl/zero-step-c993dadaf1.html",resolve:{checkRegionCtrl:["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}]}})}(e)}),a=i}]).controller("zeroStepCtrl",["$scope","$rootScope","$location",function(e,t,r){var o=r.$$path,n=-1<o.search("/r/")?/([\/][r][\/])\s*\S.*/:/([\/][o][\/])\s*\S.*]/,n=o.replace(n,"")!==o?o.replace(n,""):o,i=a[n],o=[];i&&(i.parent&&o.push({text:i.parent.h1,href:i.parent.url}),o.push({text:i.h1,href:i.url}),t.breadcrumbs=o,t.pageNameCls="catalog-page",t.serviceGroup=i.group.code,e.pageInfo=i),e.zeroStepHistoryBack=function(){r.path(i.parent.url).replace()}}])}(),function(){"use strict";var t={controller:"profileInfoCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()&&SmartPhone.isPhone()?"/tpl/lk/profile-mob-9348363a9e.html":"/tpl/lk/profile-83096450e9.html"),resolve:{loadProfileInfoCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/lib/profile-info-4eaecc6884.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-info-min-a1f574eda0.1682593322983.js")}]},reloadOnSearch:!1};angular.module("profileInfoPage",["ngRoute","angular-svg-round-progressbar"]).config(["$routeProvider",function(e){window.isLk&&"PARTNERS"!==window.viewType&&e.whenAuthorized("/licenses",{controller:"profileInfoCtrl",templateUrl:window.templatePath+"/tpl/lk/licenses-b624dd5e3f.html",resolve:{loadProfileInfoCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/lib/profile-info-4eaecc6884.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-info-min-a1f574eda0.1682593322983.js")}]}}).whenAuthorized("/",{controller:"profileInfoCtrl",redirectTo:function(e,t){return SmartPhone.isAny()&&SmartPhone.isPhone()?"/start":"/info"}}).whenAuthorized("/mobile/info",{controller:"profileInfoCtrl",templateUrl:window.templatePath+"/tpl/lk/profile-election-mob-d807b1eb6b.html",resolve:{loadProfileInfoCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/lib/profile-info-4eaecc6884.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-info-min-a1f574eda0.1682593322983.js")}]}}).whenAuthorized("/evoting",{controller:"evotingController",templateUrl:window.templatePath+"/tpl/lk/profile-e-voting-561b1dbf97.html",resolve:{loadProfileInfoCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/lib/profile-info-4eaecc6884.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-info-min-a1f574eda0.1682593322983.js")}]}}).whenAuthorized("/start",angular.extend({},t,{templateUrl:window.templatePath+"/tpl/profile-landing-mob-2f6d8e621a.html",redirectTo:function(e,t,r){return"true"==r.webViewMode&&window.mobileVersion?"/info/election":SmartPhone.isAny()&&SmartPhone.isPhone()?"/start":"/info"}})).whenAuthorized("/profile/transport",{redirectTo:"/info/transports"}).whenAuthorized("/org-profile",{redirectTo:"/info"}).whenAuthorized("/org-profile/:rest*",{resolve:{factory:["$rootScope",function(e){e.toggleNewLkCookie(),location.reload()}]}}).whenAuthorized("/settings",{redirectTo:"/info"}).whenAuthorized("/settings/account",{redirectTo:function(){location.href=window.lcUrl+location.search}}).whenAuthorized("/settings/notifications",{redirectTo:"/notification-setup"}).whenAuthorized("/settings/:newLkPath*",{redirectTo:"/info"}).whenAuthorized("/profile/transport/vehicles",{redirectTo:"/info/transports"}).whenAuthorized("/info/transports",{controller:"profileTransportsCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()&&SmartPhone.isPhone()?"/tpl/lk/profile-mob-9348363a9e.html":"/tpl/lk/profile-83096450e9.html"),resolve:{loadProfileTransportsCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/lib/profile-info-4eaecc6884.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-info-min-a1f574eda0.1682593322983.js").then(function(){return e.get(window.templatePath+"/js/lib/profile-transports-4aca9eba19.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-transports-min-4b4a0bf85f.1682593322983.js")})}]}}).whenAuthorized("/info/:page?",angular.extend({},t,{templateUrl:function(e){return e&&e.webViewMode&&"true"==e.webViewMode&&window.mobileVersion?window.templatePath+"/tpl/lk/profile-election-mob-d807b1eb6b.html":e&&e.page&&"inspect"!==e.page?window.templatePath+("/tpl/lk/profile-"+e.page)+"-mob.html":window.templatePath+(SmartPhone.isAny()&&SmartPhone.isPhone()?"/tpl/lk/profile-mob-9348363a9e.html":"/tpl/lk/profile-83096450e9.html")},redirectTo:function(e,t,r){return"inspect"===e.page?"/inspect":"true"==r.webViewMode&&window.mobileVersion?"/info/election":(!SmartPhone.isAny()||SmartPhone.isAny()&&!SmartPhone.isPhone())&&e.page?"/info":SmartPhone.isAny()&&SmartPhone.isPhone()&&!e.page?"/start":void 0}})).whenAuthorized("/profile/personal",{redirectTo:"/docs"}).whenAuthorized("/docs",t).whenAuthorized("/inspect",t).whenAuthorized("/inspect/:agencyId/:page/:additionalParam?/:additionalParam2?",angular.extend({},t,{redirectTo:function(e,t){return["requirements","requirement","declarations","declaration-edit","declaration-view","assessments","assessment-view","assessment-edit","risks"].includes(e.page)?void 0:"/404"},reloadOnSearch:!1})).whenAuthorized("/cards",t).whenAuthorized("/roles",angular.extend({},t,{controller:"profileRoleCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()&&SmartPhone.isPhone()?"/tpl/lk/profile-roles-mob-2c70bd0dc4.html":"/tpl/lk/profile-roles-32a8425d1d.html"),redirectTo:function(){if(!window.openLkForEveryone)return!SmartPhone.isAny()||SmartPhone.isAny()&&!SmartPhone.isPhone()?"/info":SmartPhone.isAny()&&SmartPhone.isPhone()?"/start":void 0}}))}])}(),function(){"use strict";angular.module("profileNotificationSetupPage",["ngRoute"]).config(["$routeProvider",function(e){window.isLk&&e.whenAuthorized("/notification-setup/all-blocked-users",{controller:"profileBlockedUsers",templateUrl:window.templatePath+"/tpl/profile-blocked-users-9f36c4bb7c.html",resolve:{loadProfileNotificationsSetupCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-notification-setup-c7093c2ecb.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-notification-setup-min-2ade26faa6.1682593322983.js")}]}}).whenAuthorized("/notification-setup",{controller:"profileNotificationSetupCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()&&SmartPhone.isPhone()?"/tpl/lk/profile-mob-9348363a9e.html":"/tpl/lk/profile-83096450e9.html"),resolve:{loadProfileNotificationsSetupCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-notification-setup-c7093c2ecb.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-notification-setup-min-2ade26faa6.1682593322983.js")}]},redirectTo:function(){if(!window.openNotifSetupBlockForOrg&&("L"===window.userType||"B"===window.userType))return!SmartPhone.isAny()||SmartPhone.isAny()&&!SmartPhone.isPhone()?"/info":SmartPhone.isAny()&&SmartPhone.isPhone()?"/start":void 0}})}])}(),function(){"use strict";angular.module("profileNotificationPage",["ngRoute","yaMap","paymentPage"]).config(["$routeProvider",function(e){window.isEmbedded?e.whenAuthorized("/mobile/lk/notifications/details/:id/integrationModuleDraft",{controller:"integrationModuleDraft",templateUrl:window.templatePath+"/tpl/profile-form-298a9d1c91.html",resolve:{loadProfileNotificationsCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-notifications-6d8c2d3e58.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-notifications-min-c1078547ce.1682593322983.js")}]}}):window.isLk&&e.whenAuthorized("/notifications",{controller:"profileNotificationCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()&&SmartPhone.isPhone()?"/tpl/lk/profile-mob-9348363a9e.html":"/tpl/lk/profile-83096450e9.html"),resolve:{loadProfileNotificationsCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-notifications-6d8c2d3e58.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-notifications-min-c1078547ce.1682593322983.js")}]}}).whenAuthorized("/org-profile",{redirectTo:"/info"}).whenAuthorized("/orders",{redirectTo:"/notifications"}).whenAuthorized("/overview",{redirectTo:"/notifications"}).whenAuthorized("/mail",{controller:"profileNotificationCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()&&SmartPhone.isPhone()?"/tpl/lk/profile-mob-9348363a9e.html":"/tpl/lk/profile-83096450e9.html"),resolve:{loadProfileNotificationsCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-notifications-6d8c2d3e58.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-notifications-min-c1078547ce.1682593322983.js")}]}}).whenAuthorized("/notifications/:id/print",{controller:"profileNotificationDetailsCtrl2",templateUrl:window.templatePath+(SmartPhone.isAny()&&SmartPhone.isPhone()?"/tpl/lk/profile-mob-9348363a9e.html":"/tpl/lk/profile-83096450e9.html"),resolve:{loadProfileNotificationsCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-notifications-6d8c2d3e58.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-notifications-min-c1078547ce.1682593322983.js")}]}}).whenAuthorized("/notifications/details/:id",{controller:"profileNotificationDetailsCtrl2",templateUrl:window.templatePath+(SmartPhone.isAny()&&SmartPhone.isPhone()?"/tpl/lk/profile-mob-9348363a9e.html":"/tpl/lk/profile-83096450e9.html"),resolve:{loadProfileNotificationsCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-notifications-6d8c2d3e58.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-notifications-min-c1078547ce.1682593322983.js")}]}}).whenAuthorized("/mobile/lk/notifications/details/:id/integrationModuleDraft",{controller:"integrationModuleDraft",templateUrl:window.templatePath+"/tpl/profile-form-298a9d1c91.html",resolve:{loadProfileNotificationsCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-notifications-6d8c2d3e58.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-notifications-min-c1078547ce.1682593322983.js")}]}}).whenAuthorized("/notifications/details/:id/integrationModuleDraft",{controller:"integrationModuleDraft",templateUrl:window.templatePath+"/tpl/profile-form-298a9d1c91.html",resolve:{loadProfileNotificationsCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-notifications-6d8c2d3e58.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-notifications-min-c1078547ce.1682593322983.js")}]}}).whenAuthorized("/notifications/details/:type/:id",{controller:"profileNotificationDetailsCtrl2",templateUrl:window.templatePath+(SmartPhone.isAny()&&SmartPhone.isPhone()?"/tpl/lk/profile-mob-9348363a9e.html":"/tpl/lk/profile-83096450e9.html"),resolve:{loadProfileNotificationsCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-notifications-6d8c2d3e58.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-notifications-min-c1078547ce.1682593322983.js")}]}}).whenAuthorized("/mail/message/:id",{controller:"profileNotificationDetailsCtrl2",templateUrl:window.templatePath+(SmartPhone.isAny()&&SmartPhone.isPhone()?"/tpl/lk/profile-mob-9348363a9e.html":"/tpl/lk/profile-83096450e9.html"),resolve:{loadProfileNotificationsCtrl:["$ocLazyLoad","$rootScope",function(e,t){return e.load(t.pageCtrlPath+"profile-notifications"+(t.disableMetric?".js":"-min.js"))}]}}).whenAuthorized("/mail/message/:id/print",{controller:"profileNotificationDetailsCtrl2",templateUrl:window.templatePath+"/tpl/mail/profile-mail-print-306c631807.html",resolve:{loadProfileNotificationsCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-notifications-6d8c2d3e58.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-notifications-min-c1078547ce.1682593322983.js")}]}}).whenAuthorized("/mail/message/:id/send",{controller:"profileNotificationDetailsSendCtrl",templateUrl:window.templatePath+"/tpl/profile-abda8a2155.html",resolve:{loadProfileNotificationsCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-notifications-6d8c2d3e58.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-notifications-min-c1078547ce.1682593322983.js")}]}}).whenAuthorized("/notifications/details/:type/:id/print",{controller:"profileNotificationDetailsCtrl2",templateUrl:window.templatePath+(SmartPhone.isAny()&&SmartPhone.isPhone()?"/tpl/lk/profile-mob-9348363a9e.html":"/tpl/lk/profile-83096450e9.html"),resolve:{loadProfileNotificationsCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-notifications-6d8c2d3e58.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-notifications-min-c1078547ce.1682593322983.js")}]}}).when("/draft/:id",{controller:"draftRedirectCtrl",template:'<div data-throbber="throbber-big" data-show-heading="true"></div>',resolve:{loadProfileNotificationsCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-notifications-6d8c2d3e58.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-notifications-min-c1078547ce.1682593322983.js")}]}})}])}(),function(){"use strict";angular.module("profileTransportsPage",["ngRoute","yaMap"]).config(["$routeProvider",function(e){window.isLk&&e.whenAuthorized("/transports/details/:id",{controller:"profileTransportDetailsCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()&&SmartPhone.isPhone()?"/tpl/lk/profile-mob-9348363a9e.html":"/tpl/lk/profile-83096450e9.html"),resolve:{loadProfileTransportsCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-transports-4aca9eba19.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-transports-min-4b4a0bf85f.1682593322983.js")}]}})}])}(),function(){"use strict";angular.module("profileMailPage",["ngRoute"]).config(["$routeProvider",function(e){window.isLk&&e.whenAuthorized("/mail/thread/:threadId",{controller:"profileMailThreadCtrl",templateUrl:window.templatePath+(window.mobileVersion?"/tpl/lk/profile-mob-9348363a9e.html":"/tpl/profile-abda8a2155.html"),resolve:{loadProfileMailCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-mail-9a2ad96cdf.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-mail-min-f7aa7c106e.1682593322983.js")}]}}).whenAuthorized("/mail/delivery",{controller:"profileMailDeliveryCtrl",templateUrl:window.templatePath+"/tpl/profile-abda8a2155.html",resolve:{loadProfileMailCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-mail-9a2ad96cdf.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-mail-min-f7aa7c106e.1682593322983.js")}]}}).whenAuthorized("/mail/draft/:id",{controller:"profileMailDraftCtrl",templateUrl:window.templatePath+(window.mobileVersion?"/tpl/lk/profile-mob-9348363a9e.html":"/tpl/profile-abda8a2155.html"),resolve:{loadProfileMailCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-mail-9a2ad96cdf.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-mail-min-f7aa7c106e.1682593322983.js")}]}}).whenAuthorized("/mail/draft/:id/print",{controller:"profileMailDraftCtrl",templateUrl:window.templatePath+"/tpl/mail/profile-mail-print-306c631807.html",resolve:{loadProfileMailCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-mail-9a2ad96cdf.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-mail-min-f7aa7c106e.1682593322983.js")}]}}).whenAuthorized("/mail/delivery/license",{controller:"profileMailDeliveryLicenseCtrl",templateUrl:window.templatePath+(window.mobileVersion?"/tpl/lk/profile-mob-9348363a9e.html":"/tpl/profile-abda8a2155.html"),resolve:{loadProfileMailCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-mail-9a2ad96cdf.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-mail-min-f7aa7c106e.1682593322983.js")}]}})}])}(),function(){"use strict";angular.module("profileEmployeesPage",["ngRoute"]).config(["$routeProvider",function(e){window.isLk&&e.whenAuthorized("/employees",{controller:"profileEmployeesCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()&&SmartPhone.isPhone()?"/tpl/lk/profile-mob-9348363a9e.html":"/tpl/lk/profile-83096450e9.html"),resolve:{loadProfileEmployeesCtrl:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/profile-employees-96fda10ad0.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/profile-employees-min-2726e58282.1682593322983.js")}]},redirectTo:function(){if("admin"!==window.empEpguRole&&"chief"!==window.empEpguRole)return!SmartPhone.isAny()||SmartPhone.isAny()&&!SmartPhone.isPhone()?"/info":SmartPhone.isAny()&&SmartPhone.isPhone()?"/start":void 0}})}])}(),jQuery.ajaxSettings.timeout=6e4,$(document).ajaxError(function(e,t){624==t.status&&UnauthorizedRedirect()});var dependencies=[],baseDependencies=["oc.lazyLoad","ngSanitize","epguUser","profileConfig","epguNgRoute","ngDialog","ngTouch","initData","angular-momentjs","perfect_scrollbar","paymentPage","errorPage","duScroll","sticky","ipCookie","search"],portalDependencies=["zeroStepPage","landingPage","feedbackPage","informationPage","structurePage","pfr","healthCard","nps","occasionPage","landingPlayerPage","invintation","faqsPage","profileNotificationPage","profileEmployeesPage","profileTransportsPage","quizPage","subscription","requests","universityPage","swipe","fsspProceedJud"],dependencies="PARTNERS"===window.viewType?baseDependencies.concat(portalDependencies,"partnersPages"):"LK"===window.viewType?baseDependencies.concat(portalDependencies,"profileInfoPage","profileNotificationSetupPage","profileMailPage","serverForm.directives","serverForm.services","serverForm.constants","serverFormWidgets.general","serverForm"):"MAP"===window.viewType?baseDependencies.concat("mapPage"):baseDependencies.concat(portalDependencies,["kndForm","frgu","formServerPage","catalogPage","landingPages","fsspPage","fnsPage","gibddPage","indexPage"]);!function(){"use strict";angular.module("epgu",dependencies).factory("protectionInterceptor",["$q","$rootScope","$injector","$timeout",function(e,t,a,s){var l=!1,c={};return{responseError:function(r){var o,n,i;return 428===r.status&&"Firewall check failed"===r.data.error&&!l&&!c[r.config.url]||l?(c[r.config.url]=1,o=a.get("ProtectionService"),l||o.generateCookieHashByUserData(),l=!0,n=e.defer(),i=t.$on("protectHash",function(e,t){if(t){if(t===o.schemaError)return void n.reject(r);l=!1,o.clearHash(),n.resolve(s(function(){return a.get("$http")(r.config)},1e3))}else n.reject(r);i()}),n.promise):e.reject(r)}}}]).factory("httpRequestInterceptor",["$q","ToggleCookie","$rootScope",function(r,o,t){return{request:function(e){if(t.isLk||-1===location.pathname.indexOf("new-portal-on")){if(t.isLk||-1===location.pathname.indexOf("new-portal-off"))return-1==e.url.indexOf(".html")&&-1==e.url.indexOf("vbeta.gosuslugi.ru")&&(e.headers["X-TimeZone-Offset"]=-(new Date).getTimezoneOffset()/60),e;o.eraseCookie("new-portal")}else o.createCookie("new-portal",1);window.location=t.betaUrl},responseError:function(e){if(-1!==e.config.url.indexOf("/pay/v1/informer/fetch")&&401===e.status)return r.resolve(e);if(401===e.status||624==e.status)eraseCookie("user_id_das"),o.eraseCookie("bio_t"),o.eraseCookie("acc_t"),o.eraseCookie("bior_t"),location.href="/auth/esia/?redirectPage="+location.pathname+location.search+location.hash;else if(503!==e.status||(t=e.config.url,["api/pay/v1/informer/fetch"].some(function(e){return-1<t.indexOf(e)})))if(505===e.status)window.location="/505";else{if(506!==e.status)return r.reject(e);window.location="/506"}else window.location="/503";var t}}}]).config(["$sceDelegateProvider","$httpProvider","$compileProvider",function(e,t,r){t.interceptors.push("protectionInterceptor"),t.interceptors.push("httpRequestInterceptor"),e.resourceUrlWhitelist(["self",window.staticDomain+"**"]),e.resourceUrlWhitelist(["self",window.staticDomain+"**"]),t.interceptors.push(["$q","ToggleCookie",function(t,r){return{responseError:function(e){return 624!=e.status&&401!==e.status||(eraseCookie("user_id_das"),r.eraseCookie("bio_t"),r.eraseCookie("bior_t"),UnauthorizedRedirect()),t.reject(e)}}}]),r.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|file|blob):/),t.useApplyAsync(!0)}]).controller("footerCtrl",["$scope","$rootScope",function(e,t){e.supportVisible=!1}]).run(["$templateCache","$$animateJs","$rootScope","$location","FormServer","$moment","$window","$document","$timeout","$interval","$q","RegionService","$route","PaymentService","ngDialog","DisclaimerService","npsService","LangService","LkService","$routeParams","PerformanceService","DetectErrorLink","userTypeService","CacheRequestService","ipCookie","$http","PsoWidgetInitializer","PsoWidget","MainPageMetric","MainPageService","redirectAppService","newsDateService","CmsPageRequestService","MailDeliveryService","UserService","CmsPageRequestAddParams","CMSService","ToggleCookie","NewLkSwitcher","NewPaySwitcher","MainPageUser","ResendService",function(F,M,m,s,j,x,t,r,n,G,B,q,z,H,a,V,l,h,Y,c,K,W,o,Q,Z,J,i,u,d,p,X,ee,te,f,re,e,oe,g,ne,v,ie,ae){x.locale("ru"),document.addEventListener("DOMContentLoaded",function(){e.getPageZoom()}),window.onresize=function(){e.getPageZoom()};function y(e){q.get().then(function(e){var t=e.title;"00000000000"==e.id?t=h.getMessage("main.menu.selectLocation"):m.$applyAsync(function(){m.userSelectedRegionName=t,m.firstTimeShow=!1}),Z("userSelectedRegion",e.id,{domain:m.cookieDomain,path:"/",expires:8760,expirationUnit:"hours"}),m.setRegion(t)}).catch(function(){var e=Z("userSelectedRegion");e&&e!==m.userSelectedRegion?(m.userSelectedRegion=e,y()):(m.userSelectedRegion="00000000000",m.setRegion(h.getMessage("main.menu.selectLocation"))),s.path("/404")})}m.isMpWebView=(se=window.navigator.userAgent,-1!==["mp_gosuslugi_ios","mp_gosuslugi_android","mp_gosuslugi_huawei"].findIndex(e=>-1!==se.indexOf(e))),ne.init(),m.setRegion=function(e){var t=B.defer();return t.resolve(!0),t.promise};"L"===m.userType&&m.isLk&&!m.openLkForEveryone&&(window.location=m.lkLegalUrl),"P"===m.userType&&"LK"===m.viewType&&-1===location.pathname.indexOf("integrationModuleDraft")&&(g.eraseCookie("lkul"),window.location=m.lkUrl),"PARTNERS"==m.viewType||m.isMainPage||p.getAll(),m.leftMenuShow=!1,m.catalogMenuClick=function(e){e.preventDefault(),e.stopPropagation(),m.leftMenuShow=!m.leftMenuShow,m.leftMenuShow&&(m.menuShow=!1)},m.logoClick=function(e){window.location.href=e},m.cacheRequestStamp=Q.getCacheStamp(),W.init(),m.authClick=function(){m.sendMainPageMetric("mainauth"),d.legalEntitySend("Войти"),location.href=m.loginUrl},m.registerClick=function(){m.sendMainPageMetric("mainreg"),d.legalEntitySend("Зарегистрироваться"),location.href=m.registrUrl},m.sendMainPageMetric=function(e){d.send(e)},m.openSocial=function(e,t,r){e.preventDefault(),m.sendFooterMetric({title:t,url:r,target:"_blank"})},"PARTNERS"===m.viewType||m.gosbarUrl||(p.getMainBlocksData(),m.detectRegionDf.promise.finally(function(){y(),m.$on("region-changed",y)})),m.redirectFooterLink=function(e){var t=e.url;e.urlsInfo&&(t=m.logined?e.urlsInfo.authorized:e.urlsInfo.default),"_blank"===e.target||e.ico?window.open(t,"_blank","noopener noreferrer"):location.href=t},m.openFooterLink=function(e,t){e.preventDefault(),m.sendFooterMetric(t)},m.sendFooterMetric=function(e){var t;window.yaCounter24845174?(t={footer:[e.title]},window.ym(24845174,"reachGoal","footer",t,function(){setTimeout(function(){m.redirectFooterLink(e)},100)})):m.redirectFooterLink(e)},$(document.body).delegate('input[readonly="readonly"], textarea[readonly="readonly"]',"focus",function(e){$(e.currentTarget).blur()}),m.isShowSwitcherBanner=function(){return"P"!==m.userType&&m.lkUlSwitchBanner},m.toggleNewLkCookie=function(){g.eraseCookie("lkul")},m.switchLkVersion=function(){m.toggleNewLkCookie(),window.location.href=m.lkUrl},m.backButtonClick=function(){m.backButton=!1,m.$broadcast("back")},m.urlHistoryBack=function(){t.history.go(-1)},m.dashboardClick=function(e){e.target&&e.target.href?"/auth/logout"!==e.target.pathname&&(location.href=e.target.href):e.stopPropagation()},m.logout=function(e){e.stopPropagation(),location.href=m.logoutUrl+"?_="+Math.random()},m.login=function(e){e.stopPropagation(),location.href=m.lkUrl},m.newMenuItemClick=function(e,t){switch(e.stopPropagation(),t){case"doc":m.sendDocMetric(e);break;case"bell":location.href=m.lkUrl+"overview";break;case"orders":location.href=m.lkUrl+"orders";break;case"pay":location.href=m.betaUrl+"pay";break;case"profile":location.href=m.lkUrl+"settings/account";break;case"loginAsOrganization":location.href=m.lkUrl+"roles";break;case"suitecase":location.href=m.lkUrl+"org-profile"}},m.sendDocMetric=function(e){e.stopPropagation(),metricReachGoal24845174("todocuments_from_main_old_",{type:m.version}),location.href=m.lkUrl+"profile"},m.otherLogin=function(e){e.stopPropagation(),window.location="/auth/esia/?redirectPage="+m.lkUrl},m.menuClick=function(e){if("doclink"==e.target.id)return!(m.docsDashboardShow=!0);e.stopPropagation(),m.isLk?(m.docsDashboardShow?m.docsDashboardShow=!1:m.menuShow=!m.menuShow,m.menuShow?d.send("personHeader","open"):d.send("personHeader","close")):(m.menuShow=!m.menuShow,m.menuShow&&(m.leftMenuShow=!1))},m.isDesktop=function(){return!SmartPhone.isAny()},m.isMobile=function(){return SmartPhone.isAny()&&SmartPhone.isPhone()},m.isPad=function(){return SmartPhone.isAny()&&!SmartPhone.isPhone()},m.isPortrait=function(){return SmartPhone.isPortrait()},m.isLandscape=function(){return!SmartPhone.isPortrait()},m.checkRedirectByUserType=function(){var e;m.logined&&(e=window.redirectMapWithUserType.find(function(e){return e.from===location.pathname&&e.userType===m.userType}))&&(/^(http|\/\/)/.test(e.to)?location.replace(e.to):s.path(e.to))};var se,b,w="ontouchstart"in window||navigator.msMaxTouchPoints;function le(e){var t;w&&!b||(m.$broadcast("body-click",e.target),t=angular.element(e.target),m.menuShow?0<=["close-menu","content-shadow"].indexOf(e.target.className)&&n(function(){m.menuShow&&d.send("personHeader","close"),m.menuShow=!1},0):["user-menu","login-name","float-menu","doclink"].indexOf(e.target.id)<0&&!t.is('a[target="_self"]')&&n(function(){m.menuShow&&d.send("personHeader","close"),m.menuShow=!1},0))}function S(t){var r=["/entrepreneur","/legal-entity","/","/foreign-citizen"];o.onGosBarChange(),m.$apply(function(){m.userTypeGosBar=t,m.mainUrl=R();var e=o.getUserType().rootPath;"PA"!==t&&-1!=r.indexOf(s.path())?m.userId?s.path(e):window.location=m.betaUrl+e.slice(1):"PA"===t?window.location=m.partnersUrl:/^\/[r]\/.*/.test(s.path())||-1!=r.indexOf(s.path())?s.path(e):-1==r.indexOf(s.path())&&(de(),p.clear())})}function P(e){m.searchModalShow&&(e&&e.stopPropagation(),m.$broadcast("search-modal-click",e,{isClick:b,isTouch:w}))}$(document).on("touchstart",function(){b=!0,P()}),$(document).on("touchmove",function(){b=!1,P()}),r.on("click",function(e){w||(b=!0),le(e),P(e)}),m.$on("informerGepsHeader.closeMenu",function(e,t){le(t.event)}),m.$on("$routeChangeError",function(e,t,r,o){o&&(!0===o.invalidRights?location.href="/auth/esia/?redirectPage="+encodeURIComponent(location.pathname+location.search+location.hash):s.path("/")),m.loading=!1}),m.$on("$routeChangeSuccess",function(){m.checkRedirectByUserType();function e(){window.yaCounter24845174?ym(24845174,"hit",window.location.href,{referer:m.preUrl}):setTimeout(e,500)}var t=document.getElementsByClassName("PGU-SF-Dialog-Show"),t=(0<t.length&&t[0].classList.remove("PGU-SF-Dialog-Show"),o.clearHeaderFilter(),m.loadingSwitchRoleFromLk,window.location);m.loginUrl=m.loginUrlOrigin+t.pathname+t.search+t.hash,location.href.indexOf("#")==location.href.length-1&&(window.location=location.href.slice(0,location.href.length-1));e()}),m.$on("cmsPageRequestEvent",function(e,t){te.sendCmsPageRequest(t).then(function(){u.openWidgetAndGotoChat()})}),window.addEventListener("load",function(){i.isPsoRequired()&&(i.isPsoLoaded()?u.hideWidget():i.loadAndRunPso()),window.isfirstPageRef=!1,window.defaultPsoTab=m.defaultPsoTab,i.loadWidgetMinimax()}),m.$on("$locationChangeSuccess",function(e,t,r,o){n(function(){i.isPsoRequired()?i.isPsoLoaded()?(u.showWidget(),u.attachToFooter(!0),m.defaultPsoTab&&"info-tab"===m.defaultPsoTab?u.openHelpTab():i.updatePsoEnvironmentData()):i.loadAndRunPso():u.hideWidget()})}),m.$on("$routeChangeStart",function(e,t){"function"==typeof updateSeoData&&updateSeoData({metaTitle:"Портал государственных услуг Российской Федерации",metaDescription:"Единый портал государственных услуг. На портале госуслуг можно записаться к врачу, получить загранпаспорт, записать ребенка в детский сад, проверить и оплатить штрафы или судебную задолженность",metaKeyWords:"госуслуги, госпортал, государственные услуги"}),!t.$$route||"informationSubCtrl"!=t.$$route.controller&&"informationNewsCtrl"!=t.$$route.controller||(ee.pageChanged=e.currentScope.activePageForHeader),m.disclaimers.additional=[],m.catalogShown=!1,t.$$route&&v.isPaymentController(t.$$route.controller)&&v.redirectToNewPay(t.$$route.controller,t.pathParams,t.params,e);t=m.manualRegions[s.$$path.replace("/r/","")],e=-1<s.$$path.search("/o/"),m.isMainPage=!window.isLk&&(!(!t||!t.okato)||e||"/"===s.$$path),"undefined"!=typeof FormPlayer&&FormPlayer&&(FormPlayer.urlIsChanged=!0),m.loading=!0,t=s.search().lang;t&&~m.allowedLangs.indexOf(t)&&h.setLang(t),window.Gosbar&&m.gosbarManager&&(y(),m.gosbarManager.updateConfig({language:T(),picker:"ru"==m.lang?k():[]})),!1!==window.isfirstPageRef&&(window.isfirstPageRef=!0),m.preUrl=window.isfirstPageRef?document.referrer:window.location.href});function C(){n(function(){var e=angular.element("[scroll-anchor]");0<e.length&&r.scrollToElementAnimated(e,0,400)},0)}function ce(e){function t(){for(var e=0,t=0,r=a.children(),o=0;o<r.length;o++){var n=r.length-1==o,i=$(r[o]).width();n?e+=i:(e+=i,t+=i)}return{withLast:e,withoutLast:t}}var r,o=$(".epgu-breadcrumbs"),n=$('<div class="epgu-breadcrumbs content-center-box"><ul></ul></div>').css({position:"absolute",visibility:"hidden"}).appendTo("body"),a=n.find("ul"),i=$('<li class="home"><a id="breadcrumbsHome" target="_self" href="'+m.mainUrl+'">'+h.getMessage("main.home")+"</a></li>"),s=n.width(),l=[];if(e instanceof Array&&0<e.length){o.removeClass("hidden"),a.empty().append(i);for(var c=0;c<e.length;c++){var u=e.length-1==c?(r=e[c].text,$('<li class="last"><span title="'+r+'">'+r+"</span></li>")):(r=e[c].text,u=e[c].href,$('<li><a href="'+u+'" title="'+r+'">'+r+"</a></li>"));u.appendTo(a),l.push(u)}for(var d=t(),c=0,p="collapse";d.withoutLast+375>s&&!("delete"==p&&l.length<=c+1);){switch(p){case"collapse":l[c].addClass("collapsed");break;case"collapse-max":l[c].addClass("collapsed-max");break;case"delete":l[c].remove()}if(++c==l.length)switch(p){case"collapse":p="collapse-max",c=0;break;case"collapse-max":$(l[c]).addClass("collapsed-max"),p="delete",c=1}d=t()}d.withLast>s&&$(l[l.length-1]).addClass("collapsed-last")}else o.addClass("hidden");o.replaceWith(n.css({position:"static",visibility:"visible"}))}m.$on("$viewContentLoaded",function(){n(function(){m.loading=!1}),C()}),m.$on("viewContentUpdated",C),m.$on("setScroll",function(){n(function(){var e=angular.element("[scroll-service]");0<e.length&&r.scrollToElementAnimated(e[0],0,0)},0)}),m.$on("scrollToAnchor",C),m.$on("fetchComplete",function(e,t,r){});function E(){var e;window.scroll(0,0),!1!==m.firstTimeShow||m.disableMetric||metricReachGoal24845174("GEO_GOSBAR_FORM","open"),a.isOpen(ue)||(ue=a.open({id:"region-selector",template:window.templatePath+"/tpl/directives/region-select-0f7f29b8a2.html",controller:"RegionSelectorController",className:"region-select-popup",showClose:!1}).id,m.regionSelectOpened=!0,(e=f.getCookieSession())&&window.sessionStorage.getItem("ezpRemind")!==e&&window.sessionStorage.setItem("ezpRemind",e))}m.$watch("breadcrumbs",function(e,t){angular.equals(t,e)||ce(e)});var ue,T,k,I,de=function(){document.getElementById("breadcrumbsHome").href=m.mainUrl};m.initPayment=v.initPaymentNew,m.gosbarUrl&&(m.allowedLangs.unshift(m.allowedLangs.splice(m.allowedLangs.indexOf(m.lang),1)[0]),m.gosbarNav=function(e){/^\//.test(e)?(s.path(e),m.$$phase||m.$apply()):window.location.href=e},T=function(){return m.allowedLangs.unshift(m.allowedLangs.splice(m.allowedLangs.indexOf(m.lang),1)[0]),{visible:m.allowedLangs,onChange:function(e){m.isLk||m.isMap&&"ru"!=e?location.href=m.betaUrl+"foreign-citizen?lang="+e:(("ru"!=e?s.path("/foreign-citizen"):s.path(s.path())).search({lang:e}),h.setLang(e),m.gosbarManager&&m.gosbarManager.updateConfig({picker:"ru"==e?k():[]}),y())}}},k=function(){var e,t=[{text:h.getMessage("main.menu.forCitizen"),url:"/",userType:"P",onItemSelect:function(){S("P")}},{text:h.getMessage("main.menu.forLegal"),url:"/legal-entity",userType:"L",onItemSelect:function(){S("L")}},{text:h.getMessage("main.menu.forEntrepreneurs"),url:"/entrepreneur",userType:"B",onItemSelect:function(){S("B")}},{text:h.getMessage("main.menu.forForeignCitizen"),url:"/foreign-citizen",userType:"F",onItemSelect:function(){S("F")}}];return m.partnersUrl&&t.push({text:h.getMessage("main.menu.forPartners"),url:m.partnersUrl,userType:"PA",onItemSelect:function(){S("PA")}}),"PARTNERS"===m.viewType?(e=t[t.length-1],t.splice(t.length-1,1),t.unshift(e)):(e=$.grep(t,function(e){return e.userType==(m.userTypeGosBar||m.userType)||e.url===s.path()}))&&e.length&&t.unshift(t.splice(t.indexOf(e[0]),1)[0]),t},"B"===m.userType||"L"===m.userType?loadWidgetGosBar(function(){m.webViewMode||m.detectRegionDf.promise.finally(function(){m.asyncLoad=!0;function e(){m.geoPin=!0,m.selectRegion=function(){E()},m.asyncLoad=!0}window.Gosbar?Gosbar.init({cssOrigin:m.gosbarUrlStatic,catalogOrigin:m.gosbarUrlStatic,disableSearch:!0,cssFixed:!1,isWarningText:m.isWarningText&&"true"==m.isWarningText&&"dk"==m.version||!1,picker:"ru"==m.lang?k():[],language:"PARTNERS"!==window.viewType&&T()}).then(function(e){"PARTNERS"!==window.viewType&&(e.displayLocationButton(),e.onLocationLabelClick=E,e.setLocationLabel,m.gosbarManager=e,y(),m.$on("region-changed",y))},function(){e()}):e()})},function(){m.geoPin=!0,m.selectRegion=function(){E()},m.asyncLoad=!0,m.detectRegionDf.promise.finally(function(){y(),m.$on("region-changed",y)})}):(m.asyncLoad=!0,y(),m.$on("region-changed",y))),m.isMpWebView||$.smartbanner({title:"Госуслуги",button:"Открыть",price:"Бесплатно",daysHidden:30,appStoreLanguage:"ru",inGooglePlay:"в Google Play",gosBar:!!m.gosbarUrl,url:X.getRedirectPath()}),m.modalSearch=function(e){r.find(".select-text")[0];return m.searchModalShow=!m.searchModalShow,m.searchModalShow&&m.sendMainPageMetric("searchHeader"),m.menuShow=!1,e.preventDefault(),!1},m.selectRegion=E,m.fromRPGU&&"true"===m.fromRPGU&&m.selectRegion&&m.$applyAsync(function(){window.setTimeout(m.selectRegion,300)});function pe(t,r){function o(){var e=document.getElementById("redirectTimeoutCount");t.ngDialogData.timeout--,e&&(e.style.display="none",e.innerHTML=t.ngDialogData.timeout,e.style.display="block"),0<t.ngDialogData.timeout?I=r(o,1e3):(m.redirectDialog.close(),location.href=t.ngDialogData.url)}t.clickHandler=function(e){e.preventDefault(),t.ngDialogData.clicked||(m.redirectDialog.close(),t.ngDialogData.clicked=!0,location.href=t.ngDialogData.url)},I=r(o,1e3)}function me(e,t){e.process=function(){e.ngDialogData.fullUrl?location.href=e.ngDialogData.url+"?lang=ru":(e.closeThisDialog(),t.url(e.ngDialogData.url+"?lang=ru"))}}m.$on("region-select",E),re.afterLoad().then(function(){m.logined&&m.quizNpsEnabled&&-1==window.location.pathname.indexOf("/nps/")&&l.checkDataNps(function(e){e&&e.serviceTargetId&&(m.npsQuizOpened=!0,m.answer={},m.sendQuiz=function(){var e;m.answer.id&&(e={qaItems:[{questionId:m.answer.quizId,answerId:m.answer.id,answer:m.answer.message}],source:SmartPhone.isAny()?SmartPhone.isPhone()?"MOBILE_EPGU_V3":"TABLET_EPGU_V3":"EPGU_V3",serviceId:m.reestrId,serviceType:"Service"},l.setDataNps(e,function(){m.answer.quittanceSend=!0,m.answer.quittanceSendLoading=!1},function(){m.answer.quittanceSend=!0,m.answer.quittanceSendLoading=!1}))},m.reestrId=e.serviceTargetId,l.getDataNps(e.serviceTargetId,function(e){if(e&&e.blocks&&e.blocks.length){m.answer.quizId=e.blocks[0].questions[0].id,m.answer.title=e.blocks[0].questions[0].text;for(var t=[],r=[],o=0,n=0;n<e.blocks[0].questions[0].answers.length;n++){var i=parseInt(e.blocks[0].questions[0].answers[n].id,0);e.blocks[0].questions[0].answers[n].otherAnswer?m.answer.otherAnswerId=i:(t.push(i),r.push(++o))}10<r.length&&(t.length=r.length=10),m.answer.labels=r,m.answer.ticks=t,m.quittanceSend=!1,m.quittanceSendLoading=!1,m.preClose=function(){var e;m.answer.quittanceSend&&!1===m.answer.quittanceSendLoading||(e={qaItems:[{questionId:m.answer.quizId,answerId:m.answer.otherAnswerId}],source:SmartPhone.isAny()?SmartPhone.isPhone()?"MOBILE_EPGU_V3":"TABLET_EPGU_V3":"EPGU_V3",serviceId:m.reestrId,serviceType:"Service"},l.setDataNps(e))},a.open({template:window.templatePath+"/tpl/nps/nps-popup-f8dc7f2c52.html",scope:m,className:"nps",preCloseCallback:m.preClose})}}))}),m.checkRedirectByUserType(),f.checkPopupAvailable()&&m.$watch("userSelectedRegion",function(){m.userSelectedRegion&&f.checkDeliveryBusinessStatus(function(e){var t;e&&e.items&&(t=e.hint&&e.hint.available,e=f.prepareSubscriptionList(e.items,e.remind,t))&&e.length&&!function(e){var t="P"!==m.userType?"business":"person",r="person"==t?"ezpRemind":"ezpRemindBusiness",o=f.getCookieSession();g.createCookie(r,o,1),m.ezpRemind=!0,a.open({template:window.templatePath+"/tpl/directives/ezp-subscription-10209fcd15.html",controller:"EzpSubscriptionController",className:"ezp-subscription-popup "+t,scope:this,data:{depts:e}})}(e)},!1)}),m.logined&&(window.faqUrlForPso=m.cmsUrl+"page/faqHistory",m.user&&(m.user.orgOid&&""!==m.user.orgOid&&(e.addParams.org_id=m.user.orgOid),m.user.branchOid)&&""!==m.user.branchOid&&(e.addParams.branch_oid=m.user.branchOid),m.isLk)&&ae.checkCurrentUser().then(function(e){m.userBlockedToResending=e&&e.data&&e.data.status}),m.logined&&m.isLk&&f.markAsDelivered()}),pe.$inject=["$scope","$timeout"],m.redirectPopup=function(e,t){t=t||5,m.redirectDialog=a.open({template:window.templatePath+"/tpl/directives/redirect-popup-0c19196f84.html",controller:pe,className:"redirect-popup",preCloseCallback:function(){I&&n.cancel(I)},data:{timeout:t,url:e}})},me.$inject=["$scope","$location"],m.langPopup=function(e,t){a.open({template:window.templatePath+"/tpl/directives/lang-redirect-popup-d1c189ecfe.html",className:"redirect-popup lang-redirect-popup",controller:me,data:{url:e,fullUrl:t||!1}})},m.onpopstateModel={},t.onpopstate=function(e){var t=s.path(),t=m.onpopstateModel[t];t&&t.callback.call(t.context),m.modalShow=!1},m.goBack=function(){t.history.go(-1)};function A(){"ru"!=m.lang?m.langPopup(url):location.href=m.betaUrl+url.replace(/^\//,""),m.menuShow=!1}var he;he=s.path,s.path=function(e,t){var r,o;return!1===t&&(r=z.current,o=m.$on("$locationChangeSuccess",function(){m.loading=!1,z.current=r,setTimeout(o,300)})),he.apply(s,[e])},m.documentTitle=function(e){r.prop("title",e)},m.unHtml=function(e){return $("<div/>").html(e).text().trim()},m.getCatalogIcon=function(e,t,r){return e&&0<e.length&&(e=e.find(function(e){return e.iconType===t}))&&e.path?e.path:r&&-1===r.indexOf("http")?m.staticDomainUrl+r:r||""},m.getCatalogIconData=function(e,t,r){if(e&&0<e.length){e=e.find(function(e){if(e.iconType==t)return!0});if(e&&e[r])return e[r]}};function D(){s.$$search.query&&delete s.$$search.query}function R(){var e=o.getUserType();return e.individual?m.isLk||window.isMap?m.betaUrl:"ru"===m.lang?"/":"/foreign-citizen":m.isLk||window.isMap?m.betaUrl+e.rootPath:e.rootPath}m.catalogClick=function(e){var t;D(),-1!=["/foreign-citizen"].indexOf(s.path())&&"ru"==m.lang?(t=e,m.redirectPopup("https://www.gosuslugi.ru/pgu/cat/POPULAR.html?recipCategory=FOREIGNER",5),t.preventDefault()):"ru"!=m.lang?(m.langPopup("/catalog"),e.preventDefault()):"pad"==m.version?("F"===o.getUserType().userTypeGosBar&&(location.href=m.betaUrl+"foreign-citizen"),"PARTNERS"==m.viewType&&(s.path("/catalog"),e.preventDefault()),m.catalogShown?(m.catalogShown=!1,window.isLk?location.href=m.betaUrl+"catalog":s.path("/catalog")):m.catalogShown=!0,m.menuShow=!1,e.preventDefault()):(e.preventDefault(),m.catalogShown=!1,window.isLk?location.href=m.betaUrl+"catalog":s.path("/catalog")),m.menuShow=!1},m.catalogClick2=function(e){A()},m.feedbackClick=function(e){D(),A(),e.preventDefault()},m.newSearchClick=function(e){e.preventDefault();e=encodeURIComponent(location.href);window.location=m.betaUrl+"newsearch?control=search_button&link="+e},m.newsClick=function(e){"PARTNERS"==m.viewType?A():(D(),A(m.viewType)),e.preventDefault()},m.documentsClick=function(e){D(),A(),e.preventDefault()},m.rolesClick=function(e){m.isLk?s.path("/roles"):t.location.href=m.lkUrl+"roles",e.preventDefault()},m.showLangPopup=function(e,t){var r=e.target.href;t&&m.sendMainPageMetric(t),"ru"!==m.lang?(m.langPopup(r,!0),e.preventDefault()):"ru"!==m.lang||"mob"!==m.version&&"pad"!==m.version||(location.href=r)},m.activePageForHeader=s.path().replace(/\//g,""),m.mainUrl=R(),m.$on("$routeChangeStart",function(e,t){m.activePageForHeader=s.path().replace(/\//g,""),m.mainUrl=R()}),m.paymentsClick=function(e){D();var t=m.betaUrl+"pay";"ru"!==m.lang&&m.userId?m.langPopup(t,!0):window.location.href=t,e.preventDefault()},m.healthClick=function(e){D(),A(),e.preventDefault()},m.backToCatalog=function(e){var t=c.passportId||c.id,r=c.targetId||"";"/10005"==s.path()?L("/category/passport",e):"/10010"==s.path()||"/10011"==s.path()?L("/10005",e):-1<m.redirectToLk.indexOf([t,r].join("/"))?L(m.lkUrl,!0):m.cachedPathes&&"categoryhealth"!=m.activePageForHeader?fe(m.cachedPathes[t],t,r,e):L("/category",e)};var _,fe=function(e,t,r,o){var n=s.path(),i=m.userTypeGosBar||m.userType||"P",i="P"===i?"":"L"===i?"l_":"s_";if(-1<n.indexOf(c.passportId+"/"+c.targetId+"/info"))if(e.services&&1<e.servicesSize){for(var a=0;a<e.services.length;a++)if(e.services[a].epguId==r)return e.services[a].manualCard||c.block?void L("/"+t+"/"+r,o):e.services[a].groupCode?void L("/"+t+"/"+e.services[a].groupCode,o):void L("/"+t,o)}else e.services&&1==e.servicesSize?e.services[0]&&e.services[0].manualCard?L("/"+t+"/"+r,o):e.services[0].groupCode?L("/"+t+"/"+e.services[0].groupCode,o):e.colorCode?L("/category/"+i+e.colorCode,o):L("/category",o):L("/"+t,o);else if(-1<n.indexOf(t+"/"+r))if("10001"===t&&"1"===r||"10002"===t&&"1"===r||"10003"===t&&"1"===r)L("/category"+(e.colorCode?"/"+i+e.colorCode:""),o);else if(1<e.servicesSize){if(e.services)for(a=0;a<e.services.length;a++)if(e.services[a].epguId==r)return e.services[a].groupCode?void L("/"+t+"/"+e.services[a].groupCode,o):void L("/"+t,o);L("/"+t,o)}else e.services[0].groupCode?L("/"+t+"/"+e.services[0].groupCode,o):L("/category"+(e.colorCode?"/"+i+e.colorCode:""),o);else-1<n.indexOf(t)&&(e&&e.colorCode?L("/category/"+i+e.colorCode,o):L("/category",o))},L=function(e,t){t?window.location=e:s.path(e)};if(re.afterLoad().then(function(){m.enableCounters&&(!m.isLk||m.isLk&&"/notifications"!==s.path())&&Y.getAllCounters().then(function(e){m.userCounters=e})}),_=!1,m.catalogEnter=function(){var e;"F"!==o.getUserType().userTypeGosBar&&-1==["/category"].indexOf(s.path())&&(e=function(){-1==s.path().indexOf("/category")&&angular.element('[class*="catalog-on"]:hover').length?n(e,800):(m.catalogShown=!1,_=!1)},_&&!m.catalogShown?m.catalogShown=!0:"dk"!=m.version||_||n(function(){_=!0,m.catalogShown=!0,e()},800))},window.matchMedia){var O,U,ge=function(e){e.matches&&location.reload()},ve=window.matchMedia("print"),ye=window.matchMedia("screen and (width: 960px) and (orientation:landscape)"),be=window.matchMedia("screen and (width: 600px) and (orientation:portrait)"),we=window.matchMedia("screen and (width: 1024px) and (orientation:landscape)"),N=(m.print=ve.matches,ve.addListener(function(e){m.print=ve.matches,m.$$phase||m.$apply()}),{nexus:"7",asus:["fonepad","K012"]}),Se=window.navigator.userAgent.toLowerCase();for(U in N)switch(U){case"nexus":O=new RegExp(U+"\\s"+N[U]),Se.match(O)&&(ye.addListener(ge),be.addListener(ge));break;case"asus":for(var Pe="\\b("+U,Ce=0;Ce<N[U].length;Ce++)Pe+="|"+N[U][Ce].toLowerCase();Pe+=")\\b",O=new RegExp(Pe),Se.match(O)&&we.addListener(ge)}}}])}(),function(){"use strict";function o(e,t){return t[4<e%100&&e%100<20?2:[2,0,1,1,1,2][e%10<5?e%10:5]]}angular.module("epgu").filter("to_money",function(){return function(e,t){var r,o;return isNaN(e)?e:(r=2,t=void 0!==(t=t||",")?t:",",o=void 0!==(o=" ")?o:" ",(r=(e="string"!=typeof(e=void 0!==(e=e)&&null!=e?e:"0")?e.toFixed(r).toString():e).split("."))[0]=r[0].replace(/\B(?=(\d{3})+(?!\d))/g,o),r.join(t))}}).filter("to_money_no_zero",function(){return function(e){return"string"==typeof(e=void 0!==(e=e)&&null!=e?e:"0")&&(e=e.replace(/ /g,"").replace(",","."),isNaN(e)||(e=Number(e))),(t=(e="string"!=typeof e?e.toFixed(2).toString():e).split("."))[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g," "),e="00"!==t[1]?t.join(","):t[0];var t}}).filter("floor",["$filter",function(o){return function(e){var t,r;if(e)return t=0,(r=e.split(".")[1])?"00"!=r&&(t=2):t=0,e=e.replace(/\s/g,""),o("currency")(e,"",t).trim()}}]).filter("characters",[function(){return function(e,t,r){if(!isNaN(t)){if(t<=0)return"";if(e&&e.length>t){if(e=e.substring(0,t),r)for(;" "===e.charAt(e.length-1);)e=e.substr(0,e.length-1);else{t=e.lastIndexOf(" ");-1!==t&&(e=e.substr(0,t))}return e+"…"}}return e}}]).filter("toUppercaseString",[function(){return function(e,t){var r;return e&&(r="",-1!=(t=e.indexOf(t)))&&(r+=e.slice(0,t),1<(t=e.slice(t).split(" ",2)).length?r+=' <span class="text-uppercase">'+t[0]+"</span> "+t[1]:r+=' <span class="text-uppercase">'+t[0]+"</span>",e=r),e}}]).filter("file_size",[function(){return function(e){return e<=102400?Math.ceil(e/1024)+" Кб":Math.round(e/1024/1024*100)/100+" Мб"}}]).filter("breakText",[function(){return function(e){if(e)return e.replace(/[,.!?]/g,function(e,t,r){return e+" "})}}]).filter("decapitalize",[function(){return function(e){return e.substring(0,1).toLowerCase()+e.substring(1)}}]).filter("to_trusted",["$sce",function(t){return function(e){return e?t.trustAsHtml(e.toString()):""}}]).filter("simple_typography",function(){return function(e){return e&&e.replace(/(\s[а-яА-Яa-z-A-Z]{1,2})(\s+)/g," $1&nbsp;")}}).filter("isEmpty",function(){var t;return function(e){if(!e)return!1;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}}).filter("timeToEvent",["$moment",function(a){return function(e,t,r){var o,n,i;return e?("EQUEUE"!==t&&"IM"!==t||"ORDER"!==r&&"APPEAL"!==r&&"EQUEUE"!==r&&"DRAFT"!==r&&"IMExpireDate"!=r||(o=new RegExp("T"),i=new RegExp("-"),e=(i=e.split(o)[0].split(i))[0]+"-"+i[1]+"-"+i[2]+" "+e.split(o)[1].substring(0,5)),("EQUEUE"!==t&&"IM"!==r||"IMExpireDate"===r)&&"IMExpireDate"===r?a(e).format("HH:mm DD.MM.YYYY"):(i=a(),o=a(e),t=a(e),r=i.startOf("day"),e=o.startOf("day"),i=r.diff(e,"days"),(n=Math.abs(i)<=1?{0:"Сегодня ","-1":"Завтра ",1:"Вчера "}[i]:n)?n+t.format("HH:mm"):t.format("DD.MM.YYYY HH:mm"))):""}}]).filter("replaceNewLine",function(){return function(e){return e.replace(/(<br\/?>){1,}/g,". ")}}).filter("timeLeft",["$moment",function(n){return function(e){var t,r,o;return e?(t=n(),r=+(e=n(e)).diff(t,"minutes"),o=+e.diff(t,"days"),e<t||r<=1440?"Будет удалён в ближайшее время":4320<r?"Будет удалён через "+(o+" "+["день","дня","дней"][4<(e=o)%100&&e%100<20?2:[2,0,1,1,1,2][e%10<5?e%10:5]]):""):""}}]).filter("rusDateTime",["$moment",function(t){return function(e){return t(e).format("DD.MM.YYYY HH:mm")}}]).filter("rusTimeDate",["$moment",function(t){return function(e){return t(e).format("HH:mm DD.MM.YYYY")}}]).filter("rusDateTimeSec",["$moment",function(t){return function(e){return t(e).format("DD.MM.YYYY HH:mm:ss")}}]).filter("rusDate",["$moment",function(t){return function(e){e=t(e).format("DD.MM.YYYY");return"Invalid date"==e?"":e}}]).filter("fullDateTime",["$moment",function(t){return function(e){e=t(e).format("DD MMMM YYYY, HH:mm");return"Invalid date"==e?"":e}}]).filter("convertDate",["$moment",function(n){return function(e,t,r,o){e=n(e,t,o||"en");return e.isValid()?e.locale("ru").format(r):""}}]).filter("sliceZeroDays",[function(){return function(e){return e&&e.replace(/^0+/,"")}}]).filter("rusDateFlex",["$moment",function(r){return function(e,t){e=r(e).format(t||"LL");return"Invalid date"==e?"":e}}]).filter("time",["$moment",function(t){return function(e){e=t(e).format("HH:mm");return"Invalid date"==e?"":e}}]).filter("timeWithoutTZ",function(){return function(e){var t=new RegExp("T"),r=new RegExp("-"),r=e.split(t)[0].split(r);return r[2]+"."+r[1]+"."+r[0]+" "+e.split(t)[1].substring(0,5)}}).filter("dropdown_filter",function(){var a=["q","w","e","r","t","y","u","i","o","p","\\[","\\]","a","s","d","f","g","h","j","k","l",";","'","z","x","c","v","b","n","m",",","\\."],s=["й","ц","у","к","е","н","г","ш","щ","з","х","ъ","ф","ы","в","а","п","р","о","л","д","ж","э","я","ч","с","м","и","т","ь","б","ю"];return function(e,t,r){if(void 0===r||""===r)return e;for(var o=r.toLowerCase(),n=0;n<a.length;n++)o=o.replace(new RegExp(a[n],"g"),s[n]);var i=new RegExp(r+"|"+o,"i");return e.filter(function(e){return i.test(t?e[t]:e)})}}).filter("dropdownsearch_filter",function(){return function(e,t,r){var o;return void 0===r||""===r?e:(o=r.toLowerCase(),e.filter(function(e){return-1!=e[t].toLowerCase().indexOf(o)}))}}).filter("capitalize",function(){return function(e,t){return e?e.toLowerCase().replace(/([^\W_]+[^\s-]*) */g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}):""}}).filter("chooseNounFormForNumeric",function(){return function(e,r){return null==e?"":e+" "+[0,0,0].map(function(e,t){return r&&r.length>t?r[t]:""})[4<e%100&&e%100<20?2:[2,0,1,1,1,2][e%10<5?e%10:5]]}}).filter("dutyCounter",function(){return function(e){if(e)return e+" "+["заявление","заявления","заявлений"][4<(e=e)%100&&e%100<20?2:[2,0,1,1,1,2][e%10<5?e%10:5]]}}).filter("to_money_pfr",function(){return function(e){return isNaN(e)?e:(t=2,void 0!==(e=e)&&null!=e||(e="0"),Number(e).toFixed(t).toString());var t}}).filter("ext_icon",function(){return function(e){var t=e.lastIndexOf("."),r=e.length;if(~t){e=e.substr(t+1,r-t-1);if(~["doc","jpeg","jpg","mp3","mp4","pdf","png","ppt","pptx","rtf","tif","tiff","txt","wav","xls","xlsx","zip"].indexOf(e))return"file-types-"+e}return"file-types-any"}}).filter("to_crumbs",["$rootScope",function(t){function n(e){return(t.isLk?t.betaUrl:"/")+e.replace(/^\//,"")}return function(e){var t="";if(e&&e.hasOwnProperty("title")){var r,o=0;for(t+="<a href="+n(e.ref)+">"+e.title+"</a>";e.hasOwnProperty("next");)t=t.concat((r=e.next,(++o?"&nbsp;>&nbsp;":"")+("<a href="+n(r.ref)+">"+r.title)+"</a>")),e=e.next}return t}}]).filter("to_partners_crumbs",["$rootScope",function(t){function n(e){return t.partnersUrl+e.replace(/^\//,"")}return function(e){var t="";if(e&&e.hasOwnProperty("title")){var r,o=0;for(t+="<a href="+n(e.ref)+">"+e.title+"</a>";e.next.hasOwnProperty("next");)t=t.concat((r=e.next,(++o?"&nbsp;>&nbsp;":"")+("<a href="+n(r.ref)+">"+r.title)+"</a>")),e=e.next}return t}}]).filter("max_length",function(){return function(e){var t,r,o=SmartPhone.isAny()?SmartPhone.isPhone()?70:130:240;return e&&e.length&&e.length>o?(t=e.substr(0,o-3).lastIndexOf("<b>"),r=e.substr(0,o-3).lastIndexOf("</b>"),-1!=t&&r<t?e.substr(0,t-1)+"...":e.substr(0,o-3)+"..."):e}}).filter("simple_max_length",function(){return function(e,t){var r;return e&&(e.length>t?(e=" "!=e.substr(t+1,1)&&1!=(r=e.lastIndexOf(" ",t))?e.substring(0,r):e.substring(0,t))+"...":e.substring(0,t))}}).filter("highlight",["$sce",function(r){return function(e,t){return t&&e?r.trustAsHtml(e.replace(new RegExp(t,"gi"),'<span class="highlighted">$&</span>')):r.trustAsHtml(e)}}]).filter("inc_format",[function(){return function(e){if(e)return e.replace(/INC0+/i,"INC")}}]).filter("ninety_nine",[function(){return function(e){return 99<e?"99+":e}}]).filter("lk_url",["$rootScope",function(t){return function(e){return e=e?e.replace(/^\//,""):"",(t.isLk?"/":t.lkUrl)+e}}]).filter("remove_blank",function(){return function(e,t){if(!t)return e;for(var r=(r=t.replace(/\s{2,}/g," ")).toLowerCase(),o=[],n=0;n<e.length;n++)e[n].shortTitle&&-1!=e[n].shortTitle.replace(/\s{2,}/g," ").toLowerCase().indexOf(r)&&o.push(e[n]);return o}}).filter("remove_tags",[function(){return function(e){var t,r,o;return e&&(t=SmartPhone.isAny()?SmartPhone.isPhone()?150:170:154,(o=e.replace(/<\/?[^>]+>/g," ")).length>t?(o=" "!=o.substr(1+t,1)&&1!=(r=o.lastIndexOf(" ",t))?o.substring(0,r):o.substring(0,t))+"...":o.substring(0,t))}}]).filter("beta_url",["$rootScope",function(t){return function(e){return e=e?e.replace(/^\//,""):"",(t.isLk?t.betaUrl:"/")+e.replace(/^\//,"")}}]).filter("event_link",["$rootScope",function(o){return function(e,t,r){return e.match(/\/pgu\/api\/lkfile\/downloadMessageFile/)?o.storageApi+"files/"+t+"/101/download?mnemonic="+r:e}}]).filter("telFormatter",[function(){return function(e){var t;return e?(t=e.toString().trim().replace(/^\+/,"")).match(/[^0-9]/)||11!=e.length?e:((e=7==(e=t[0])?"+"+e:e)+" ("+t.slice(1,4)+") "+(e=(e=t.slice(4)).slice(0,3)+"-"+e.slice(3))).trim():""}}]).filter("limitHtml",[function(){return function(e,t){var r;return e?t?t<(r=String(e).replace(/<[^>]+>/gm,"")).length?r.substr(0,t-1)+" ...":r:e:""}}]).filter("decline",function(){return function(e,t){if(e)return e+" "+o(e,t)}}).filter("availableTillInMinutes",[function(e){return function(e){var e=Math.ceil(e/60),t=e%60,e=Math.floor(e/60),r=e?e+" "+o(e,["час","часа","часов"]):"";return r=t?r+(e?" ":"")+t+" "+o(t,["минуту","минуты","минут"]):r}}]).filter("login",function(){return function(e){return e?3==(t=(e=e).replace(/\s\s+/g," ").split(" ")).length?t[0]+" "+t[1].charAt(0).toUpperCase()+"."+t[2].charAt(0).toUpperCase()+".":2==t.length?t[0]+" "+t[1].charAt(0).toUpperCase()+".":3<t.length?t.slice(0,t.length-2).join(" ")+" "+t[t.length-2].charAt(0).toUpperCase()+"."+t[t.length-1].charAt(0).toUpperCase()+".":e:"";var t}}).filter("numberFormat",function(){return function(e,t,r){return null==e&&(e=0),"string"!=typeof(e=t?(e="number"!=typeof e?Number(e.replace(/ /g,"").replace(/,/g,"."))||0:e).toFixed(t).toString():e)&&(e=e.toString()),r&&((t=e.split("."))[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g," "),e=t.join(",")),e=e.replace(".",",")}}).filter("detectLink",function(){var e=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi;return function(r){return r.replace(e,function(){var e=arguments[0],t=arguments[arguments.length-2];return'href="'==r.substring(t,t-15).toLowerCase().replace(/ /g,"").replace(/'/g,'"').slice(-6)?e:'<a href="'+e+'" target="_blank">'+e+"</a>"})}}).filter("dutyCounterPayment",function(){return function(e){if(e)return e+" "+["платеж","платежа","платежей"][4<(e=e)%100&&e%100<20?2:[2,0,1,1,1,2][e%10<5?e%10:5]]}})}(),function(){"use strict";angular.module("epgu").factory("OkatoService",["$rootScope","ToggleCookie",function(r,o){return{getFederalNum:function(){var e=o.readCookie("userSelectedRegion"),e=r.userSelectedRegion||e,t=e?e.substring(0,5):"",e=e?e.substring(0,2)+"00":"0000";return t.match("^711[0-38]\\d$")?e="7110":t.match("^711[4-7]\\d$")?e="7114":t.match("^111\\d{2}$")&&(e="1110"),e+"0000000"}}}]).factory("RegionService",["$rootScope","$http","ipCookie","$q","LkService","$location","$timeout","MainPageService","ToggleCookie",function(n,i,a,s,l,c,u,d,e){var p=Math.random(),m={id:"00000000000",title:"Российская Федерация",path:"Российская Федерация"},h=null,e=e.readCookie("userSelectedRegion");return e&&(n.userSelectedRegion=e,n.regionNotSelected="00000000000"==e),window.regions,{trimRegion:function(e){return e=0==(e+="").indexOf("71")?e.substring(0,4)+"0000000":0==e.indexOf("11")?e.substring(0,3)+"00000000":e.substring(0,2)+"000000000"},get:function(){var o=s.defer();return null!==h&&h.id===n.userSelectedRegion?o.resolve(h):"00000000000"===n.userSelectedRegion||void 0===n.userSelectedRegion?o.resolve(m):i({method:"GET",url:n.nsiApi+"epgu/region/"+n.userSelectedRegion,withCredentials:!0,cache:!0,params:{_:p}}).then(function(e){var t,r;e&&e.data?(t=(e=e.data).name,r=e.path.replace(/\//g," / "),h={id:e.code,title:t,path:r},o.resolve(h)):o.resolve(m)}).catch(function(e){o.resolve(m)}),o.promise},set:function(e){e instanceof Object&&(e=(h=e).id),n.userSelectedRegion=e,n.regionNotSelected="00000000000"==e,n.$$phase||n.$apply(),a("userSelectedRegion",e,{domain:n.cookieDomain,path:"/",expires:8760,expirationUnit:"hours"}),n.userId?l.saveRegion().then(function(e){n.$broadcast("region-changed")}):n.$broadcast("region-changed")},checkNotification:function(e,t){i({method:"GET",url:n.nsiApi+"epgu/region/subscribe",withCredentials:!0,params:{service:e,_:p}}).then(function(e){t(e)},function(e){t(e)})},saveNotification:function(e,t,r){i({method:"POST",url:n.nsiApi+"epgu/region/subscribe",withCredentials:!0,params:{service:e,epguServiceCode:r||"",_:p}}).then(function(e){t(e)},function(e){t(e)})},check:function(e,t,r){var o=s.defer();return"boolean"==typeof e&&e||e.requireRegionCheck?i({method:"GET",url:n.nsiApi+"epgu/region/"+n.userSelectedRegion+"/service/"+t,withCredentials:!0,params:{epguCode:r,_:Math.random()}}).then(function(e){e&&204!=e.status?o.resolve(!0):o.resolve(!1)},function(e){e&&404==e.status&&e.data?o.resolve(e.data):o.resolve(!1)}):o.resolve(!0),o.promise},checkRegions:function(e){e=e.toString();return i({method:"GET",url:n.nsiApi+"epgu/region/"+n.userSelectedRegion+"/services?codes="+e,withCredentials:!0,params:{_:Math.random()}})},detectRegion:function(){n.manualRegions&&"string"==typeof n.manualRegions&&(n.manualRegions=JSON.parse(n.manualRegions)),n.manualRegions=n.manualRegions||"",n.checkRegionCtrl=function(e){var t=e.region&&n.manualRegions[e.region]&&n.manualRegions[e.region].okato,r=e.okato,e=!e.region&&!e.okato;t||r||e||(n.userSelectedRegion=a("userSelectedRegion")||"00000000000",n.detectRegionDf.resolve(),c.path("/404"))},n.detectRegionDf=s.defer();var e,o,t=c.$$path,r=-1<t.search("/r/")?/(\s*\S.*[\/][r][\/])|[\/][r][\/]/:/(\s*\S.*[\/][o][\/])|[\/][o][\/]/,t=t.replace(r,"")!==t?t.replace(r,""):"",r=n.manualRegions[t]&&n.manualRegions[t].okato||t;r?(n.detectRegionIsComplete=!0,"PARTNERS"!=n.viewType&&d.getAll(),n.userSelectedRegion=r,n.detectRegionDf.resolve(),n.userId&&l.saveRegion()):(e=s.defer(),i({method:"GET",url:n.nsiApi+"epgu/detectRegion",withCredentials:!0,cache:!1,headers:{"Cache-Control":"no-cache"},params:{_:p},timeout:e.promise}).then(function(e){o&&u.cancel(o);{var t,r;e&&e.data&&e.data.code?(t=e.data.detectedBy,r=e.data.timeZone,n.userSelectedRegion=e.data.code,n.userId&&("geo"!==t&&"ip"!==t||!r||(e=Number.parseInt(r.replace("UTC",""))-3,r=0<e?"+"+e:e+"",i({method:"POST",url:n.lkApi+"settings/notifications/notificationperiod",params:{onlyTimeZone:!0,offset:r},withCredentials:!0}).then(function(){"ip"!==t||n.disableMetric?"geo"!==t||n.disableMetric||metricReachGoal24845174(window.isEmbedded?"geo_tz_mp":"geo_tz_html5",{OKATO:n.userSelectedRegion}):metricReachGoal24845174("geo_tz_ip",{OKATO:n.userSelectedRegion})})),"db"!==t)&&l.saveRegion(),"ip"!==t||n.disableMetric||metricReachGoal24845174("geo_ip_ok",{OKATO:n.userSelectedRegion}),n.$broadcast("region-changed"),n.detectRegionIsComplete=!0,"PARTNERS"!=n.viewType&&d.getAll()):"PORTAL"!==n.viewType&&"LK"!==n.viewType||n.isEmbedded||(n.detectRegionIsComplete=!0,d.getAll(),n.selectRegion())}n.detectRegionDf.resolve()},function(e){o&&u.cancel(o);n.disableMetric||metricReachGoal24845174("geo_open_first_form_geo",{OKATO:n.userSelectedRegion});n.userSelectedRegion="00000000000",n.detectRegionDf.resolve(),"PORTAL"!==n.viewType&&"LK"!==n.viewType||n.isEmbedded||(n.detectRegionIsComplete=!0,d.getAll(),n.selectRegion())}),o=u(function(){e.resolve()},5e3))},checkRegionHasMfc:function(e,t){var r=s.defer();return i({method:"GET",url:n.catalogApi+"mfc/config/"+(e||n.userSelectedRegion),withCredentials:!0}).then(function(e){e=e&&e.data&&e.data.mfcConfigList;t?e&&e.length&&e[0].isActive?r.resolve():r.reject():e&&e.length?r.resolve():r.reject()},r.reject),r.promise}}}]).factory("NotificationService",["$http","$rootScope",function(r,o){return{cancelEvent:function(e,t){return r({method:"POST",params:{eserviceId:e},url:o.lkApi+"calendar/events/"+t+"/cancel",withCredentials:!0})}}}]).factory("FormServer",["$rootScope","$timeout","PerformanceService","$http","$location","UserService","GetIpshAdditionalAttrs","MainPageMetric","$moment",function(s,n,l,c,i,a,u,e,r){function d(e,r,t){var o,n=angular.copy(s[e].requestTemplate);switch(e){case"fns":o="Fns";break;case"gibdd":o="GibddFines";break;case"gisGmp":o="GisGmp";break;default:o=e}return o+=".FormStep1.Panel1.",$.each(s[e].request,function(e,t){if(void 0!==t&&0<(""+t).length)if(r&&"formatedResponse"===e)n.form.content[o+e]={value:!0};else{if("L"==s.userType&&"vuNumber"==e)return!0;n.form.content[o+e]={value:t}}}),n.form.content[o+"useFailoverCache"]={value:!!t},(t=s.formRequest).parameter=JSON.stringify(n),t}function p(n,e,t){function r(e){var t,r,o={};if(e.statusCodeError||e.error&&0!=e.error.errorCode){if(r=1,e&&e.error)switch(o.ServiceError=e.error.errorCode||e.error.code,e.error.errorCode){case 9:f(t={state:"D"},n);break;case 8:s.informers[n].state="F";break;case 4:s.informers[n].state="H";break;default:s.informers[n].state="F"}u.setFetchData(t,n)}else 99==(t=m(JSON.parse(e.content))).error.code||100==t.error.code?(s.informers[n].state="F",o.ServiceError=t.error.code,r=1):67==t.error.code?(o.ServiceError=t.error.code,s.informers[n].state="H",r=1):0!=t.error.code?(o.ServiceError=t.error.code,s.informers[n].state="D",r=1):(r=0,u.setFetchData(t,n),t.state="E","gibdd"==n&&h(t),f(t,n),s.$emit("informerSuccess",n));"/"!=i.$$path||s.isLk||l.measureEnd("informer"+n,r,o),s.$$phase||s.$apply()}s.informers[n].cacheTime,s.informers[n].cacheAvailable,t=s.lkApi2+"informers/"+n+"/fetch"+(t||""),s.informers[n].state="U",l.measureStart("informer"+n),s.user.informerUId||s.userId,$("html").is(".ie9")||-1!==navigator.appVersion.indexOf("MSIE 10")?c({method:"GET",url:t}).then(function(e){r(e.data)}):epguHandleAtmosphere("long-polling",t,null,"GET",r,function(e){"/"==i.$$path&&l.measureEnd("informer"+n,1,{BrowserError:e.status})}),s.$$phase||s.$apply()}var m=function(e){var t,r={total:0,items:[],request:{},info:{},error:{code:0,message:"Операция выполнена успешно"}},o=["error","total","requestParams","requestInfo","personalData","originalTotal"];return e&&e.error&&0===e.error.code?e.form.content.error&&0!=e.form.content.error.code?r.error=e.form.content.error:((t=e.form.content).total&&t.total.total&&(r.total=t.total.total),t.originalTotal&&t.originalTotal.originalTotal&&(r.originalTotal=t.originalTotal.originalTotal),t.requestParams&&(r.request=t.requestParams),t.requestInfo&&(r.info=t.requestInfo),$.each(t,function(e,t){0<=o.indexOf(e)||(t.$key=e,r.items.push(t))})):(e&&e.statusCodeError&&(r.statusCodeError=e.statusCodeError),r.error={code:e&&e.error&&e.error.code||r.statusCodeError,message:"Сервис временно недоступен"}),r},h=function(e){if(e&&e.items)for(var t=0;t<e.items.length;t++){var r=e.items[t];if(r.originalAmount&&"1"!=r.isPaid){e.withDiscounts=!0;break}}},f=function(e,t){s.informers[t].data=e,s.informers[t].state=e.state,s.$emit("informerDone",t)};return{request:function(e,t,r){r?c({url:s.sfUrl+"delayed/wsapi",contentType:"application/json",data:JSON.stringify(d(e,r)),method:"POST",withCredentials:!0}).success(function(e){e=m(e);t.call(t,e)}):epguHandleAtmosphere("long-polling",s.sfUrl+"a/wsapi",JSON.stringify(d(e,r)),"POST",function(e){e=m(e);t.call(t,e)},function(e){console.log(e)})},initInformers:function(){function e(){s.userId?t.checkRoleForShowInformers(function(){for(var e in s.informers)p(s.informers[e].code)},!0):n(e,50)}var t=this;e()},invalidateInformer:function(e,t){function r(){s.user.userId?o.checkRoleForShowInformers(function(){p(e,0,t)}):n(r,50)}var o=this;r()},invalidateInformers:function(){function e(){s.user.userId?t.checkRoleForShowInformers(function(){$.each(s.informers,function(e,t){p(e)})}):n(e,50)}var t=this;e()},saveInformer:function(r,o){$.ajax({url:s.lkApi2+"informers/"+r,contentType:"application/json",xhrFields:{withCredentials:!0},data:JSON.stringify(d(r,!1,!0)),type:"POST",dataType:"json",statusCode:{200:function(e){var t=s[r].response;t&&(t.state="E",s.informers[r].data=t,s.informers[r].state="E",f(t,r),o.call(o))}}})},activateInformer:function(t,r){s.informers[t]?$.ajax({url:s.lkApi2+"informers/"+t+"/activate",xhrFields:{withCredentials:!0},type:"POST",dataType:"json",success:function(e){e&&e.informerCode==t&&p(t,0,"?refresh=true"),r&&r.call(r,0)},fail:function(){r&&r.call(r,-1)}}):r&&r.call(r,-1)},deleteInformer:function(t,e,r){$.ajax({url:s.lkApi2+"informers/"+t+(e?"/deactivate":""),contentType:"application/json",xhrFields:{withCredentials:!0},type:e?"POST":"DELETE",dataType:"json",statusCode:{200:function(e){s.informers[t].state="D",s.informers[t].data={},r.call(r)}}})},checkRoleForShowInformers:function(t,e){var r="L"===s.userType||"B"===s.userType;function o(){var e;r&&(e=!!s.user.groups&&s.user.groups.find(function(e){return["ESIA","PGU"].includes(e.itSystem)&&"ORG_ADMIN"===e.grp_id}),!s.user.isOrgChief&&!e||s.user.branchOid)||t()}e&&r&&!Object.keys(s.user).length?a.afterLoad().then(function(){o()}):o()},paymentHistory:function(n){var e,i={BANK_PAY_CONFIRMED:{icon:"done",text:"Платеж проведен",tip:"confirmed"},BANK_PAY_CONFIRMATION:{icon:"done",text:"Платеж принят",tip:"confirmation"},SERVICE_PROVIDER_CONFIRMED:{icon:"done",text:"Платеж принят",tip:"confirmation"},NEW:{icon:"in_progress",text:"В обработке"},SERVICE_PROVIDER_CONFIRMATION:{icon:"in_progress",text:"В обработке"},BANK_PAY_ORDER_CONFIRMED:{icon:"in_progress",text:"В обработке"},BANK_PAY_ORDER_CONFIRMATION:{icon:"in_progress",text:"В обработке"},PAY_SERVICE_CONFIRMATION:{icon:"in_progress",text:"В обработке"},PAY_SERVICE_ABORTING:{icon:"in_progress",text:"Платеж отменяется"},PAY_SERVICE_ABORTED:{icon:"reject",text:"Платеж отменен",tip:"aborted"},PAYMENT_ABORTED:{icon:"reject",text:"Платеж отменен",tip:"aborted"},PAYMENT_DENIED:{icon:"reject",text:"Платеж отказан",tip:"aborted"},INCOMPLETE:{icon:"reject",text:"Незавершен"}},a=Object.keys(i),t={pageNumber:n.pageNumber||1,pageSize:n.pageSize||10,addAttrs:!0,onlyIsPaid:!0,_:Math.random()};n.code&&(t.informerCode=n.code.toString()),n.serviceCategoryCode&&(t.serviceCategoryCode=n.serviceCategoryCode.toString()),"ASC"==n.sortingDirection?t.orderBy="createTime":t.orderByDesc="createTime",n.beginOfRange&&"inf"!=n.beginOfRange&&n.endOfRange&&"inf"!=n.endOfRange&&(t.startDate=r(n.beginOfRange).format(),e=r(n.endOfRange),t.endDate=r().year(e.year()).month(e.month()).date(e.date()).format()),1===n.pageNumber&&l.measureStart("paymentsHistory"),c({url:s.lkApi+"paygate/beta/payment-history",method:"GET",withCredentials:!0,params:t}).then(function(e){var t,r,o;e&&e.data&&e.data.error&&0==e.data.error.errorCode?(t=[],e.data.payments&&e.data.payments.payments.forEach(function(e){-1<a.indexOf(e.status.code)&&(e.status.text=i[e.status.code].text,e.status.icon=i[e.status.code].icon,e.status.tip=i[e.status.code].tip),t.push(e)}),r={items:t,totalCount:e.data.total,totalSum:e.data.totalSum,pagesCount:e.data.numPages},1===n.pageNumber&&l.measureEnd("paymentsHistory",0,{utm_source:"paymentsHistory_ok"}),n.successCallback&&n.successCallback(r)):(1===n.pageNumber&&(r=e&&e.data&&e.data.error&&e.data.error.errorCode,o=e&&e.data&&e.data.error&&e.data.error.errorMessage,l.measureEnd("paymentsHistory",1,{BrowserError:r,ErrorMessage:o,utm_source:"paymentsHistory_no"})),console.log(e.data,"paygate/beta/payment-history"),n.errorCallback&&n.errorCallback(e))},function(e){1===n.pageNumber&&l.measureEnd("paymentsHistory",1,{BrowserError:e.status,ErrorMessage:e.statusText,utm_source:"paymentsHistory_no"}),console.log("error","paygate/beta/payment-history"),n.errorCallback&&n.errorCallback(e)})},getCafapList:function(){var e=s.nsiApi+"dictionary/CAFAP_LIST";return c({url:e,method:"POST",withCredentials:!0,data:{selectAttributes:["*"]}})},getCafapListItems:function(){return this.getCafapList().then(function(e){var t=[];return t=e&&e.data&&e.data.items?e.data.items:t})},getPhotos:function(e,t,r,o){var n=s.bigBroUrl+"/proxy/gibdd/photo";return c({url:n,method:"GET",params:{md5:e,uin:t,reg:r,div:o}})},getGibddPhotos:function(r){r.errorByImageLoad=!1;var o,e,t=r.signature||"",n=(i=r.deptCode,a=(i=i&&i.split("/"))&&i.length,e="",e=a?""===i[a-1]?i[a-2]:i[a-1]:e),i=r.fkNumber||r.bID,a=r.carNumber;return l.measureStart("gibdd_photo"),this.getPhotos(t,i,a,n).then(function(e){var t="data:image/jpeg;base64,";r.photos=[],o=e&&e.data&&e.data.code||"null",e&&e.data&&e.data.photos&&angular.forEach(e.data.photos,function(e){e=e.base64Value;e.length&&(-1===e.indexOf(t)&&(e=t+e),r.photos.push(e))}),0===r.photos.length&&(r.errorByImageLoad=!0)}).catch(function(e){r.errorByImageLoad=!0,o=e&&e.status}).finally(function(){s.disableMetric||metricReachGoal(r.errorByImageLoad?"gibdd_photo_error":"gibdd_photo_ok"),r.errorByImageLoad?l.measureEnd("gibdd_photo",1,{BrowserError:o,utm_source:"gibdd_photo_no",deptCode:n}):l.measureEnd("gibdd_photo",0,{BrowserError:"OK",utm_source:"gibdd_photo_ok",deptCode:n})})}}}]).factory("CheckFormLimitations",["$rootScope","$http",function(n,i){return{checkLimitations:function(e,t,r){var o={_:Math.random()};return r&&(o.orderId=r),i({url:n.lkApi+"orders/check/"+e+"/"+t,method:"POST",withCredentials:!0,cache:!1,params:o})}}}]).factory("transformRequestAsFormPost",function(){return function(e,t){t()["Content-Type"]="application/x-www-form-urlencoded; charset=utf-8";var r,o,n=e,i=[];if(!angular.isObject(n))return null==n?"":n.toString();for(r in n)n.hasOwnProperty(r)&&(o=n[r],i.push(encodeURIComponent(r)+"="+encodeURIComponent(null==o?"":o)));return i.join("&").replace(/%20/g,"+")}}).factory("MailService",["$http","$rootScope",function(o,n){function i(e){var t=e.text,r=e.subject,o=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>|<script[^>]*>|<\/script>/gi;e.text=t.replace(o,""),e.subject=r.replace(o,"")}var a,s={"Content-Type":"application/json; charset=utf-8"},l={label:"in",limit:10,withCounts:!0};return{getMailsList:function(e,t,r){a=$.isEmptyObject(e)?"":"?"+$.param($.extend({},l,e)),o({method:"GET",withCredentials:!0,url:n.gepsApiUrl+"messages/byCategory"+a,headers:s}).then(function(e){e&&(e.messageList.map(i),t(e))},function(e){r(e)})},getMailDetails:function(e,t,r){o({method:e,withCredentials:!0,url:t,headers:s}).success(function(e,t){e&&(e.messages.map(i),r(e)),t&&204===t&&r(t)})},deleteMails:function(e,r){o({method:"DELETE",withCredentials:!0,url:n.gepsApiUrl+"messages/thread",data:e,headers:s}).success(function(e,t){t&&204===t&&r(t)})},restoreMails:function(e,r){o({method:"POST",withCredentials:!0,url:n.gepsApiUrl+"messages/thread/restore",data:e,headers:s}).success(function(e,t){t&&204===t&&r(t)})},searchMails:function(e,t){o({method:"GET",withCredentials:!0,url:n.gepsApiUrl+"messages/byCategory?searchQuery="+encodeURI(e.toString()),headers:s}).success(function(e){e&&t(e)})},deleteAttachment:function(e,t){o({method:"DELETE",withCredentials:!0,url:n.gepsApiUrl+"file/"+e,headers:s}).success(function(e){e&&t(e)})},saveMail:function(e,t){o({method:"PUT",withCredentials:!0,url:n.gepsApiUrl+"messages/draft",data:e,headers:s}).success(function(e){t(e)})},sendMail:function(e,t){o({method:"POST",withCredentials:!0,url:n.gepsApiUrl+"messages/"+e+"/send",headers:s}).success(function(e){t(e)})},mailsTabs:[{title:"Входящие",name:"in"},{title:"Отправленные",name:"out"},{title:"Черновики",name:"draft"},{title:"Удаленные",name:"deleted"}],mailsList:{},mailsListInfo:{emptyList:!1,totalCount:0,perPageCount:0,lastMessageId:0,lastMessageUpdateTime:0,searchMailsQuery:void 0}}}]).factory("MailServiceOldVersion",["$http",function(n){var i={label:"list",start:1,orderField:"update_date",orderDirection:"des"};return{getMailsList:function(e,t,r,o){n({method:e,url:t+"?"+$.param($.extend({},i,r))}).success(function(e){e&&(angular.forEach(e.items,function(e){e.sendDate&&(e.sendTime=e.sendDate.split(" ")[1],e.sendDate=e.sendDate.split(" ")[0]),e.isChecked=!1}),o(e))})},getMails:function(e,t,r){n({method:e,url:t}).success(function(e,t){e&&(angular.forEach(e.messages,function(e){e.sendDate&&(e.sendTime=e.sendDate.split(" ")[1],e.sendDate=e.sendDate.split(" ")[0])}),r(e)),t&&204===t&&r(t)})},updateMails:function(e,t,r,o){n({method:e,url:t,data:r,headers:{"Content-Type":"application/json; charset=utf-8"}}).success(function(e,t){t&&204===t&&o(t)})},searchMails:function(e,t,r){n({method:e,url:t,headers:{"Content-Type":"application/json; charset=utf-8"}}).success(function(e,t){e&&r(t)})}}}]).factory("npsService",["$http","$rootScope","$routeParams",function(o,n,e){var i={"Content-Type":"application/json; charset=utf-8"};return{getDataNps:function(e,t,r){o({method:"GET",url:n.lkApi+"quiz/NPS/nps",headers:i,params:{serviceId:e,serviceType:"Service",excludeCanceled:!0},withCredentials:!0}).success(function(e){t(e)}).error(function(e,t){r&&r(t)})},setDataNps:function(e,r,t){o({method:"POST",url:n.lkApi+"quiz/NPS/submit",data:e,headers:i,withCredentials:!0}).success(function(e,t){r&&200===t&&r(t)}).error(function(){t&&r(t)})},checkDataNps:function(t){o({method:"GET",url:n.lkApi+"quiz/NPS/nps/pending",headers:i,withCredentials:!0}).then(function(e){e&&204!=e.status&&t(e.data)})}}}]).factory("CommonDialog",["ngDialog","$rootScope",function(l,c){function i(e,t,r,o,n,i){u=o?'<advice-bind-html type="type_{{ngDialogData.type}}" text="{{ngDialogData.text}}" title="{{ngDialogData.title}}"></advice-bind-html>':'<advice-simple class="'+(n||"")+'" type="type_{{ngDialogData.type}}" title="{{ngDialogData.title}}">{{ngDialogData.text}}</advice-simple>';var a={};if(i&&i.length){u+='<br/><div class="buttons-container">';for(var s=0;s<i.length;s++)!function(t){a["action_"+s]=function(e){(t.closeBefore||t.close)&&e(),t.action&&t.action(),t.closeAfter&&e()},u+='<a href="#" data-ng-href="#" data-ng-click="action_'+s+'(closeThisDialog)" class="button-medium '+(t.primary?"btn-base ":"btn-sec ")+(c.isMobile()?"button-long":"")+'" data-ng-class="['+t.class+']">'+t.text+"</a>"}(i[s]);u+="</div>"}l.open({template:u,data:{type:e,title:t,text:r,isHtmlBind:o},plain:!0,controller:["$scope",function(e){for(var t in a)e[t]=a[t]}],className:"commmon-dialog"})}var u;return{error:function(e,t,r){i("not",e,t,r)},ok:function(e,t,r){i("ok",e,t,!1,r)},warn:function(e,t,r,o,n){i("warn",e,t,r,null,n||[{text:"Продолжить",primary:!0,close:!0,action:o},{text:"Отменить",close:!0}])}}}]).factory("ServiceTimeout",["$timeout","$rootScope","$templateCache","ngDialog",function(o,n,e,r){var i;return e.put("service-timeout.html","<advice-simple type=\"{{ngDialogData.async ? 'type_ok' : 'type_not'}}\" title=\"{{ngDialogData.async ? 'Что-то пошло не так' : 'Что-то пошло не так'}}\">{{ngDialogData.customText || \"Попробуйте получить информацию позже. \"}}</advice-simple>"),{initTimeout:function(e){var t,r;n.serviceTimeoutEnabaled&&(2==arguments.length&&"function"==typeof e&&"function"==typeof arguments[1]?(t=e,r=arguments[1]):e.throbberSubHeader=n.throbber.subHeader,i=o(function(){t?t.call(t):e.throbberSubHeader="Ожидаем ответ от сервера ведомства.",i=o(function(){r?r.call(r):(e.loading=!1,e.timeoutError=!0)},2e4)},4e4))},clearTimeout:function(){o.cancel(i)},showDialog:function(e,t){r.open({template:"service-timeout.html",data:{customText:e,async:t}})}}}]).factory("CoordsService",["$http","$rootScope",function(r,o){return{get:function(e,t){t=t?e:e.map(function(e){return/россия/i.test(e)?e:"Россия, "+e});return r({url:o.nsiApi+"address/resolve",data:{address:t},withCredentials:!0,method:"POST"})}}}]).factory("CoordsToAddress",["$http","$rootScope",function(t,r){return function(e){return t({url:r.nsiApi+"address/resolve",withCredentials:!0,contentType:"application/json",data:{address:e},method:"POST"})}}]).factory("CheckInnService",[function(){return{checkInn:function(e){return!!e&&!(12!=(e=e.toString().split("")).length||e[10]!=(7*e[0]+2*e[1]+4*e[2]+10*e[3]+3*e[4]+5*e[5]+9*e[6]+4*e[7]+6*e[8]+8*e[9])%11%10||e[11]!=(3*e[0]+7*e[1]+2*e[2]+4*e[3]+10*e[4]+3*e[5]+5*e[6]+9*e[7]+4*e[8]+6*e[9]+8*e[10])%11%10)}}}]).factory("InformersService",["$rootScope",function(r){function o(e){return(Array.isArray(e)?e:Object.keys(e)).length}return{setInformerCls:function(e,t){if(t)switch(t.state){case"U":e+=" informer-update with-fines";break;case"E":t.data.withDiscounts&&(e+=" informer-with-discount"),0<o(t.data.items)&&0!=t.data.total&&"duty"!==t.code?e+=" with-fines":"duty"===t.code?e+=" informer-duty__item--enabled":e+=" without-fines";break;case"D":case"H":e+=" with-fines informer-disabled";break;case"F":e+=" with-fines informer-load-error"}return e},getInformerItemsLen:o,setInformerResultPath:function(e,t){return"gibdd"===e?"H"===t||"D"===t||"F"===t?"10001/form":"10001/result/informer":"fns"===e?"AL10"===r.assuranceLevel?"10002/1":"D"===t||"F"===t||"H"===t?"10002/form":"10002/result/informer":"H"===t||"D"===t||"F"===t?"10003/form":"10003/result/informer"},getMessagesWithDuty:{gibdd:{object:r.informers.gibdd,title:"Автоштрафы",disabledMessage:"Проверить",successMessage:"Не найдено",errorMessage:"Ошибка получения данных",updateMessage:"",discountMessage:null},fns:{object:r.informers.fns,title:"Налоговая задолженность",disabledMessage:"Проверить",successMessage:"Не найдено",errorMessage:"Ошибка получения данных",updateMessage:"",discountMessage:null},fssp:{object:r.informers.fssp,title:"Судебная задолженность",disabledMessage:"Проверить",successMessage:"Не найдено",errorMessage:"Ошибка получения данных",updateMessage:"",discountMessage:null},receipt:{object:{state:"H",code:"receipt",receiptLink:"/pay",data:{items:[]}},title:"Оплата по квитанции"}},getMessagesOfAllInformers:{gibdd:{object:r.informers.gibdd,title:"Автоштрафы",successMessage:"Не найдено",errorMessage:"Ошибка получения данных",updateMessage:"",discountMessage:null,defaultMessage:"Нарушения ПДД и парковки. Онлайн-оплата со скидкой 50% в первые 20 дней",defaultLink:"/pay?tab=toPay&categories=fine"},fns:{object:r.informers.fns,title:"Налоговая задолженность",successMessage:"Не найдено",errorMessage:"Ошибка получения данных",updateMessage:"",discountMessage:null,defaultMessage:"Достаточно вашего ИНН, чтобы проверить задолженность по налогам",defaultLink:"/pay?tab=toPay&categories=fns"},fssp:{object:r.informers.fssp,title:"Судебная задолженность",successMessage:"Не найдено",errorMessage:"Ошибка получения данных",updateMessage:"",discountMessage:null,defaultMessage:"Для проверки нужны только ваши имя, фамилия и дата рождения",defaultLink:"/pay?tab=toPay&categories=fssp"},zkh:{object:{state:"D",code:"zkh",data:{items:[]}},title:"Коммунальные услуги",defaultMessage:"Выберите поставщика услуг и оплатите коммунальные услуги",defaultLink:"/10373/1"},duty:{object:{state:"U",code:"duty",data:{items:[]}},title:"Оплата госпошлин",defaultMessage:"Скидка 30% на оплату пошлин при оформлении услуг через портал",defaultLink:"/pay#landing_duty"},receipt:{object:{state:"D",code:"receipt",data:{items:[]}},title:"Оплата по квитанции",defaultMessage:"Введите номер и проверьте наличие начислений",defaultLink:"/pay#landing-uin"}},getMessages:{gibdd:{object:r.informers.gibdd,title:"Штрафы ГИБДД",disabledMessage:"Получить услугу",successMessage:"Не найдено",errorMessage:"Ошибка получения данных",updateMessage:"Данные обновляются...",discountMessage:"Оплатите со скидкой!"},fns:{object:r.informers.fns,title:"Налоговая задолженность",disabledMessage:"Получить услугу",successMessage:"Не найдено",errorMessage:"Ошибка получения данных",updateMessage:"Данные обновляются...",discountMessage:null},fssp:{object:r.informers.fssp,title:"Судебная задолженность",disabledMessage:"Получить услугу",successMessage:"Не найдено",errorMessage:"Ошибка получения данных",updateMessage:"Данные обновляются...",discountMessage:null}}}}]).factory("ThrobberService",[function(){var r=[];return{setThrobber:function(e){return r.push(e),r.length<=1},toggleThrobber:function(e,t){return r.splice(r.indexOf(e),1),t(!!r.length),!1}}}]).factory("DetectErrorLink",["$rootScope",function(e){var o;return{init:function(){return e.$on("detectedErrorUrl",function(e,t){o=t}),e.$on("$locationChangeStart",function(e,t,r){o=r&&r==o?r:""}),o},get:function(){return o}}}]).factory("redirectAppService",["$rootScope",function(t){var o={agent:window.navigator.userAgent,getPath:function(){var e="/";switch(this.checkIos()||this.checkAndroid()||this.checkWinPhone()||this.checkWinRT()||this.checkDk()){case"ios":e=t.appStores.ios;break;case"android":e=t.appStores.android;break;case"winMob":case"winRT":e=t.appStores.winMob;break;case"dk":e=t.baseUrl+"/help/mobile";break;default:e=t.baseUrl+"/help/mobile?agent=unrecognized"}return e},checkIos:function(){function e(){var e=o.agent,t=e.indexOf("OS ");return e.match(/iPhone|iPad|iPod/i)&&-1<t?window.Number(e.substr(t+3,3).replace("_",".")):0}return!!e()&&(7<e()?"ios":"unknown")},checkAndroid:function(){function e(){var e=o.agent.toLowerCase(),t=e.match(/android\s([0-9\.]*)/);return-1==e.indexOf("windows phone")&&(t?t[1]:0)}var t;return!!e()&&(2==(t=e().split(".")).length&&t.push(0),403<t.join(""))&&"android"},checkWinPhone:function(){var e=o.agent.toLowerCase(),t=e.indexOf("windows phone");return-1!=t&&(8.1<=e.substr(t+14,3)?"winMob":"unknown")},checkWinRT:function(){var e=o.agent,t=e.toLowerCase().indexOf("windows nt"),r=-1!=e.toLowerCase().indexOf("touch");if(-1!=t&&-1!=r&&6.4<=e.substr(t+11,3))return"winRT";return!1},checkDk:function(){if(!SmartPhone.isPhone()&&!this.checkWinRT())return"dk"}};return{getRedirectPath:o.getPath.bind(o)}}]).factory("userTypeService",["$rootScope","$timeout","$location",function(r,e,o){var n={type:"",rootPath:"",list:[{catalogType:"EMPLOYEE",departmentsType:"EMPLOYEE",departmentItem:"LEGAL",cmsType:"LEGAL",occasionType:"LEGAL",faqType:"LEGAL",newsType:"LEGAL",rootPath:"/legal-entity",searchSputnikParam:"LEGAL",individual:!1,name:"Для юридических лиц",userTypeGosBar:"L"},{catalogType:"BUSINESSMAN",departmentsType:"BUSINESSMAN",departmentItem:"SOLE_PROPRIETOR",cmsType:"SOLE_PROPRIETOR",occasionType:"BUSINESSMAN",faqType:"SOLE_PROPRIETOR",newsType:"SOLE_PROPRIETOR",rootPath:"/entrepreneur",searchSputnikParam:"SOLE_PROPRIETOR",individual:!1,name:"Для предпринимателей",userTypeGosBar:"B"},{catalogType:"",departmentsType:"FOREIGNER",departmentItem:"FOREIGNER",cmsType:"",occasionType:"",newsType:"FOREIGN",rootPath:"/foreign-citizen",searchSputnikParam:"FOREIGNER",faqType:"FOREIGN",individual:!1,name:"Для иностранных граждан",userTypeGosBar:"F"},{catalogType:"PARTNERS",departmentsType:"PARTNERS",departmentItem:"PARTNERS",cmsType:"PARTNERS",occasionType:"PARTNERS",rootPath:"/",searchSputnikParam:"PARTNERS",faqType:"PARTNERS",individual:!1,name:"Для партнеров",userTypeGosBar:"PA"},{catalogType:"",departmentsType:"",departmentItem:"PERSON",cmsType:"PERSON",occasionType:"PERSON",faqType:"PERSON",newsType:"PERSON",rootPath:"/",searchSputnikParam:"all",individual:!0,name:"Для граждан",userTypeGosBar:"P"}]},i=!1;return{getUserType:function(){function t(r){n.list.forEach(function(e){if(e.userTypeGosBar==r)for(var t in e)n[t]=e[t]})}function e(e){switch(e){case"L":t("L");break;case"B":t("B");break;case"F":t("F");break;case"PA":t("PA");break;default:t("P")}return n}return n=r.userTypeGosBar?e(r.userTypeGosBar):e(r.userType),r.changeHeaderFilter=!1,i||(r.filterGosBarValue=!1),n},saveHeaderFilter:function(e){i=e},getHeaderFilter:function(){return i},setUserTypeManualy:function(t){var r={};n.list.forEach(function(e){e.faqType==t&&(r=e)}),this.saveHeaderFilter(r)},setUserType:function(e){r.filterGosBarValue=e,r.changeHeaderFilter=e.userTypeGosBar},clearHeaderFilter:function(){var t=o.path();["search","structure","catalog","category","situation","help/faq"].every(function(e){return-1==t.indexOf(e)})&&(i=!1,r.filterGosBarValue=!1)},onGosBarChange:function(){r.changeHeaderFilter=!1,r.filterGosBarValue=!1,i=!1},redirectToMain:function(){var e;"F"!==this.getUserType().userTypeGosBar||o.path().match(/structure\/\d+/)||(e=-1!==o.path().indexOf("/category")?"landing-popular-services":"",o.path("/foreign-citizen").hash(e),r.loading=!1)},getCurrentUserType:function(){return this.getHeaderFilter().userTypeGosBar||this.getUserType().userTypeGosBar},hideForUserType:function(){var e=!1;switch(this.getCurrentUserType()){case"P":e=r.personOccasionDisabled;break;case"L":case"PA":e=r.legalOccasionDisabled;break;case"B":e=r.businessmanOccasionDisabled;break;default:e=!1}return e},redirectToFaq:function(){this.getUserType(),r.loading=!1}}}]).factory("makeAddressService",[function(){return{getAddress:function(e){var t=e.postIndex||"";return t=(t=(t=(t=(t=(t=(t+=e.region?t?", "+e.region:e.region:"")+(e.area?t?", "+e.area:e.area:""))+(e.town?t?", "+e.town:e.town:""))+(e.city?t?", "+e.city:e.city:""))+(e.street?t?", "+e.street:e.street:""))+(e.house?t?", "+e.house:e.house:""))+(e.building?t?", "+e.building:e.building:"")}}}]).factory("scrollToQuqeryId",["$timeout","$rootScope","$location",function(t,r,o){return{init:function(e){var n=o.search().q,i="dk"==r.version?50:40;(n=n||o.hash())&&t(function(){var r,e=angular.element("#"+n)[0],t=document.getElementsByClassName("top-wrapper"),o=window.scrollY||0;e&&(r=e.getBoundingClientRect().top+o-20,t[0]&&0==t[0].getBoundingClientRect().top&&(r+=i),angular.element("[data-sticky]").each(function(e,t){r-=angular.element(t).height()}),window.scrollTo(0,r))},1e3)}}}]).factory("eventService",function(){var e=!1;return{setEvent:function(){e=!0},getEvent:function(){return e},removeEvent:function(){e=!1}}}).factory("encodeURIService",[function(){return{createUrl:function(e,o){var t=Object.keys(o);return t.forEach(function(e,t,r){r[t]=e+"="+encodeURIComponent(o[e])}),e+"?"+t.join("&")}}}]).factory("fsspGibddBoundService",["$rootScope","encodeURIService",function(a,s){function r(e,t){var r=e.fkNumber2||e.fkNumber||e.docNum;r&&t.idNum==r?(t.gibddLinked=!0,o(e,t),t.dibddItem=e):t.gibddLinked||o(e,t)}var o=function(e,t){var r=t.linkedPaidId_amount||"",o=t.linkedPaidId_date||"",n=t.linkedPaidId_id||"",i="AL20"!=a.user.assuranceLevel?a.gibddKfTarget:a.gibddKfTarget+"form",r={deloNum:t.number,idNum:t.idNum,idDate:t.idDate,amount:r,paidDate:o,paidId:n,draftMode:1},o={deloNum:t.number,amount:t.paidId_amount,paidDate:t.paidId_date,paidId:t.paidId_id,draftMode:1};n&&1!=t.isPaid&&a.gibddKfTargetPath?(t.noIpPaidGibddPaid=!0,"AL20"==a.user.assuranceLevel?t.linkKfHref=s.createUrl(i,r):t.linkKfHref=i,t.dibddItem=e):1==t.isPaid?(t.noIpPaidNoUpdate=!0,t.dibddItem=e):t.paidId_id&&1!=t.isPaid&&a.gibddKfTargetPath?("AL20"==a.user.assuranceLevel?t.linkKfPartHref=s.createUrl(i,o):t.linkKfPartHref=i,t.withIpPaidWithUpdate=!0,t.dibddItem=e):1==t.uinFail&&1!=t.isPaid&&(t.noIpNoUin=!0,t.dibddItem=e)};return{checkFsspGibddBound:function(e){return angular.forEach(e.items,function(t){3==t.idType&&(a.informers.gibdd.data.items.fullMode&&angular.forEach(a.informers.gibdd.data.items.fullMode,function(e){r(e,t)}),a.informers.gibdd.data.items.simpleMode&&angular.forEach(a.informers.gibdd.data.items.simpleMode,function(e){angular.forEach(e.items,function(e){r(e,t)})}),a.informers.gibdd.data.items.simpleMode||a.informers.gibdd.data.items.fullMode||angular.forEach(a.informers.gibdd.data.items,function(e){r(e,t)}))}),e}}}]).factory("gibddFsspBoundService",["$rootScope","encodeURIService",function(l,c){function i(e,t){var r="AL20"!=l.user.assuranceLevel?l.gibddKfTarget:l.gibddKfTarget+"form",o=l.betaUrl,n=e.paidId_amount||"",i=e.paidId_date||"",a=e.paidId_id||"",s="dk"==l.version?"":"q-avtovladelcam",n={deloNum:t.number,idNum:t.idNum,idDate:t.idDate,amount:n,paidDate:i,paidId:a};return 1==e.isPaid||a||1==t.isPaid?1==e.isPaid&&a&&1!=t.isPaid&&l.gibddKfTargetPath?(i="AL20"==l.user.assuranceLevel?c.createUrl(r,n):r,e.fsspBoundPayedNoIpText="По штрафу возбуждено исполнительное производство "+t.number+" от "+t.idDate+". Вы можете <a href='"+i+"'>подать заявление</a> о прекращении исполнительного производства.",e.linkedFssp=!0):1!=e.isPaid&&!a&&t.paidId_id&&1==t.isPaid&&(e.fsspBoundPayedWithIpText="Платеж по исполнительному производству "+t.number+" проведен и обрабатывается в ФССП России. <a data-ng-click='eventObj.setOpenListEvent("+s+")' href>Почему штраф не считается погашенным</a>.",e.linkedFssp=!0):(t.paidId_id?e.fsspBoundPayedWithIpRefreshText="Платеж по исполнительному производству "+t.number+" принят ФССП России. <a data-ng-click='eventObj.setOpenListEvent("+s+")' href>Почему штраф не считается погашенным</a>.":e.fsspBoundNoPayedNoIpText="По штрафу возбуждено исполнительное производство "+t.number+" от "+t.idDate+". Вы можете просмотреть <a href='"+o+"10003/result?q=q-"+t.unifoChargeFssp+"'>судебную задолженность</a>.",e.linkedFssp=!0),e}return{checkGibddFsspBound:function(e){var t=e.fullMode,r=e.simpleMode,o=l.informers.fssp.data.items,n=[];return angular.forEach(o,function(o){-1==n.indexOf(o.idNum)&&3==o.idType&&(angular.forEach(t,function(e){var t=e.fkNumber2||e.fkNumber||e.docNum;o.idNum&&o.idNum==t&&(n.push(o.idNum),i(e,o))}),angular.forEach(r,function(r){angular.forEach(r.items,function(e){var t=e.fkNumber2||e.fkNumber||r.docNum;o.idNum&&o.idNum==t&&(n.push(o.idNum),i(e,o))})}))}),e}}}]).factory("violationSourceWhiteList",["$rootScope","$http",function(e,t){return{getWhiteList:function(){return t({url:e.nsiApi+"dictionary/VIOLATION_SOURCE_WHITE_LIST",method:"POST",withCredentials:!0,data:{treeFiltering:"ONELEVEL",pageNum:1,selectAttributes:["*"],tx:""}})}}}]).factory("FinesText",function(){var o={"платеж":["платеж","платежей","платежа"],"задолженность":["задолженность","задолженностей","задолженности"],"штраф":["штраф","штрафов","штрафа"],"счет":["счёт","счетов","счёта"],"госпошлина":["госпошлина","госпошлин","госпошлины"],"начисление":["начисление","начислений","начисления"],"выбран":["Выбран","Выбрано","Выбрано"],"выбрана":["Выбрана","Выбрано","Выбрано"],"выбрано":["Выбрано","Выбрано","Выбрано"],"судебная":["судебная","судебных","судебных"],"налоговая":["налоговая","налоговых","налоговых"],"судебная задолженность":["судебная задолженность","судебных задолженностей","судебных задолженности"],"налоговая задолженность":["налоговая задолженность","налоговых задолженностей","налоговых задолженности"],"день":["день","дней","дня"],"остался":["Остался","Осталось","Осталось"],"транспортное средство":["транспортное средство","транспортных средств","транспортных средства"],"случай":["случай","случаев","случая"],"смерть":["смерть","смертей","смерти"]},r={"Выставлен":{stateDuty:"Выставлена",fns:"Выставлена",account:"Выставлен"}};return{getWord:function(e,t){var r;return t?o[t]?(r=e%10,11<=(e=e%100)&&e<=14?o[t][1]:1<r&&r<5?o[t][2]:5<=r&&r<=9||0==r?o[t][1]:o[t][0]):t:""},getWordByGender:function(e,t){return r[t][e]}}}).factory("eventService",function(){var e=!1;return{setEvent:function(){e=!0},getEvent:function(){return e},removeEvent:function(){e=!1}}}).factory("IconService",["$rootScope",function(r){return{setIcon:function(e){var t=null;return e.icons&&e.icons.length&&"small"===e.icons[0].iconType&&e.icons[0].path?t=e.icons[0].path:e.ico&&(t=r.imgPath+"structure-logo/"+e.ico),t}}}]).factory("EsiaMapCoords",["$rootScope","$http",function(t,r){return{getCoords:function(e){return r({url:t.nsiApi+"esia/ra/services",method:"POST",withCredentials:!0,data:{bounds:e.bounds,usercoords:e.usercoords,oids:e.oids}})}}}]).factory("esiaTransportService",["$rootScope","$http","$q",function(e,r,o){function n(){return{Authorization:"Bearer "+s()}}function t(){return e.orgType}function i(){return e.siaWebHost+"/esia-rs/api/public/v1/"+(t()?"orgs/":"prns/")}function a(){return t()?e.user.orgOid:e.user.userId}function s(){try{return document.cookie.split(";").find(function(e){return e.trim().startsWith("acc_t=")}).split("=")[1]}catch(e){return console.error("Access token not found"),""}}function l(e){return e.number=e.numberPlate,e.sts=""+e.regCertificate.series+e.regCertificate.number,e.stsSeries=e.regCertificate.series,e.stsNumber=e.regCertificate.number,e}return{getToken:s,getTransports:function(e){return r({url:i()+a()+"/vhls",headers:n(),method:"GET",params:$.extend({embed:"(elements)"},e)}).then(function(e){return{data:e.data.elements.map(l)||[],size:e.data.totalSize||e.data.size,pageIndex:e.data.pageIndex}})},getImportUrl:function(){return i()+a()+"/vhls/batch"},submitImportReport:function(e){return e=e.map(function(e){return{nameVhls:e.auto_name.value||"",numberVhls:e.gos_number.value,numcertVhls:e.sts.value}}),r({url:i()+a()+"/vhls/batchjs",method:"POST",headers:n(),data:{elements:e}}).then(function(e){return e.data})},transformTransportData:l,searchTransports:function(e,t){return r({url:i()+a()+"/vhls/search",headers:n(),method:"GET",params:$.extend({name:e,num:e,ctc:e},t)}).then(function(e){return{data:e.data.elements.map(l)||[],pageIndex:e.data.pageIndex,size:e.data.totalSize}},function(e){return o.reject(e)})},deleteAllTransports:function(){return r({url:i()+a()+"/vhls",headers:n(),method:"DELETE"})}}}]).factory("transportService",["$rootScope","$http","ngDialog",function(e,t,r){}]).factory("FrguModalData",["$http",function(t){return{getData:function(e){return t({url:e,method:"GET"})}}}]).factory("animatedAnchorScroll",["$timeout","$document",function(e,r){return{scrollToElement:function(t){e(function(){var e=angular.element("[scroll-anchor]");0<e.length&&r.scrollToElementAnimated(e,t||0,400)},0)}}}]).factory("dashboardVocabulary",["$http","$rootScope",function(e,t){return{get:function(){return e({url:t.staticDomainUrl+"htdocs/js/data/dashboards-vocabulary.json",method:"GET"})}}}]).factory("constitutionAmendment",["$http","$rootScope",function(e,t){return{get:function(){return e({url:t.staticDomainUrl+"htdocs/js/data/amendment.json",method:"GET",params:{_:t.cacheRequestStamp}})}}}]).factory("animatedClickScroll",["$timeout","$document","$rootScope",function(e,l,c){return{scrollToElement:function(a,s){e(function(){var e=0,t=angular.element("#"+a+s)[0],r=window.getComputedStyle(t,null).getPropertyValue("padding-top"),o=document.getElementsByClassName("top-wrapper"),n=o[0].getBoundingClientRect().top,i="pad"===c.version?20:"mob"===c.version?10:40;t&&(o[0]&&0<n&&"0px"==r?e=50+i:o[0]&&0==n&&"0px"==r?e+=50:o[0]&&0<n&&"0px"!=r?e=i:o[0]&&0==n&&"0px"!=r&&(e=50<=parseInt(r)?0:50),l.scrollToElementAnimated(t,e,400))},0)}}}]).factory("scrollToCode",["$timeout","$rootScope","$location","$anchorScroll",function(e,t,r,o){return{init:function(n,i){var a="dk"==t.version?50:40;e(function(){var r,e=angular.element("#"+n+i)[0],t=document.getElementsByClassName("top-wrapper"),o=window.scrollY||0;e&&(r=e.getBoundingClientRect().top+o-20,t[0]&&0==t[0].getBoundingClientRect().top&&(r+=a),angular.element("[data-sticky]").each(function(e,t){r-=angular.element(t).height()}),window.scrollTo(0,r))})}}}]).factory("HealthInformers",["$rootScope","PerformanceService","CatalogService","$moment",function(e,o,n,t){var r=[{iconUrl:"https://gu-st.ru/content/catalog/pas/health_doctor.svg",title:"Запись к врачу",emptyDataText:"Запишитесь на приём к врачу заранее, не тратьте время в очереди",emptyDataTextDashboard:"<a href='"+e.betaUrl+"10066/1/form'>Запишитесь</a> на приём к врачу заранее, не тратьте время в очереди",link:"/10066/1/",passportId:"10066",formLink:"/10066/1/form",errorText:"Извините, временно нет доступа к информации о записях к врачу. Попробуйте обновить страницу через некоторое время.",service:"callDoctor",buttonText:"Записаться к врачу",linkText:"Все записи к врачу",lkLinkHistory:e.lkUrl+"notifications?t=all&q=Минздрав России&type=EQUEUE",epguUrlTitle:"Записаться к врачу",refresh:function(e){e.preventDefault(),this.callDoctor()},callDoctor:function(){i.call(this,this.service)}},{iconUrl:"https://gu-st.ru/content/catalog/pas/health_home.svg",title:"Вызов врача на дом",emptyDataText:"Вы можете вызвать врача на дом для себя или для кого-то из близких",emptyDataTextDashboard:"Вы можете <a href='"+e.betaUrl+"10067/1/form'>вызвать врача</a> на дом для себя или для кого-то из близких",link:"/10067/1/",passportId:"10067",formLink:"/10067/1/form",errorText:"Извините, временно нет доступа к информации о вызовах врача. Попробуйте обновить страницу через некоторое время.",service:"makeDoctor",buttonText:"Вызвать врача",linkText:"История вызовов врача",lkLinkHistory:e.lkUrl+"notifications?t=all&q=Вызов врача на дом&type=EQUEUE",epguUrlTitle:"",refresh:function(e){e.preventDefault(),this.makeDoctor()},makeDoctor:function(){i.call(this,this.service)}}];function i(t){"callDoctor"==t?o.measureStart("callDoctorInformer"):o.measureStart("makeDoctorInformer");var r=this;r.isLoad=!1,n[t]().then(function(e){e&&200==e.status&&("callDoctor"==t?o.measureEnd("callDoctorInformer"):o.measureEnd("makeDoctorInformer")),e&&e.data&&200==e.status?(r.data=e.data,r.data.data&&r.data.data.length&&r.data.data.sort(function(e,t){return e.date<t.date?-1:1})):(a(e),"callDoctor"==t?o.measureEnd("callDoctorInformer",1,{BrowserError:e.status}):o.measureEnd("makeDoctorInformer",1,{BrowserError:e.status})),r.isLoad=!0},function(e){"callDoctor"==t?o.measureEnd("callDoctorInformer",1,{ServiceError:e.status}):o.measureEnd("makeDoctorInformer",1,{ServiceError:e.status}),a(e),r.isLoad=!0})}function a(e){console.log(e)}return{getInformersData:i,getInformersConfig:function(){return r}}}]).factory("ChangeTab",["$location",function(r){return{changeTab:function(e,t){switch(t){case"gibdd-result":e.active="gibdd-result";break;case"gibdd-search":e.active="gibdd-search";break;case"fns-result":e.active="fns-result";break;case"fns-search":e.active="fns-search";break;case"fssp-result":e.active="fssp-result";break;case"fssp-search":e.active="fssp-search";break;case"uin":e.active="uin"}r.search().tab&&"uin"===r.search().tab&&"uin"!==e.active&&r.url(r.path())}}}]).factory("animatedIdScroll",["$timeout","$document","$rootScope",function(e,a,s){return{scrollToElement:function(n,i){e(function(){var e=0,t=angular.element("#"+n+i)[0],r=document.getElementsByClassName("top-wrapper")[0].clientHeight,o=document.getElementsByTagName("iframe");if(t){switch(s.version){case"dk":e=85==r?50:10;break;case"pad":e=60==r?15:0;break;default:e=0}o&&o.length&&(e+=50),a.scrollToElementAnimated(t,e,400)}},0)}}}]).factory("quizService",["$http","$rootScope","$routeParams",function(n,i,e){var a={"Content-Type":"application/json; charset=utf-8"};return{getDataQuiz:function(e,r,o){var t=i.lkApi+"quiz/mkgu/";e&&e.targetId&&e.passportId?t+="online/"+e.passportId+"/"+e.targetId:t+="order/"+e.orderId,n({method:"GET",url:t,headers:a,withCredentials:!0,params:{_:Math.random()}}).success(function(e,t){r(t&&"204"==t?e="204":e)}).error(function(e,t){o&&o(t,e)})},setDataQuiz:function(e,t,r,o){n({method:"POST",url:i.lkApi+("quiz/"+e+"/submit"),withCredentials:!0,data:t}).then(function(e){r(e)},function(e){o&&o(e.status)})},checkQuiz:function(e,t,r){var o=i.lkApi+"quiz/mkgu/";e&&e.targetId&&e.passportId?o+="online/"+e.passportId+"/"+e.targetId+"/check/":o+="order/"+e.orderId+"/check/",n({method:"GET",url:o,headers:a,withCredentials:!0,params:{_:Math.random()}}).success(function(e){t(e)}).error(function(e,t){r&&r(t)})}}}]).factory("requestsService",["$http","$rootScope","$routeParams",function(t,n,e){var i={"Content-Type":"application/json; charset=utf-8"};return{getPermissions:function(e,r,o){e=n.lkApi+"coronavirus/permissions/"+e.region+"?pageSize="+e.pageSize+"&lastOrderId="+e.lastOrderId+"&q="+e.q,t({method:"GET",url:e,headers:i,withCredentials:!0}).success(function(e,t){r(t&&"204"==t?e="204":e)}).error(function(e,t){o&&o(t,e)})},setPermissionsAction:function(e,r,o){e=n.lkApi+"coronavirus/permissions/"+e.action+"/"+e.orderId,t({method:"POST",url:e,headers:i,withCredentials:!0}).success(function(e,t){r(t&&"204"==t?e="204":e)}).error(function(e,t){o&&o(t,e)})}}}]).factory("UploadFormFileData",["$http","$rootScope",function(o,n){return{upload:function(e,t,r){return o({method:"POST",withCredentials:!0,url:n.lkApi+e,data:t})}}}]).factory("PartnersService",["$rootScope","$http",function(r,o){return{getPartnersDocuments:function(){return o({method:"GET",url:r.cmsUrl+"partners/maindocs",cache:!1,withCredentials:!0,params:{_:Math.random()}})},getPartnersLinks:function(){return o({method:"GET",url:r.cmsUrl+"partners/links",cache:!1,withCredentials:!0,params:{_:Math.random()}})},getPartnersCategories:function(){return o({method:"GET",url:r.cmsUrl+"partners/products",cache:!1,withCredentials:!0,params:{_:Math.random()}})},getPartnersAllDocs:function(){return o({method:"GET",url:r.cmsUrl+"partners/docs",cache:!1,withCredentials:!0,params:{_:Math.random()}})},setPartnersForm:function(e,t){return o({method:"POST",url:r.partnersApiUrl+"mail/"+t,data:e})}}}]).factory("ResetMessages",["$rootScope","$http",function(t,r){return{send:function(e){return r({data:"",method:"POST",withCredentials:!0,url:t.lkApi+"feeds/markAsRead"+(e?"?types="+e:"")})},updateCounter:function(e){return r({data:"",method:"GET",withCredentials:!0,url:t.lkApi+"feeds/markAsRead/"+e})}}}]).factory("PopularSpriteIconList",[function(){return{list:["10001","10002","10003","10066","10042","10051","10052","555666","10059","168061","10056","168086","10050","16587","271565"]}}]).factory("CacheRequestService",["$rootScope",function(i){return{clearStorageItem:function(e){localStorage.removeItem(e)},getCacheStamp:function(){function e(){return localStorage.setItem("cacheTimeRequest",+r+o),t=+localStorage.getItem("cacheTimeRequest")}var t,r=new Date,o=60*i.cacheTimeRequest*1e3,n=localStorage.getItem("cacheTimeRequest");if(!o||i.disableMetric)return+r;if(n)return t=+n-r<=0?e():+n;try{return t=e()}catch(e){return t="QUOTA_EXCEEDED_ERR"==e?+r:t}}}}]).factory("CookieService",[function(e){return{readCookie:function(e){for(var t=e+"=",r=document.cookie.split(";"),o=0;o<r.length;o++){for(var n=r[o];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return null}}}]).factory("FeedbackGibddValidation",["checkEpguPayment","FeedbackHint","violationSourceWhiteList",function(o,e,r){var n,i,t,a,s,l,c;function u(e){a=!1,e.readOnly=!1,e.isLoading=!1,d(!(l=!0)),console.log("error","epgu check payment data")}function d(o){var e="Частые проблемы по штрафам, оплаченным через Госуслуги, описаны в разделе <a href='https://www.gosuslugi.ru/help/faq/voprosy_po_oplate/2388'>«Вопросы и ответы»</a>. Если вы не нашли ответа там, подробно опишите ситуацию и направьте сообщение в службу поддержки.",n="Частые проблемы по проверке штрафов через портал Госуслуг описаны в разделе <a href='https://www.gosuslugi.ru/help/faq/voprosy_po_oplate/27'>«Вопросы и ответы»</a>. Если вы не нашли ответа там, подробно опишите ситуацию и направьте сообщение в службу поддержки.",t="Если вы не согласны с выставлением вам штрафа и хотите его обжаловать, рекомендуем лично или заказным письмом обратиться в подразделение Госавтоинспекции, указанное в постановлении-квитанции.<br>Частые проблемы по проверке штрафов через портал Госуслуг описаны в разделе <a href='https://www.gosuslugi.ru/help/faq/voprosy_po_oplate/2387'>«Вопросы и ответы»</a>. Если вы не нашли ответа там, подробно опишите ситуацию и направьте сообщение в службу поддержки.",i=o?o.number.length:0;o?o.paid?(c=o.transaction?e:n,l=!1):o.number.match(/^(188).*?/)||o.number.match(/[а-яА-ЯЁё]/)?(c=t,20==i&&metricReachGoal("claim_GIBDD"),l=!1):r.getWhiteList().then(function(e){e&&e.data&&e.data.items?(c=n,e.data.items.some(function(e){var t=e.attributeValues&&e.attributeValues.UIN_PRIFIX,r=new RegExp("^("+t+").*?");if(t&&o.number.match(r)){switch(c=e.attributeValues.FOS_TEXT||n,t){case"782":case"0356":20!=i&&25!=i||metricReachGoal("claim_MADI");break;case"780":case"0355":20!=i&&25!=i||metricReachGoal("claim_AMPP");break;default:metricReachGoal("claim_other")}return!0}})):console.log("error","hint data load error"),l=!1},function(){console.log("error","hint data load error"),l=!1}):(c=n,l=!1)}function p(t,r,e){t.isLoading=!0,t.readOnly=!0,c=null,o.check(r,e).then(function(e){return e&&200==e.status?(a=e.data,s=r,t.readOnly=!1,t.isLoading=!1):u(t),e.data},function(e){return u(t),e.data}).then(function(e){e&&e.number&&(l=!0,d(e))})}return{addPostNumberFieldData:function(e){t=e},addDateFieldData:function(e){i=e},getPaymentCheckData:function(){return a},clearHintData:function(){c=null},isHintLoading:function(){return l},getHintText:function(){return c},postNumberField:{required:!0,uiOptions:"{clearOnBlur: false}",showErrors:!1,isLoading:!1,onBlur:function(e){!self.readOnly&&e.val().length&&s!=e.val()&&(20<=e.val().trim().length?p(this,e.val().trim()):i?p(this,(n=e).val().trim(),i.val()):n=e)}},datePostField:{notFuture:!0,showErrors:!1,onChange:function(e){var t;self.readOnly||(e.val().split(".").join("").match(/^[0-9]{8}$/)?(t=e.val(),i=e,n&&n.val().trim().length<20&&t!=this.currrentVal&&(this.currrentVal=t,p(this,n.val().trim(),t))):i=!1)},uiOptions:"{clearOnBlur: false}",boundField:"postNumber",boundScope:"helpData",boundRule:".{20,}"},postNumberFieldInit:{isLoading:!1,onInit:function(e){p(this,t,i)}},datePostFieldInit:{isLoading:!1,onInit:function(e){-1==e.attr("class").indexOf("ng-invalid")&&n&&p(this,t,i)}},textArea:{showErrors:!1,required:!1}}}]).factory("checkEpguPayment",["$http","$rootScope",function(r,o){return{check:function(e,t){return r({method:"GET",url:o.lkApi+"paygate/beta/payment-status/check",withCredentials:!0,cache:!1,params:{number:e.trim(),_:Math.random()}})}}}]).factory("FeedbackHint",["$http","$rootScope",function(e,t){return{get:function(){return e({method:"GET",url:t.staticDomainUrl+"htdocs/js/data/feedback/hint.json",cache:!1,params:{_:Math.random()}})}}}]).factory("CheckAuthorized",["$rootScope",function(e){return{check:function(){e.userId||(window.location="/auth/esia/?redirectPage=/")}}}]).factory("GetIpshAdditionalAttrs",["$rootScope",function(r){var o={};return{setFetchData:function(e,t){r.fetchComplete=!0,r.$broadcast("fetchComplete",e,t)},parseDate:function(e,t){var r;return!(!o||!o.items)&&(o.items.forEach(function(e){e.fkNumber!==t&&e.billId!==t||(r=e.ipshAdditionalAttrs)}),r)},get:function(e,t,r){return o=t,this.parseDate(r,e)}}}]).factory("GetPopularRating",["$rootScope","$http",function(e,t){return{get:function(){return t({method:"GET",url:e.bigBroUrl+"/api/lk/v1/quiz/public/rating",cache:!1,params:{_:Math.random()}})}}}]).factory("CmsPageRequestService",["$rootScope","$httpParamSerializer","$http","$q","$location","CmsPageRequestAddParams",function(o,e,n,i,a,t){var s=t.addParams;return{sendCmsPageRequest:function(e){var t=i.defer(),r={userID:o.userId,authenticated:!!o.userId,link:a.absUrl(),userSelectedRegion:o.userSelectedRegion||"00000000000",isInfomat:!1,tz:(new Date).getTimezoneOffset()},r=Object.assign(r,e,s),e=o.cmsUrl+"page";return n({method:"POST",url:e,data:r,cache:!1,withCredentials:!0}).success(function(e){t.resolve(e)}).error(function(e){t.reject(e)}),t.promise}}}]).factory("PsoWidgetInitializer",["$rootScope","$http","$location","$timeout","DetectErrorLink","CmsPageRequestAddParams","PsoWidget","ToggleCookie",function(i,e,t,r,o,n,a,s){var l={},c=(l.addParams=n.addParams,["/","/foreign-citizen","/entrepreneur","/legal-entity"]),u=["/search"];function d(){window.PSOLoading=!1,window.PSOLoaded=!1,console.warn("PSO widget loading or initialization failed")}function p(){var e={authenticated:!!i.userId,userID:i.userId,error404:!!o.get(),link:t.absUrl(),userSelectedRegion:i.userSelectedRegion||"00000000000",userSelectedService:i.servicesIdFRGU,isInfomat:!1,tz:(new Date).getTimezoneOffset(),isMobileView:!1,url:t.absUrl()};return Object.assign(e,l.addParams)}return i.psoHidePages&&(u=u.concat(i.psoHidePages.split(","))),l.isPsoRequired=function(){var e=!0;return!c.includes(t.path())||!i.excludePsoFromMain&&i.userId||(e=!1),u.includes(t.path())&&(e=!1),i.showPsoOnlyForAuthorized&&!i.userId&&(e=!1),i.psoDomain||(e=!1),"PARTNERS"===i.viewType&&(e=!1),i.allowedPsoPages&&-1===i.allowedPsoPages.indexOf("all")&&-1===i.allowedPsoPages.split(",").indexOf(t.path().split("/")[1])&&(e=!1),i.enableDevicesPso||"mob"!==i.version&&"pad"!==i.version||(e=!1),0===angular.element("#pso-widget-container").length&&(e=!1),window.isMap&&(e=!1),e=i.webViewMode?!1:e},l.isPsoLoaded=function(){return!!window.PSOLoaded},l.loadWidgetMinimax=function(){var e;document.querySelector("widget-minimax#widget-container")||((e=document.createElement("widget-minimax")).setAttribute("id","widget-container"),document.body.appendChild(e),(e=document.createElement("script")).type="text/javascript",e.async=!0,e.src=i.jsWidgetMinimaxUrl,document.body.appendChild(e))},l.manualCompletePsoLazyWidgetInitializationDataAcquiring=function(e){(/\/category\/\w+/.test(t.path())&&!/\/category\/health/.test(t.path())||/\/\d{5,6}/.test(t.path())||/\/group\/.+/.test(t.path()))&&0},l.loadAndRunPso=function(t){var e,r,o;window.PSOLoaded||window.PSOLoading||(window.PSOLoading=!0,window.showNewDesignPsoHelp=i.showNewDesignPsoHelp,window.psoOnlyRobomaxIcon=i.psoOnlyRobomaxIcon,window.enableLicenses=i.enableLicenses,window.betaUrl=i.betaUrl,e=function(){window.PSOLoading=!1,window.PSOLoaded=!0,p().then(function(e){if(void 0!==window.PSO&&window.PSO.init)try{window.PSO.init(function(){l.bindPsoPositionToFooter(),t&&t()},e)}catch(e){d()}else d()}).catch(d)},r=d,(o=document.createElement("script")).type="text/javascript",o.async=!0,o.onerror=r,o.src=i.psoDomain+"/sspwidget/bootstrap?ref="+encodeURIComponent(window.location.href),o.addEventListener("load",function(){"undefined"!=typeof PSO&&PSO.loading?PSO.loading.then(e).catch(r):r()}),document.body.appendChild(o))},l.updatePsoEnvironmentData=function(e,t){p().then(function(e){void 0!==window.PSO&&window.PSO.updatePsoEnvironmentData&&(window.PSO.updatePsoEnvironmentData(e),t)&&t()}).catch(d)},l.bindPsoPositionToFooter=function(){function r(e){return!!e[0]&&e[0].getBoundingClientRect()}var e,o=angular.element("#footer-wrapper"),n=angular.element("#pso-widget");o&&n&&!i.isMobile()&&(e=function(){var e=r(n).bottom+24>=r(o).top&&r(o).top<window.innerHeight,t="absolute"===n.css("position");e&&!t?n.css({position:"absolute"}):!e&&t&&n.css({position:""})},$(document).on("scroll",e),$(document).on("touchmove",e)),a.attachToFooter(!1)},l}]).factory("CmsPageRequestAddParams",["$rootScope",function(e){var r={addParams:{},getPageZoom:function(){var e=window.detectZoom&&window.detectZoom.zoom(),t=Math.round(16*e);1!=e?(1<e?window.metricReachGoal42679271("acsb_font_inprocchange_enlarge"):e<1&&window.metricReachGoal42679271("acsb_font_inprocchange_msmaller"),window.localStorage.setItem("acsb_font",!0),window.localStorage.setItem("acsb_fontsize",t),r.addParams.acsb_font=!0,r.addParams.acsb_fontsize=t):(window.localStorage.setItem("acsb_font",!1),r.addParams.acsb_font=!1)}};return r}]).factory("PsoWidget",["$rootScope","$document","$location","ToggleCookie","$timeout",function(e,t,r,s,l){return{hideWidget:function(){"undefined"!=typeof PSO&&PSO.widget&&PSO.widget.hideWidget&&(PSO.widget.hideWidget(),e.psoOnlyRobomaxIcon)&&$("#pso-widget-robomax").hide()},showWidget:function(){"undefined"!=typeof PSO&&PSO.widget&&PSO.widget.showWidget&&(PSO.widget.showWidget(),!e.psoOnlyRobomaxIcon||["false",""].indexOf(e.psoOnlyRobomaxIcon)+1||$("#pso-widget-robomax").show())},attachToFooter:function(t){function o(e){return!!e[0]&&e[0].getBoundingClientRect()}var n,i,a=angular.element("#pso-widget-robomax");a&&e.psoOnlyRobomaxIcon&&(n=document.getElementById("pso-robomax-bubble"),i=document.getElementById("close-bubble"),l(function(){function e(){var e=angular.element("#footer-wrapper"),t=(a=angular.element("#pso-widget-robomax"),s.readCookie("psoBubbleClosed")),e=o(a).bottom+24>=o(e).top&&o(e).top<window.innerHeight,r="absolute"===a.css("position");e&&!r?(t||(n.style.display="none",i.style.display="none"),a.css({position:"absolute"})):!e&&r&&(t||(n.style.display="block",i.style.display="block"),a.css({position:"fixed"}))}e(),t||($(document).on("scroll",e),$(document).on("touchmove",e))},0))},minimizeWidget:function(){"undefined"!=typeof PSO&&PSO.widget&&PSO.widget.minimizeWidget&&PSO.widget.minimizeWidget()},maximizeWidget:function(){"undefined"!=typeof PSO&&PSO.widget&&PSO.widget.maximizeWidget&&PSO.widget.maximizeWidget()},toggleWidget:function(){"undefined"!=typeof PSO&&PSO.widget&&PSO.widget.toggleWidget&&PSO.widget.toggleWidget()},openChatTab:function(){"undefined"!=typeof PSO&&PSO.widget&&PSO.widget.openChatTab&&PSO.widget.openChatTab()},openHelpTab:function(){"undefined"!=typeof PSO&&PSO.widget&&PSO.widget.openHelpTab&&PSO.widget.openHelpTab()},openWidgetAndGotoChat:function(){this.showWidget(),e.defaultPsoTab&&"info-tab"===e.defaultPsoTab||this.openChatTab()},initWidgetChannel:function(e){e=new CustomEvent("initWidgetChannel",{detail:{path:e}});window.dispatchEvent(e)},notifyLocationChanged:function(e,t,r){"undefined"!=typeof PSO&&PSO.widget&&PSO.widget.notifyLocationChanged&&PSO.widget.notifyLocationChanged(e,t,r)}}}]).factory("MainPageMetric",["$rootScope","$location",function(i,a){var s="main_page_metric";function o(e,n){var t,r={},o=[];for(t in e)o.push(e[t]);o.reduce(function(e,t,r,o){return e[t]=r==o.length-1?n:{}},r),i.disableMetric||window.metricReachGoal24845174(s,r)}function n(e,t,r){return"/legal-entity"===a.path()?t:"/entrepreneur"===a.path()?e:r}return{send:function(e,t,r){switch(e){case"authorize":o({level1:"auth",level2:"header",level3:"url"},location.href);break;case"mainauth":o({level1:"auth",level2:"main"},n("emainauth","lmainauth","mainauth"));break;case"mainreg":o({level1:"auth",level2:"main"},n("emainreg","lmainreg","mainreg"));break;case"searchHeader":o({level1:"search"},"header");break;case"searchMain":o({level1:"search"},n("emain","lmain","main"));break;case"searchHeaderButton":o({level1:"search",level2:"header",level3:"button"},t);break;case"searchButton":o({level1:"search",level2:n("emain","lmain","main"),level3:"button"},t);break;case"situation":o({level1:n("emainpopular","lmainpopular","mainpopular")},"situation");break;case"services":o({level1:n("emainpopular","lmainpopular","mainpopular")},"services");break;case"informerShow":o({level1:"informer",level2:"show"},t);break;case"informerAction":o({level1:n("einformers","linformers","informers"),level2:"action",level3:t,level4:"data"},r);break;case"informerUpdate":o({level1:n("einformers","linformers","informers"),level2:"refresh"},t);break;case"informerActionShort":o({level1:"informer",level2:"action"},t);break;case"informerPayAction":o({level1:"informer",level2:"PayAction"},t);break;case"informerErrorAction":o({level1:"informer",level2:"Erroraction"},t);break;case"informerNoEnoughRightsAction":o({level1:"informer",level2:"NoEnoughRightsAction"},t);break;case"informerProfileAction":o({level1:"informer",level2:"Profileaction"},t);break;case"informerLogin":o({level1:"informer",level2:"Login"},t);break;case"informerCreateAccount":o({level1:"informer",level2:"CreateAccount"},t);break;case"informerHintAction":o({level1:"informer",level2:"hintaction"},t);break;case"informerBarcode":o({level1:"informer",level2:"UINaction"},t);break;case"informerKNDShow":o({level1:"KND",level2:"show"},t);break;case"informerKNDAction":o({level1:"KND",level2:"action"},t);break;case"feedRow":o({level1:"main",level2:n("epersonfeed","lpersonfeed","personfeed")},"feedrow");break;case"feedButton":o({level1:"main",level2:n("epersonfeed","lpersonfeed","personfeed")},"feedbutton");break;case"personHeader":o({level1:n("epersonheader","lpersonheader","personheader"),level2:"action"},t)}},legalEntitySend:function(e,t,r){var o,n;i.disableMetric||"/legal-entity"!==a.path()||(o="Главная ЮЛ",n={},r?(n[e]={},n[e][t]=[r]):t?n[e]=[t]:n=[e],(r={})[o]=n,window.metricReachGoal24845174(o,r))}}}]).factory("DutyInformerService",["$rootScope","$http",function(e,t){return{getData:function(){return t({method:"GET",url:e.lkApi+"paygate/orderPayments",withCredentials:!0}).then(function(e){if(e&&e.data&&200==e.status)return e},function(e){return e})}}}]).factory("ToggleCookie",["$rootScope",function(i){function t(e,t,r){var o,n="";r&&((o=new Date).setTime(o.getTime()+24*r*60*60*1e3),n="; expires="+o.toUTCString()),document.cookie=e+"="+t+n+"; path=/; domain="+i.cookieDomain}return{eraseCookie:function(e){t(e,"",-1)},readCookie:function(e){for(var t=e+"=",r=document.cookie.split(";"),o=0;o<r.length;o++){for(var n=r[o];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return null},createCookie:t}}]).factory("ShowLkFeeds",["ToggleCookie","$rootScope","$location",function(e,t,r){return{init:function(){if(t.userCounters&&0<t.userCounters.total){if(e.createCookie("showUnreadFeeds",!0),t.isLk)return void r.path("notifications");window.location=t.lkUrl+"notifications"}window.location=t.lkUrl+"notifications"}}}]).factory("MainPageService",["$rootScope","$http","userTypeService","$q","$location","$timeout","OkatoService",function(r,o,n,e,i,t,a){var s=!0,l=e.defer();return{clear:function(){r.detectRegionIsComplete=!0,s=!0,l=e.defer()},getBanners:function(){return r.mainServiceData[n.getUserType().userTypeGosBar].banners},getDisclaimers:function(){return r.mainServiceData[n.getUserType().userTypeGosBar].disclaimers},getSearchConfig:function(){return r.mainServiceData[n.getUserType().userTypeGosBar].searchConfig},getPopular:function(){return r.mainServiceData[n.getUserType().userTypeGosBar].popular},getPopularAuth:function(){return r.mainServiceData[n.getUserType().userTypeGosBar].popularAuth},getLS:function(){return r.mainServiceData[n.getUserType().userTypeGosBar].ls},getNews:function(){return r.mainServiceData[n.getUserType().userTypeGosBar].news},getFooter:function(){return r.mainServiceData[n.getUserType().userTypeGosBar].footer},getAll:function(){return s&&r.detectRegionIsComplete?(r.detectRegionIsComplete=!1,s=!1,t(function(){var e,t={personType:function(){var e;switch(window.location.pathname){case"/legal-entity":e="LEGAL";break;case"/entrepreneur":e="SOLE_PROPRIETOR";break;case"/foreign-citizen":e="FOREIGN"}return e||n.getUserType().cmsType}(),region:a.getFederalNum(),platform:SmartPhone.isAny()?SmartPhone.isPhone()?"EPGUV3_MOB":"EPGUV3_TAB":"EPGUV3_DESK",_:Math.random()};return i.$$path&&~i.$$path.indexOf("/r/")&&(e=i.$$path.replace("/r/",""),t.region=r.manualRegions[e]&&r.manualRegions[e].okato||r.serverRegion),o({method:"GET",url:r.cmsUrl+"main",cache:!1,params:t,withCredentials:!0}).then(function(e){var t;e&&e.data&&200==e.status?(r.mainServiceData||(r.mainServiceData={}),t=n.getUserType().userTypeGosBar,r.$emit("mainPageServiceLoad",e.data),r.mainServiceData[t]=e.data,r.mainServiceError=!1,l.resolve(e.data)):(r.mainServiceError=!0,l.reject(e))},function(e){r.mainServiceError=!0,l.reject(e)}),l.promise},0)):l.promise},getFaq:function(){return r.mainServiceData[n.getUserType().userTypeGosBar].faq},getRegionCases:function(){return r.mainServiceData[n.getUserType().userTypeGosBar].regionCases},getMainBlocksData:function(){o({method:"GET",url:r.mainBlocksData,cache:!1,withCredentials:!0,params:{_:Math.random(),type:"person"}}).then(function(e){function o(t){if(!t)return"";var r;try{r=JSON.parse(t)}catch(e){r=t}return r}e&&e.data&&200===e.status&&(r.mainPageFooter=e.data.footer,r.mainPageFooter)&&(e=r.mainPageFooter.blocks[r.mainPageFooter.blocks.length-1],r.isUpdatedFooter=e.links&&e.links[0]&&e.links[0].ico,r.mainPageFooter.blocks.forEach(function(e){e.links.forEach(function(e){var t=o(e.url),r=o(e.ico);"string"!=typeof t&&(e.urlsInfo={authorized:t.auth,default:t.unauth}),"string"!=typeof r&&(e.iconsInfo={main:r.icon,hover:r.hover})})}))})}}}]).factory("KndListService",["$rootScope","$http","$q",function(n,i,a){return{getListData:function(e){return i({method:"GET",withCredentials:!0,cache:!1,url:n.lkApi2+"procuracy/informers/knd/search",params:e=e||{}})},checkAfterKndAppeal:function(e,t){var r={};e.forEach(function(e){e.erpId&&e.ctrlOrgFRGU&&(r[e.erpId]=e.ctrlOrgFRGU)}),Array.isArray(t)&&t.length&&e.length&&t.forEach(function(e){r[e.erpid]&&(e.isDoKndAppeal=!0,e.ctrlOrgFRGU=r[e.erpid])}),t&&t.erpid&&e.length&&r[t.erpid]&&(t.isDoKndAppeal=!0,t.ctrlOrgFRGU=r[t.erpid])},getErpIds:function(e){var t=[];return e&&(Array.isArray(e)?e.length&&e.forEach(function(e){e.erpid&&t.push(e.erpid)}):e.erpid&&t.push(e.erpid)),t},doKndAppeal:function(t){var r=a.defer(),o=this,e=this.getErpIds(t);return e.length?(e=e.join(","),e={_:Math.random(),erpArray:e},i({method:"GET",withCredentials:!0,cache:!1,url:n.lkApi2+"procuracy/informers/knd/doKndAppeal",params:e}).then(function(e){e&&200===e.status&&e.data&&(e=e.data,o.checkAfterKndAppeal(e,t),r.resolve())},function(e){r.resolve()})):r.resolve(),r.promise}}}]).factory("KndDateService",["$rootScope","$http",function(t,r){return{getDates:function(e){return r({method:"GET",cache:!1,withCredentials:!0,url:t.lkApi2+"procuracy/informers/knd/dates",params:e=e||{}})}}}]).factory("KndStatusService",["$rootScope","$http",function(t,r){return{getStatuses:function(e){return r({method:"GET",cache:!1,withCredentials:!0,url:t.lkApi2+"procuracy/informers/knd/statuses",params:e=e||{}})}}}]).factory("KndDocumentsService",["$rootScope","$http",function(t,r){return{downloadDocuments:function(e){return r({method:"GET",cache:!1,withCredentials:!0,url:t.lkApi+"feeds/GEPS/"+e})}}}]).factory("KndFormService",["$rootScope","$location","$moment",function(e,t,r){return{getConfig:function(){return{data:e.informerKnd,userField:{label:"L"===e.userType?"Наименование юридического лица":"Индивидуальный предприниматель"},ogrnField:{label:"L"===e.userType?"ОГРН":"ОГРНИП"},userName:e.user.orgShortName,ogrn:e.user.orgOGRN,time:r().format("D MMMM YYYY HH:mm"),dateFieldLable:"Выбрать месяц и год"}},redirectToMain:function(){e.kndEnabled||("L"===e.userType?t.path("/legal-entity"):t.path("/entrepreneur"))}}}]).factory("KndCountService",["$http","$rootScope","$location","UserService","$q",function(e,t,r,o,n){function i(){return e({method:"GET",withCredentials:!0,cache:!1,url:t.lkApi2+"procuracy/informers/knd/counters",params:{type:"short",_:Math.random()}}).then(function(e){return e&&e.data&&(e.data={amountCurrent:e.data.totalCurrent||0,amountUpcoming:e.data.totalUpcoming||0,amountLast:e.data.totalLast||0}),e})}function a(){return i().then(function(e){return e&&e.data&&200==e.status?e.data:{state:"F"}},function(){return{state:"F"}})}return{getKndCounters:i,getCount:a,getTabs:function(){return a().then(function(e){return"F"!==e.state?[{title:"Прошедшие ("+e.amountLast+")",last:"last",count:e.amountLast,active:!1},{title:"Текущие ("+e.amountCurrent+")",current:"current",count:e.amountCurrent,active:!1},{title:"Предстоящие ("+e.amountUpcoming+")",upcoming:"upcoming",count:e.amountUpcoming,active:!1}]:{state:"F"}})}}}]).factory("KndInformerService",["$http","$rootScope","$location","UserService","$q","MainPageMetric",function(e,t,r,o,n,i){var a={data:"",state:"U",title:"Информация о проверках",updateMessage:"Идет поиск",errorMessage:"Не удалось загрузить данные",emptyMessage:"Проверок не найдено",getActiveTab:function(){return a.data.tab},getInformerData:function(){return t.kndEnabled?o.afterLoad().then(function(){return e({method:"GET",withCredentials:!0,cache:!1,url:t.lkApi2+"procuracy/informers/knd/counters",params:{type:"short",_:Math.random()}}).then(function(e){return e&&e.data&&(e.data={amountCurrent:e.data.totalCurrent||0,amountUpcoming:e.data.totalUpcoming||0,amountLast:e.data.totalLast||0}),e}).then(function(t){var e;return t&&t.data&&(e=!1,Object.keys(t.data).length)&&(e=Object.keys(t.data).some(function(e){return 0<t.data[e]})),t&&t.data&&200==t.status&&e?(a.state="E",a.data=t.data):t&&t.data&&200==t.status&&!e?a.state="D":a.state="F",i.send("informerKNDShow",{KNDstatus:"F"===a.state?"Error":"Show"}),a},function(){return a.state="F",i.send("informerKNDShow",{KNDstatus:"Error"}),a})}):n.defer().promise},getStatuses:function(){return{entries:{amountCurrent:a.data.amountCurrent||0,amountUpcoming:a.data.amountUpcoming||0,amountLast:a.data.amountLast||0}}},setKndFormPath:function(){r.url(t.kndUrl+"form")},getRisksCount:function(){return e({method:"GET",withCredentials:!0,cache:!1,url:t.lkApi+"kno/informers/risks"})}};return a}]).factory("KndDetailsService",["$http","$rootScope","$location","UserService",function(t,r,e,o){return{getDetails:function(e){return t({method:"GET",withCredentials:!0,cache:!1,url:r.lkApi2+"procuracy/informers/knd/"+e})},getMenuWithoutResult:function(e){var t=[{title:"Общая информация",id:"common"},{title:"Орган госконтроля",id:"part"},{title:"Согласование проверки",id:"coordination"},{title:"Контрольные мероприятия",id:"controlEvents"},{title:"Правовые основания",id:"basis"},{title:"Субъект проверки",id:"subject"},{title:"Объекты проверки",id:"objects"}];return e.gepsData&&e.gepsData.length&&e.gepsData.filter(function(e){return["KNO_MOTIV_REQUEST","KNO_ADDITIONAL_REQUEST"].includes(e.type)}).length&&t.push({title:"Запросы документов",id:"requests"}),e.linkedInspections&&e.linkedInspections.length&&t.push({title:"Связанные проверки",id:"linked-inspections"}),e.navigationMenu,t},getMenuWithResult:function(e,t){var r=[{title:"Акт проведения проверки",id:"act"}];return t.hasResult&&"0"!=t.hasResult&&(t.result.objInspectors&&t.result.objInspectors.length||t.result.inspReprName||t.result.inspReprPos)&&r.push({title:"Участники проверки",id:"participants"}),r.push({title:"Выявленные нарушения",id:"violations"}),r}}}]).factory("KndAuditCheckDialog",["$rootScope","$http","$location","ngDialog",function(i,a,e,t){return{showAuditIsLegalDialog:function(e){t.open({templateUrl:i.templatePath+"/tpl/knd/knd-audit-check"+(i.isMobile()?"-mob.html":".html"),controller:["$scope",function(t){function r(e){t.searchInProgress=!1,403===e.status||404===e.status?(t.searchInProgress=!1,t.searchComplete=!0):t.error=!0}function o(e){e&&"done"===e.status?(t.searchInProgress=!1,t.searchComplete=t.searchSuccessfull=!0,t.inspection=e.result):(e&&"fail"===e.status||r(e),t.searchInProgress=!1,t.searchComplete=!0)}function n(e){return t.error=!1,t.searchInProgress=!0,a({method:"GET",url:i.lkApi2+"procuracy/informers/knd/"+t.auditNumber,withCredentials:!0,cache:!1,params:Object.assign({_:Math.random()},{intSearch:e?"true":"check"})}).then(function(e){if(e.error)r(e.error);else{if(201===e.status)return{status:"processing",result:e.data};if(e.data&&e.data.length)return{status:"done",result:e.data[0]}}return{status:"fail",result:null}}).catch(r)}t.auditNumber=e||"",t.$watch("auditNumber",function(){t.clearValidationError()}),t.maskUIOptions={maskDefinitions:{Q:/[\dY]/},clearOnBlur:!1,restrict:"reject",addDefaultPlaceholder:!1,allowInvalidValue:!0},t.auditNumberField={maxLength:14,mask:"?9?9?Q?Q?9?9?9?9?9?9?9?9?9?9",showErrors:!1,uiMaskPlaceholderChar:"space",uiOptions:"maskUIOptions",keydown:"$event.keyCode === 13 && checkAuditIsLegal()"},t.checkAuditIsLegal=function(){t.error=!1,t.searchInProgress||t.searchTakesTooLong||(t.auditNumberMissing=!t.auditNumber,t.auditNumberIncorrect=!/^\d{2}(Y{2}\d{8}|\d{12}|\d{10})$/.test(t.auditNumber),t.auditNumberMissing)||t.auditNumberIncorrect||(t.searchComplete=t.searchTakesTooLong=t.searchSuccessfull=!1,n(!0).then(function(e){e&&"processing"===e.status?setTimeout(function(){n(!1).then(function(e){t.searchInProgress=!1,"processing"===e.status?(t.searchInProgress=!1,t.searchComplete=!0):o(e)})},3e4):o(e)}))},t.redirectToAppeal=function(){return t.searchComplete&&!t.searchSuccessfull&&(window.location.href=i.appealFormUrl||i.betaUrl+"325914/1",t.closeThisDialog()),!1},t.resetSearch=function(){t.searchInProgress||t.searchTakesTooLong||(t.auditNumber=""),t.clearValidationError()},t.clearValidationError=function(){t.auditNumberMissing=t.auditNumberIncorrect=!1},t.clearValidationError(),t.nameAndTitle=function(e,t){return e?t?e+", "+t:e:t||""}}],className:"knd-dialog"})}}}]).factory("KndDigitalSignatureCheckDialog",["$rootScope","LkService","ngDialog",function(i,e,a){return{checkSignatureAndShowResults:function(o){function t(r){a.closeAll(),a.open({templateUrl:i.templatePath+"/tpl/knd/knd-signature-check"+(i.isMobile()?"-mob.html":".html"),controller:["$scope","$injector",function(e,t){Object.assign(e,r),e.gepsEdsUrl=i.gepsApiUrl+"file/download/"+(o?o.attachmentId:"000")+"/sig",e.recheckEds=function(){n.hasOwnProperty("checkSignatureAndShowResults")&&n.checkSignatureAndShowResults(o)}}],className:"knd-dialog"})}var n=this,r={sign:{},fileName:o?o.fileName:"(неизвестный файл)",statusCode:null};e.resultGepsEds(o.attachmentId).then(function(e){e&&200===e.status&&e.data?(e.data.status?"RUNNING"===e.data.status||"OK"===e.data.status?r.statusCode=e.data.status:["InvalidSignature","NoSignCert","CertExpired","MoreThanOneCert","CertIsRevoked","NoSignatures","CertificateNoChain","SignCertNotValid","CertRevokationCheckFailed","CertificateNotInTSL","CrtificateNotQualified","InvalidAccreditationPeriod"].includes(e.data.status)?r.statusCode="INVALID":(["InternalError","ParsingError","UnsignedMessage","InvalidConfiguration","BadInputData","UnexpectedError"].includes(e.data.status),r.statusCode="ERROR"):r.statusCode="ERROR",r.sign=e.data):r.statusCode="ERROR",t(r)},function(e){r.statusCode="ERROR",t(r)})}}}]).factory("RolesConfig",["$rootScope","$location","ToggleCookie",function(t,e,r){var o=SmartPhone.isAny()&&SmartPhone.isPhone();return{get:function(){return{roles:[],avatar:{"background-image":'url("'+t.user.userAvatarLink+'")'},returnUrl:t.lcUrl+"?returnUrl="+e.absUrl(),banners:void 0,getPassportTitle:function(){return"RUS"!=t.user.personCitizenship?"Основной документ":"Паспорт"},goToAvatar:function(e){r.createCookie("goToEsia",!0,1),window.location.href=t.lcUrlUser+(o?"/avatar":"settings?Avatar")},goToData:function(){window.location.href=t.lcUrl+"?cid=PGU&rurl="+e.absUrl()},goToSecurity:function(){window.location.href=t.lcUrlUser+"settings"}}}}}]).factory("MainPageUser",["$location","$rootScope",function(r,o){return function(){var e=!0,t=r.path();switch(o.userType){case"P":e="/"===t;break;case"B":e="/entrepreneur"===t;break;case"L":e="/legal-entity"===t}return e}}]).factory("GetLazyLoadFile",["$rootScope","$ocLazyLoad",function(o,n){return{get:function(e,t,r){e=o.disableMetric?e:t;return Array.isArray(e)?r?Promise.all(e.map(n.load)):e.reduce(function(e,t){return e.then(n.load.bind(n,t))},Promise.resolve()):n.load(e)}}}]).factory("RemoveOffsetZone",[function(){return function(e){var t=new RegExp("T"),r=new RegExp("-"),r=e.split(t)[0].split(r);return r[0]+"-"+r[1]+"-"+r[2]+" "+e.split(t)[1].substring(0,5)}}]).factory("newsDateService",function(){return{yearNew:null,pageChanged:""}}).factory("autoNumbersPatterns",function(){var e="ABCEHKMOPXYTabcehkmopxytАВСЕНКМОРХУТавсенкморхут",t="["+e+"]",r="["+e+"Dd]",o="[а-яА-ЯёЁ]",n="\\d",i=["^"+t+"{2}"+n+"{3}"+t+n+"{2}$","^"+t+"{2}"+n+"{5}$","^"+t+"{1,2}"+n+"{6}$","^\\d{3}"+t+"{1,2}"+n+"{2}$","^"+t+n+"{3}"+t+"{2}("+n+"{2,3})?$","^\\d{9}$","^\\d{3}"+r+n+"{5,6}$","^\\d{4}"+t+"{1,2}"+n+"{2}$","^"+r+n+"{7,8}$","^\\d{4}"+o+"{2,3}$","^"+o+n+"{4}"+o+"{2}$","^"+o+"{3}"+n+"{4}$","^\\d{4}"+t+"{2}("+n+"{2,3})?$","^\\d{3}([CcСс][Dd])\\d{3,4}$","^[КСТкстKCTkct]"+t+"{2}"+n+"{5}","^[КСксKCkc]\\d{3}"+t+"{2}"+n+"{5}$","^"+t+"{2}"+n+"{2}"+t+"{2}"+n+"{2}$"];return{getCarNumberPatterns:function(){return i.map(function(e){return new RegExp(e)})},getBikeNumberPattern:function(){return new RegExp("^\\d{4}[ABCEHKMOPXYTabcehkmopxytАВСЕНКМОРХУТавсенкморхут]{2}(\\d{2,3})?$")},getCarNumberSinglePattern:function(){return new RegExp(i.join("|"))},getCarCertNumberPattern:function(){return new RegExp("^\\d{2}\\s?[\\dABCEHKMOPXYTabcehkmopxytАВСЕНКМОРХУТавсенкморхут]{2}\\s?\\d{6}$")},getCarCertLettersSet:function(){return new RegExp("[\\d"+e+"]")},getTransportNamePattern:function(){return new RegExp("^[A-Za-zА-Яа-яЁё,\\-\\.'\\d\\s]*$")}}}).factory("paymentAuth",["$http","$rootScope","$q","$moment","$timeout","PaymentService","PerformanceService",function(r,b,w,S,P,C,a){var o=w.defer(),n=w.defer();b.unitedInformerLoaded=!1,b.unitedInformerLoadedShort=!1;return{getDocsJSON:function(){return r({url:b.staticDomainUrl+"htdocs/js/data/payment-auth.json",method:"GET",cache:!0})},getInformerFull:function(){return b.unitedInformerLoaded||(a.measureStart("edinformerFull"),r({url:b.ipshApi+"informer/fetch/",method:"GET",withCredentials:!0,cache:!1,params:{_:Math.random()}}).then(function(e){b.unitedInformerLoaded=!0;var t,r=e&&e.data&&e.data.error&&e.data.error.code;0===r||6001===r?a.measureEnd("edinformerFull",0,{utm_source:"edinformerFull_ok-"+r}):(t=e&&e.data&&e.data.error&&e.data.error.message,a.measureEnd("edinformerFull",1,{BrowserError:r,ErrorMessage:t,utm_source:"edinformerFull_no"})),o.resolve(e)}).catch(function(e){b.unitedInformerLoaded=!0,a.measureEnd("edinformerFull",1,{BrowserError:e.status,ErrorMessage:e.statusText,utm_source:"edinformerFull_no"}),o.reject(e)})),o.promise},getInformerShort:function(){return b.unitedInformerLoadedShort||(a.measureStart("edinformerShort"),r({url:b.ipshApi+"informer/fetch/",method:"GET",withCredentials:!0,cache:!1,params:{short:!0,_:Math.random()}}).then(function(e){b.unitedInformerLoadedShort=!0;var t,r=e&&e.data&&e.data.error&&e.data.error.code;0===r?a.measureEnd("edinformerShort",0,{utm_source:"edinformerShort_ok"}):(t=e&&e.data&&e.data.error&&e.data.error.message,a.measureEnd("edinformerShort",1,{BrowserError:r,ErrorMessage:t,utm_source:"edinformerShort_no"})),n.resolve(e)}).catch(function(e){b.unitedInformerLoadedShort=!0,a.measureEnd("edinformerShort",1,{BrowserError:e.status,ErrorMessage:e.statusText,utm_source:"edinformerShort_no"}),n.reject(e)})),n.promise},informerClear:function(){this.informerShortClear(),this.informerFullClear()},informerShortClear:function(){b.unitedInformerLoadedShort=!1,n=w.defer()},informerFullClear:function(){b.unitedInformerLoaded=!1,o=w.defer()},synchronizeFullAndShortInformers:function(e,t,r){function o(e,t){var r=e.error&&e.error.code,o=t.error&&t.error.code,e=e.result&&e.result.amount,t=t.result&&t.result.amount;return r===o&&e===t}var n=this;"full"===e&&b.unitedInformerLoadedShort&&this.getInformerShort().then(function(e){!e.data||o(e.data,{error:t,result:r})||n.informerShortClear()}),"short"===e&&b.unitedInformerLoaded&&this.getInformerFull().then(function(e){!e.data||o(e.data,{error:t,result:r})||n.informerFullClear()})},downLoadFile:function(e){var t=b.ipshApi+"informer/download/csv";return r({url:t,method:"GET",withCredentials:!0,params:e})},downloadFileEmail:function(e){var t=b.ipshApi+"informer/download/email";return r({url:t,method:"POST",withCredentials:!0,params:e})},getFineData:function(e,t){e=b.ipshApi+"informer/gibdd/details/"+e;return r({url:e,method:"GET",withCredentials:!0,params:t})},loadMoreFineInfo:function(o,n){n=void 0===n||n;var e,i=w.defer();return o.infoLoaded?i.resolve():(e={md5:o.signature},o.fineInfoLoading=!0,a.measureStart("fineDetails"),this.getFineData(o.fkNumber,e).then(function(e){var t,r;e&&e.data&&e.data.content&&(t=e.data.content,o.infoLoaded=!0,t.violationDate&&(r=["Вс.","Пн.","Вт.","Ср.","Чт.","Пт.","Сб."][S(t.violationDate,"DD.MM.YYYY").day()],o.violationFullDate=t.violationDate+", "+r+" "+(t.violationTime||"")),["offense","docNum","docDate","carModel","stsNumber","carNumber","deptCode","offenseDivisionName","offenseDivision","signature"].forEach(function(e){o[e]=t[e]}),o.withPhoto=t.hasPhoto&&n),o.errorCode=e&&e.data&&e.data.error&&e.data.error.code,0===o.errorCode?a.measureEnd("fineDetails",0,{utm_source:"fineDetails_ok"}):(r=e&&e.data&&e.data.error&&e.data.error.message,a.measureEnd("fineDetails",1,{BrowserError:o.errorCode,ErrorMessage:r,utm_source:"fineDetails_no"})),i.resolve()}).catch(function(e){console.log("Error by load fine details",e),a.measureEnd("fineDetails",1,{BrowserError:e.status,ErrorMessage:e.statusText,utm_source:"fineDetails_no"})}).finally(function(){o.fineInfoLoading=!1})),i.promise},getUserGrouping:function(){var t=w.defer();return b.billsGroupingRequested||r({url:b.lkApi+"informersAttributes/common/gibddgrouping",method:"GET",withCredentials:!0}).then(function(e){e&&e.data&&e.data.attrValue?t.resolve(e.data.attrValue):t.resolve(!1),b.billsGroupingRequested=!0},function(e){t.resolve(!1),console.log(e)}),t.promise},setUserGrouping:function(e){var t=b.lkApi+"informersAttributes/common/gibddgrouping/";r({url:t+=e?"activate":"deactivate",method:"POST",withCredentials:!0})},createBillId:function(e){return r({url:b.ipshApi+"bill/service/create",method:"POST",withCredentials:!0,data:e,headers:{"Content-Type":"application/json;"}})},ipshSubscribe:function(e,t){return r({url:b.bigBroUrl+"/api/pay/subscriptions/v1/subscribe",method:"POST",withCredentials:!0,data:t,params:e})},getPaymentHelpText:function(t,e){var r=e.supplier,o=e.isTax,n=e.ipPaymentAmount,i=e.extId,a=t.paymentItems&&t.paymentItems.paymentItems&&t.paymentItems.paymentItems[0]||t.paymentItems&&t.paymentItems[0],s=!1;function l(){var e;s||(e={},"FINE"!==r||o||(e={topic:"offence",fkNumber:a.billNumber,datePost:S(a.billDate).format("DD.MM.YYYY"),extId:i,status:t.status.name,paymentName:encodeURIComponent(t.paymentName),supplierName:r,date:t.date}),b.$emit("cmsPageRequestEvent",e),s=!0,P(function(){s=!1},1e4))}var c,u,d,p,m,h=t.statusUpdated?S().diff(t.statusUpdated,"hours"):0,f=t.createTime?S().diff(t.createTime,"hours"):0,g={NEW:"in_progress",PAY_SERVICE_CONFIRMATION:"in_progress",PAY_SERVICE_CONFIRMED:"in_progress",BANK_PAY_ORDER_CONFIRMATION:"in_progress",BANK_PAY_ORDER_CONFIRMED:"in_progress",SERVICE_PROVIDER_CONFIRMATION:"in_progress",SERVICE_PROVIDER_CONFIRMED:"done",BANK_PAY_CONFIRMATION:"done",GISGMP_QUITTANCE_STATUS:"done",PAYMENT_DENIED:"abort",PAY_SERVICE_ABORTED:"abort",PAYMENT_ABORTED:"abort",BANK_PAY_CONFIRMED:"confirmed"}[t.status.code],v={},y=w.defer();switch(g){case"in_progress":c=f<24?"Платеж считается проведенным в момент поступления в ГИС ГМП информации о нем. Обычно это происходит быстро.":'Время обработки платежа превысило 24 часа. <a ng-click="goToFeedback()">Обратитесь в техподдержку</a>, если платеж не будет принят.',y.resolve({message:c,goToFeedback:l});break;case"abort":i&&("PAYMENT_DENIED"===t.status.code?(u=t.payMethod&&t.payMethod.code,c="MOBTEL"===u?"Оператор мобильной оплаты не принял платёж. Повторите оплату с мобильного телефона или выберите другой способ.":"Если вы не получили уведомление от банка об отмене платежа, для уточнения времени возврата средств обратитесь в банк, выдавший карту. Обычно деньги блокируются банком на срок до 30 дней.",(h<=b.timeoutRequisites||"MOBTEL"===u)&&(v.payAgain=!0)):c="Платеж отклонен банком из-за некорректных реквизитов в начислении. Рекомендуем обратиться в ведомство, выставившее начисление, для корректировки реквизитов."),y.resolve({message:c,additionalInfo:v,goToFeedback:l});break;case"confirmed":case"done":"FSSP"===r&&"confirmed"===g?(c=0<+n?'Платеж получен, но еще не зачислен в пользу данного начисления.<br><a href="https://www.gosuslugi.ru/help/faq/voprosy_po_oplate/2395">Особенности погашения судебных задолженностей</a>.':0==+n?'Платеж по начислению обработан ФССП.<br><a href="https://www.gosuslugi.ru/help/faq/voprosy_po_oplate/2395">Особенности погашения судебных задолженностей</a>.':'<a href="https://www.gosuslugi.ru/help/faq/voprosy_po_oplate/2395">Особенности погашения судебных задолженностей</a>.',y.resolve({message:c,additionalInfo:v})):"FNS"!==r||o||"confirmed"!==g?"182"!==(d=(u=a.billNumber).substr(0,3))&&"322"!==d&&1!=t.quittanceStatusFK?C.loadBillDetails(u,function(e){e.bill&&e.bill.addAttrs&&e.bill.addAttrs.attrs&&e.bill.addAttrs.attrs.length&&(angular.forEach(e.bill.addAttrs.attrs,function(e){"FKQuittanceStatus"===e.name&&(p=e.value),"FKQuittanceComment"===e.name&&(m=e.value)}),"done"!==g||p&&("1"===p||"3"===p)?"1"===p?c='Информация о платеже получена <a href="https://www.gosuslugi.ru/help/faq/voprosy_po_oplate/2543">системой государственных и муниципальных платежей</a>.':"confirmed"===g&&("3"!==p||"FINE"!==r&&!o||(c='Информация о платеже пока не получена <a href="https://www.gosuslugi.ru/help/faq/voprosy_po_oplate/2543">системой государственных и муниципальных платежей</a>. <a ng-click="goToFeedback()">Обратитесь в техподдержку</a>, если платеж не будет принят.'),m)&&~m.toLowerCase().indexOf("недоплата")&&(c=m,o)&&("."!==c[c.length-1]&&(c+="."),c+=" Начисление позже будет уточнено ведомством с учётом скидки."):(c=h<48?"Расчетный банк принял информацию о платеже для перечисления денежных средств получателю. Дождитесь проведения платежа.":(v.status="in_progress",'Время обработки платежа превысило 48 часов. <a ng-click="goToFeedback()">Обратитесь в техподдержку</a>, если платеж не будет проведен.'),v.printAndSendQuittanceHide=!0)),y.resolve({message:c,additionalInfo:v,goToFeedback:l})},"",{ci:!1,subscribe:!1}):"1"===t.quittanceStatusFK?(c='Информация о платеже получена <a href="https://www.gosuslugi.ru/help/faq/voprosy_po_oplate/2543">системой государственных и муниципальных платежей</a>.',y.resolve({message:c})):("done"===g&&(c=h<48?"Расчетный банк принял информацию о платеже для перечисления денежных средств получателю. Дождитесь проведения платежа.":(v.status="in_progress",'Время обработки платежа превысило 48 часов. <a ng-click="goToFeedback()">Обратитесь в техподдержку</a>, если платеж не будет проведен.')),y.resolve({message:c,additionalInfo:v,goToFeedback:l})):(h<240?c="Налоги и пени исчезнут из списка задолженностей, как только ФНС России обработает ваш платеж.<br>Обычно это занимает до 10 рабочих дней.":240<h&&(c='Если вы все еще видите оплаченные налоги и пени в списке задолженностей, обратитесь за разъяснением в <a href="https://nalog.ru" target="_blank">Федеральную налоговую службу</a> '),y.resolve({message:c}));break;default:y.resolve()}return y.promise}}}]).factory("Restrictions",["$http","$rootScope","$q",function(e,t,r){return{getRestrictionsInfo:function(){return e({url:t.fsspApiUrl+"restrictions/informer",method:"GET",withCredentials:!0,cache:!1,params:{_:Math.random()}})}}}]).factory("NsiDictionary",["$rootScope","$http",function(t,r){return{checkNonElectronic:function(){return r({url:t.nsiApi+"no-quittance/register/receivers/available",method:"GET",withCredentials:!0})},getCategories:function(){return r({url:t.nsiApi+"dictionary/Reestr_kategorii",method:"POST",withCredentials:!0,data:{treeFiltering:"ONELEVEL",pageNum:1,selectAttributes:["*"],tx:"EPGU"}})},getServices:function(e){return r({url:t.nsiApi+"no-quittance/register/services",method:"GET",withCredentials:!0,params:{categoryId:e.categoryId,pageNum:e.pageNum||1,pageSize:e.pageSize||258,title:e.searchText||"",ogrn:e.receiverOGRN||""}})},getReceivers:function(e){return r({url:t.nsiApi+"no-quittance/register/receivers",method:"GET",withCredentials:!0,params:{categoryId:e.categoryId,pageNum:e.pageNum||1,pageSize:e.pageSize||258,shortOrgName:e.searchText||"",codeService:e.serviceCode||""}})},getReceiversNSI:function(e){return r({url:t.nsiApi+"dictionary/Reestr_uslugorg",method:"POST",withCredentials:!0,data:{treeFiltering:"ONELEVEL",pageNum:1,pageSize:10,parentRefItemValue:"",selectAttributes:["*"],filter:e,tx:"EPGU"}})}}}]).factory("checkSumIUN",[function(){return function(e){for(var t,r,n={"А":1,"Б":2,"В":3,"Г":4,"Д":5,"Е":6,"Ж":7,"З":8,"И":9,"К":10,"Л":11,"М":12,"Н":13,"О":14,"П":15,"Р":16,"С":17,"Т":18,"У":19,"Ф":20,"Х":21,"Ц":22,"Ч":23,"Ш":24,"Щ":25,"Э":26,"Ю":27,"Я":28,"Ъ":33,"Ы":36,"Ь":42,A:1,B:3,E:6,K:10,M:12,H:13,O:14,P:16,C:17,T:18,Y:19,X:21,D:29,F:30,G:31,I:32,J:33,L:34,N:35,Q:36,R:37,S:38,U:39,V:40,W:41,Z:42},o=0;o<10;o++)n[o.toString()]=o;function i(e,t){for(var r=0,o=0;o<e.length-1;o++)r+=n[e[o]]%10*((o+t)%10+1);return r%11}return e=(e=e).split(""),t=Number(e[e.length-1]),(r=i(e,r=0))<10?r==t:(r=10==(r=i(e,2))?0:r)==t}}]).factory("NewLkSwitcher",["$rootScope","ToggleCookie",function(e,t){return{init:function(){"L"!==e.userType&&"B"!==e.userType&&t.eraseCookie("lkul"),-1!==location.pathname.indexOf("university/external")&&(window.location=e.lkUrl+location.pathname.substr(1))}}}]).factory("NewPaySwitcher",["$rootScope","ToggleCookie","$httpParamSerializer","$location","$window",function(s,e,l,c,a){var t=["paymentCtrl","landingPaymentAuthCtrl","landingPaymentCtrl","paymentWithRequisites","gibddSearchCtrl","gibddResultCtrl","fnsSearchCtrl","fnsResultCtrl","fsspSearchCtrl","fsspResultCtrl"];return{payControllers:t,isPaymentController:function(e){return t.includes(e)},redirectToNewPay:function(e,t,r,o){var n,i="";if(["landingPaymentAuthCtrl","landingPaymentCtrl"].includes(e)){if(i=s.betaUrl,r&&r.tab)switch(r.tab){case"toPay":i+="pay",r.categories&&(i+="?categories="+r.categories);break;case"quittance":i+="pay/quittance",r.uin&&(i+="?uin="+r.uin);break;case"withoutQuittance":i+="pay/withoutQuittance?"+l({categoryId:r.categoryID,serviceId:r.serviceID,organizationId:r.organizationID});break;case"paymentHistory":i+="pay?tab=payments"}else i+="pay";location.replace(i)}if(["gibddSearchCtrl","gibddResultCtrl"].includes(e)&&location.replace(s.betaUrl+"pay?categories=fine"),["fnsSearchCtrl","fnsResultCtrl"].includes(e)&&location.replace(s.betaUrl+"pay?categories=fns"),["fsspSearchCtrl","fsspResultCtrl"].includes(e)&&location.replace(s.betaUrl+"pay?categories=fssp"),"paymentCtrl"===e){if("true"===r.isGkh)return;"multiPay"===t.bill?i+="?billIds="+JSON.parse(sessionStorage.getItem("multipay")).ids:(n=Object.assign({},r,{details:void 0,bill:void 0}),n=l(n),i+=(r.details?"?billIds=":"?billNumber=")+t.bill+(n?"&"+n:"")),o.preventDefault(),a.location.href=s.paymentUrl+i}"paymentWithRequisites"===e&&(i=s.paymentUrl+"/requisites?"+l(r),location.replace(i))},initPaymentNew:function(e,t,r,o,n,i){var a=s.paymentUrl;a+=(t?"?billIds=":"?billNumber=")+e,i&&i.orderId&&(a+="&"+l({returnUrl:n,senderTypeCode:"ORDER",epgu_id:i.orderId})),i&&i.isGkh?c.url("/payment/"+e).search("details","1").search("isGkh","true"):location.href=a}}}]).factory("NewPartnersSwitcher",["$rootScope","ToggleCookie","CMSService",function(t,e,r){var o="old-partners-banner";function n(){r.getTargetPlaces(o,!0).then(function(e){t[o]=e[o].list}),t.onSwitchClose=function(){e.createCookie(o,1),t.partnersSwitchEnabled=!1},t.showPartnersSwitchBanner=function(){return t.partnersSwitchEnabled&&"1"!==e.readCookie(o)},t.onBannerSwitch=function(){e.eraseCookie("old-partners"),e.createCookie("new-partners",1),e.eraseCookie(o),location.href=t.partnersUrl}}return{bannerActions:n,initBanners:function(){t.partnersSwitchEnabled&&"1"!==e.readCookie(o)&&!t[o]&&n()}}}]).factory("sopService",["$rootScope","$http",function(n,i,a){return{getData:function(e){var r=e.description,t={inversion:e.inversion,levenshtein:2,limit:{pageNumber:e.pageNumber,pageSize:e.pageSize},projection:{columnUids:[r.title.uid,r.value.uid],mode:"INCLUDE"},sort:{columnUid:r.title.uid,sortType:e.sort||"ASC"},sourceUid:e.source},o=(e.filter&&(t.filter={query:{columnUids:[r.title.uid],query:e.filter}}),a.defer());return i({method:"POST",url:n.sopUrl,withCredentials:!0,params:t,headers:n.sopAuthData}).then(function(e){var t=[];e&&e.data&&(t=e.data.map(function(e){return{value:e[r.title.column],title:e[r.title.column]}})),o.resolve({items:t,hasMore:!e.lastPage})},function(e){o.reject(e)}),o.promise}}}])}(),angular.module("epgu").factory("ProfileTabService",["$rootScope","$location","$http","FormServer","$filter","ngDialog","LkService","CMSService","$route","UserService","$routeParams","ToggleCookie","$q","$timeout","$moment","esiaTransportService","transportObjectService","$anchorScroll","$httpParamSerializer","paymentAuth","ConfigService","NewLkSwitcher",function(v,i,n,F,a,s,l,o,M,c,u,y,r,d,p,e,m,h,j,f,g,$){var t,b,w={},S=[],P={roleDisabled:!1,shortName:"Персональный профиль",personName:v.user.lastName+" "+v.user.firstName+" "+v.user.middleName,fullName:v.user.lastName+" "+v.user.firstName+" "+v.user.middleName,personRole:"Ваш персональный профиль",loginName:v.loginName,oid:v.user.userId,isPerson:!0,personType:"PERSON",onClickRole:function(e,t){e||(b=this,T(void 0,t))}},C=!1,E={};function T(r,o){v.loading=!0;var e=Math.random();n({method:"GET",withCredentials:!0,url:v.authProviderSwitchUrl+(r?"?orgId="+r+"&_="+e:"?_="+e)}).then(function(e){if(e&&"200"==e.status){e=y.readCookie("last_role_oid"+v.userId);if(b.isPerson||(y.createCookie("pre_last_role_oid"+v.userId,e,7),y.createCookie("last_role_oid"+v.userId,b.oid,7)),void 0===o||o)if(r||u.rUrl){var t="",e=(e=j(i.search()))?"?"+e:"";if(v.isLk)v.user={},v.loading=!0,v.profile=void 0,v.informerKnd=!1,v.menuShow=!1,v.loadingSwitchRoleFromLk=!0,c.load().then(function(){$.init(),M.reload(),d(function(){v.loading=!1,v.loadingSwitchRoleFromLk=!1},3e3),v.userId=v.user.userId,v.user.avatarLink=c.getAvatarImage(),f.informerFullClear(),u.rUrl?window.location=v.betaUrl+u.rUrl:(v.isLk&&(v.userCounters=0,l.getAllCounters().then(function(e){v.countersDisable||(v.userCounters=e)})),i.search("type",null),i.path(SmartPhone.isAny()&&SmartPhone.isPhone()?"/start":"/info"))});else{if(b.isPerson)t=-1===["/entrepreneur","/legal-entity","/"].indexOf(i.path())?i.path().substring(1):"";else{if(-1===["/","/entrepreneur","/legal-entity","/foreign-citizen"].indexOf(i.path()))t=i.path().substring(1);else switch(b.personType){case"BUSINESS":t="entrepreneur";break;case"LEGAL":t="legal-entity";break;default:t=""}y.createCookie("lkul","always")}window.location=v.betaUrl+t+e}}else y.eraseCookie("lkul"),window.location=v.lkUrl+"overview"}})}function k(e,t){return e&&e.length&&(e=e.find(function(e){return e.type===t}))?e.addressStr||e.value:""}function I(){for(var e=0;e<w.tabs.length;e++)w.tabs[e].active=!1}function A(e){return 30<e.length?e.substr(0,30)+"...":e}function D(){s.open({template:window.templatePath+"/tpl/lk/features/profile-popup-d110a30ee5.html",scope:v,className:"profile-popup"})}var R=l.getObjectTypes(),x=Object.values(l.getObjectTypes(!0));function _(e,t,r){return e.findIndex(function(e){return e[r]===t[r]})}function L(e,t,r,o){o?e[t[r]]=t:-1!==(o=_(e,t,r))?e[o]=t:e.unshift(t)}function G(e,t,r){r=_(e,t,r);-1!==r&&(e[r]=t)}function O(e,t,r,o){o?delete e[t[r]]:-1!==(o=_(e,t,r))&&e.splice(o,1)}function U(e){I(),this.active=!0,i.url(e)}function N(e,t){var r=[];if(e&&e.length){var o,n,i,a=[],s=[],l=[],c=[],u=[],d=[],p=[],m=y.readCookie("last_role_oid"+v.userId),h=y.readCookie("pre_last_role_oid"+v.userId);v.profile.roleCount=e.length;for(var f=0;f<e.length;f++){var g=e[f],g={roleDisabled:t?e[f].roleDisabled:!e[f].active,shortName:g.shortName||A(g.fullName),fullName:g.fullName,oid:g.oid,active:g.oid==v.user.orgOid,ogrn:g.ogrn,isChief:g.chief,isPerson:!1,personRole:g.oid==v.user.orgOid?v.user.orgPosition:"",personType:g.type||(13===g.ogrn.length?"LEGAL":15===g.ogrn.length?"BUSINESS":"AGENCY"),onClickRole:function(e){e||T((b=this).oid)}};g.active?o=g:P.active&&m&&m===g.oid.toString()?n=angular.copy(g):h&&h===g.oid.toString()?i=angular.copy(g):("BUSINESS"===g.personType?g.isChief?a:s:"LEGAL"===g.personType?g.isChief?l:c:"AGENCY"===g.personType?g.isChief?u:d:p).push(g)}!m&&o&&y.createCookie("last_role_oid"+v.userId,o.oid,7),v.openLkForEveryone?(o&&r.push(o),n&&n.oid&&!o&&r.unshift(n),i&&i.oid&&r.push(i),a&&a.length&&a.forEach(function(e){r.push(e)}),l&&l.length&&l.forEach(function(e){r.push(e)}),u&&u.length&&u.forEach(function(e){r.push(e)}),s&&s.length&&s.forEach(function(e){r.push(e)}),c&&c.length&&c.forEach(function(e){r.push(e)}),d&&d.length&&d.forEach(function(e){r.push(e)}),p&&p.length&&p.forEach(function(e){r.push(e)}),r.unshift(P)):o?r.push(o):r.unshift(P)}else r.unshift(P);return r}return{getLicenseInfo:function(e){var t="";return e.query&&(t=t+"?regNumberOrTaName="+encodeURIComponent(e.query)),n({method:"GET",withCredentials:!0,headers:{Authorization:"Bearer "+y.readCookie("acc_t")},url:v.siaWebHost+"/esia-rs/api/public/v1/orgs/"+e.orgOid+"/licenses"+t}).then(function(e){return e&&200===e.status?e.data:null}).catch(function(e){return null})},removeElectionsFromMobileMenu:function(){C=!0},getUserTabs:function(e){var t,r,o;v.orgType?(t={title:"Настройки",onClickTab:function(){U.call(this,"/notification-setup")},name:"notification-setup",mobOrder:3},r={title:"Сотрудники",onClickTab:function(){I(),this.active=!0,i.url("/employees")},name:"employees",mobOrder:2,subTitle:""},w.tabs=[{title:"Обзор",onClickTab:function(){U.call(this,"/info")},name:"info",mobOrder:2,subMenu:[{title:"Общая информация",url:"/org-info",isVisible:!0},{title:"Транспорт и вождение",url:"/car",isVisible:!v.user.branchOid&&v.profile.orgUserRight&&v.profile.orgUserRight.showBlocks},{title:"Электронная доверенность",url:"/org-delegated-rights",isVisible:!!v.user.authorityId}]},{title:"Уведомления",onClickTab:function(){U.call(this,"/notifications")},name:"notifications",mobOrder:1,subTitle:"Проверяйте статусы заявлений, платежей и другие уведомления по событиям на госуслугах"}],o=v.user&&v.user.groups&&v.user.groups.find(function(e){return"ESIA"==e.itSystem&&"ORG_ADMIN"==e.grp_id}),(v.user&&v.user.isOrgChief||o)&&(v.isMobile()?w.tabs[0].subMenu.push({title:"Контроль и надзор",url:"/inspect",isVisible:!v.user.branchOid&&v.profile.orgUserRight.showBlocks}):w.tabs.push({title:"Контроль и надзор",onClickTab:function(){I(),this.active=!0,i.url("/inspect")},name:"inspect",mobOrder:3,subTitle:"Проведите проверку организации на соответствие требований онлайн"})),v.user.empEpguRole!==g.orgRoles.admin.key&&v.user.empEpguRole!==g.orgRoles.chief.key||w.tabs.push(r),v.profile&&v.openNotifSetupBlockForOrg&&w.tabs.push(t)):(w.tabs=[{title:"Обзор",onClickTab:function(){U.call(this,"/info")},name:"info",mobOrder:2,subMenu:[{title:"Мои выборы",url:"/election",visibleLvl:["AL15","AL20"]},{title:"Мое здоровье",url:"/health"},{title:"Транспорт и вождение",url:"/car"},{title:"Семья и дети",url:"/family",visibleLvl:["AL20"]}]},{title:"Уведомления",onClickTab:function(){U.call(this,"/notifications")},name:"notifications",mobOrder:1,subTitle:"Проверяйте статусы заявлений, платежей и другие уведомления по событиям на госуслугах"},{title:"Документы",onClickTab:function(){U.call(this,"/docs")},name:"docs",mobOrder:3},{title:"Карты оплаты",onClickTab:function(){U.call(this,"/cards")},name:"cards",mobOrder:4},{title:"Настройки",onClickTab:function(){U.call(this,"/notification-setup")},name:"notification-setup",mobOrder:5}],C&&w.tabs[0].subMenu.shift()),I();for(var n=0;n<w.tabs.length;n++)if(e===w.tabs[n].name){w.tabs[n].active=!0;break}return w.tabs},getUserRoles:function(){var t=r.defer();return v.profile.roles=[],P.active=!v.orgType,v.isLk?S&&S.length?(S.shift(),v.profile.roles=S=N(S,!0),t.resolve(),t.promise):n({method:"GET",withCredentials:!0,headers:{Authorization:"Bearer "+y.readCookie("acc_t")},url:v.siaWebHost+"/esia-rs/api/public/v1/prns/"+v.user.userId+"/roles?embed=(elements-1)&pageIndex=1&pageSize=2000"}).then(function(e){e&&e.data?(v.isLk||v.profile||(v.profile={avatar:{"background-image":'url("'+v.user.userAvatarLink+'")'}}),e=e.data.elements||[],v.profile.roles=S=N(e,!1)):v.profile.roles=[].push(P),t.resolve()},function(e){v.profile.roles=[].push(P)}):(S&&S.length?(S.shift(),v.profile.roles=S=N(S,!0)):v.profile.roles=N(v.user.roles,!1),t.resolve(),t.promise)},getObjectTypes:function(){return R},isDocTypeLocallyEditable:function(e){return[R.MEDICAL_POLICY,R.DRIVING_LICENCE,R.FOREIGN_PASSPORT].includes(e)},getAutoOpenParamForDocumentType:function(e){switch(e){case R.MEDICAL_POLICY:return"medical-policy";case R.DRIVING_LICENCE:return"driving-licence";case R.FOREIGN_PASSPORT:return"foreign-passport";default:return null}},getDocsForReview:function(){var e=[R.FOREIGN_PASSPORT,R.DRIVING_LICENCE,R.BIRTH_CERTIFICATE,R.MILITARY_ID,R.MEDICAL_POLICY],e=(e.push("RUS"===v.user.personCitizenship?R.PASSPORT:R.FID_DOC),e.reduce(function(e,t){return e[t]=angular.copy((v.user.docs||[]).find(function(e){return e.type===t})),e},{}));return!e[R.SNILS]&&v.user.snils&&(e[R.SNILS]={type:R.SNILS,number:v.user.snils}),!e[R.INN]&&v.user.inn&&(e[R.INN]={type:R.INN,number:v.user.inn}),e[R.BIRTH_CERTIFICATE]||(e[R.BIRTH_CERTIFICATE]=(v.user.docs||[]).find(function(e){return[R.BIRTH_CERTIFICATE,R.BIRTH_CERTIFICATE_RF,R.BIRTH_CERTIFICATE_OLD,R.BIRTH_CERTIFICATE_FID].includes(e.type)})),e},initProfileCarsOperations:function(){var a=window.templatePath+(window.mobileVersion,"/tpl/lk/features/popup/profile-car-popup-251240f999.html");v.profile.addCarProps=m.get(),v.transport={addNewCar:function(e,t,r){e.preventDefault(),e.stopPropagation(),v.profile.popupEditCar={number:"",sts:"",name:""},v.profile.popupEditCar.isFieldInvalid=function(e){return e.$invalid},v.profile.popupObj={title:"Добавление транспортного средства",popupType:"editCar",mode:"add",callback:t,errorCallback:r},v.popupInclude=a,D()},editCar:function(e,t,r){v.profile.popupEditCar={},v.profile.popupObj={title:"Редактирование транспортного средства",popupType:"editCar",mode:"edit",callback:t,errorCallback:r},angular.copy(e,v.profile.popupEditCar),s.closeAll(),v.popupInclude=a,D()},deleteCar:function(e,t){return m.deleteTransport(e,t)},deleteAllCars:function(){return v.profile.popupObj={title:"Вы точно хотите удалить весь список транспортных средств?",popupType:"confirm",mode:"exclamation"},s.openConfirm({template:window.templatePath+"/tpl/lk/features/profile-popup-d110a30ee5.html",scope:v,className:"profile-popup"}).then(function(){return m.deleteAllTransports()},function(){return r.reject("canceled")})},importCars:function(){v.profile.popupObj={title:"Загрузка транспортных средств из файла",popupType:"importCar",customUrl:e.getImportUrl(),filesToSubmit:[],headers:{Authorization:"Bearer "+e.getToken()},launcher:function(){v.profile.popupObj.uploadInProgress=!0,v.$emit("uploader-launch")},hasFileErrors:function(){return 0===this.filesToSubmit.length||this.filesToSubmit.some(function(e){return e.error})}};var o=r.defer(),n=v.$on("uploader-success",function(e,t,r){v.profile.popupObj.uploadInProgress=!1,s.closeAll(),o.resolve(JSON.parse(t.response)),n()}),i=v.$on("uploader-error",function(e,t,r){v.profile.popupObj.uploadInProgress=!1,o.reject(t),i()});return v.popupInclude=a,D(),o.promise},isCarNumber:function(e){return m.isCarNumber(e)},isMotoNumber:function(e){return m.isMotoNumber(e)}}},getCarsForReview:function(){var e=[];if(this.initProfileCarsOperations(),v.user.cars&&v.user.cars.length){v.profile.totalVehicles=v.user.totalVehicles;for(var t=0;t<v.user.cars.length;t++){var r=v.user.cars[t];r.shortName=A(r.name),r.type=R.VEHICLE,e.push(r)}}return e.sort(function(e,t){return+t.id-+e.id})},getKidsForReview:function(){var e=[];if(v.user.kids&&v.user.kids.length)for(var t=0;t<v.user.kids.length;t++){var r=v.user.kids[t],o=(r.documents=r.documents||{},r.documents.docs=r.documents.docs||[],r[R.BIRTH_CERTIFICATE]=r.documents.docs.find(function(e){return[R.BIRTH_CERTIFICATE,R.BIRTH_CERTIFICATE_RF,R.BIRTH_CERTIFICATE_FID,R.BIRTH_CERTIFICATE_OLD].includes(e.type)}),r[R.MEDICAL_POLICY]=r.documents.docs.find(function(e){return e.type===R.MEDICAL_POLICY}),r.documents.docs.find(function(e){return e.type===R.INN})),n=r.documents.docs.find(function(e){return e.type===R.SNILS}),o=(r.inn&&!o&&r.documents.docs.push({type:R.INN,number:r.inn}),r.snils&&!n&&r.documents.docs.push({type:R.SNILS,number:r.snils}),r[R.BIRTH_CERTIFICATE]);o&&(o.profileInfo=o.series+" "+o.number+(o.issueDate?", "+o.issueDate:" ")+(o.issuedBy?", "+o.issuedBy:" ")),r.type=R.CHILD,e.push(r)}return e.sort(function(e,t){return+t.id-+e.id})},createEmptyDocStubs:function(){var e=[R.FOREIGN_PASSPORT,R.DRIVING_LICENCE,R.BIRTH_CERTIFICATE,R.MILITARY_ID,R.MEDICAL_POLICY];return e.push("RUS"===v.user.personCitizenship?R.PASSPORT:R.FID_DOC),e.reduce(function(e,t){return e[t]={type:t,isNewObjectStub:!0},e},{})},createEmptyCarStub:function(){return{type:R.VEHICLE,isNewObjectStub:!0}},createEmptyChildStub:function(){return{type:R.CHILD,isNewObjectStub:!0}},getMaximumCarCards:function(){return 6},redirectOnAddNewCar:function(e,t,r,o){if(e===this.getMaximumCarCards()&&e<t&&i.path().startsWith(r))return i.path(o)},putDocumentToContext:function(e){v.profile.docs=v.profile.docs||{},L(v.profile.docs,e,"type",!0),v.user.docs=v.user.docs||[],L(v.user.docs,e,"type"),e.type===R.DRIVING_LICENCE&&(v.user.vu=e),this.rebuildProfileContext()},putCarToContext:function(e){v.user.cars=v.user.cars||[],L(v.user.cars,e,"id"),v.user.totalVehicles++,v.profile.cars=v.profile.cars||[];var t=v.profile.cars.length;L(v.profile.cars,e,"id"),v.isLk&&(this.redirectOnAddNewCar(t,v.profile.cars.length,"/info","/info/transports"),this.rebuildProfileContext())},updateExistsCarInContext:function(e){v.profile.cars=v.profile.cars||[],G(v.profile.cars,e,"id"),v.user.cars=v.user.cars||[],G(v.user.cars,e,"id")},putChildToContext:function(e){v.profile.kids=v.profile.kids||[],L(v.profile.kids,e,"id"),v.user.kids=v.user.kids||[],L(v.user.kids,e,"id"),this.rebuildProfileContext()},removeDocumentFromContext:function(e){v.profile.docs=v.profile.docs||{},O(v.profile.docs,e,"type",!0),v.user.docs=v.user.docs||[],O(v.user.docs,e,"type"),e.type===R.DRIVING_LICENCE&&(v.user.vu=null),this.rebuildProfileContext()},removeCarFromContext:function(e){v.profile.cars=v.profile.cars||[],O(v.profile.cars,e,"id"),v.user.cars=v.user.cars||[],O(v.user.cars,e,"id"),this.rebuildProfileContext()},removeChildFromContext:function(e){v.profile.kids=v.profile.kids||[],O(v.profile.kids,e,"id"),v.user.kids=v.user.kids||[],O(v.user.kids,e,"id"),this.rebuildProfileContext()},rebuildProfileContext:function(){for(var e in v.profile.docs=this.getDocsForReview(),v.profile.docStubs=this.createEmptyDocStubs(),v.warningDocsCount=0,v.profile.docs)0!==this.isDocumentExpired(v.profile.docs[e]).expireStatus&&v.warningDocsCount++;v.profile.cars=this.getCarsForReview(),v.profile.carStub=this.createEmptyCarStub(),v.profile.kids=this.getKidsForReview(),v.profile.childStub=this.createEmptyChildStub()},getUserInformation:function(e,t){return n({method:"GET",url:v.lkApi+"users/",withCredentials:!0}).then(e,t)},isESIAEditableObjectType:function(e){switch(e){case R.MEDICAL_POLICY:case R.DRIVING_LICENCE:case R.FOREIGN_PASSPORT:case R.VEHICLE:case R.CHILD:return!1;default:return!0}},getESIADesktopType:function(e){return E[R.MEDICAL_POLICY]="oms",E[R.PASSPORT]="/edit?ident",E[R.FID_DOC]="/edit?ident",E[R.DRIVING_LICENCE]="drive",E[R.BIRTH_CERTIFICATE]="birth",E[R.MILITARY_ID]="military",E[R.FOREIGN_PASSPORT]="frpass",E[R.SNILS]="/edit?snils",E[R.INN]="inn",e&&E[e]||""},goToESIAEditDoc:function(e){var t="",r="",o=v.lcUrl,t=-1<(r=this.getESIADesktopType(e)).indexOf("?")?r+"&cid=EPGU&rurl="+i.absUrl():"?"+r+"&cid=EPGU&rurl="+i.absUrl();window.location.href=o+t},isDocumentExpired:function(e){var t="DD.MM.YYYY";if(e&&!e.isNewObjectStub&&e.type&&x.includes(e.type)&&[R.FOREIGN_PASSPORT,R.DRIVING_LICENCE,R.MEDICAL_POLICY,R.PASSPORT].includes(e.type)){var r=e.expiryDate?p(e.expiryDate,t):null,o=p().startOf("day");if(e.type===R.PASSPORT&&(t=p(v.user.birthDate,t),(n=o.diff(t,"years"))<20||p(t).add(20,"years").isSame(o)?r=p(t).add(20,"years"):(n<45||p(t).add(45,"years").isSame(o))&&(r=p(t).add(45,"years"))),r){var n=r.diff(o,"days");if(n<0)return{expireStatus:1,expireDays:n};var i=null;switch(e.type){case R.FOREIGN_PASSPORT:i=90;break;case R.DRIVING_LICENCE:i=14;break;case R.MEDICAL_POLICY:i=7;break;case R.PASSPORT:i=30}if(n<i)return{expireStatus:2,expireDays:n}}}return{expireStatus:0,expireDays:0}},setDescriptorExpiration:function(e,t){if(e&&!e.isNewObjectStub&&e.type&&x.includes(e.type)){var r=this.isDocumentExpired(e);if(0===r.expireStatus)t.informerStatus="good";else if(0<r.expireStatus){function o(e){var t=["день","дня","дней"];switch(e){case 0:return"сегодня";case 1:return"завтра";case-1:return"вчера";default:return 0<e?"через "+a("decline")(e,t):a("decline")(-e,t)+" назад"}}switch(t.linkText="Заявление на замену",e.type){case R.FOREIGN_PASSPORT:t.formLink="10005";break;case R.DRIVING_LICENCE:t.formLink="600125/1/form";break;case R.MEDICAL_POLICY:t.linkText="Получите новый полис ОМС",t.faqLink="https://www.gosuslugi.ru/help/faq/zdravoohranenie/2345";break;case R.PASSPORT:t.formLink="10052/1/form"}1===r.expireStatus?(t.informerStatus="error",t.expireWarning=(v.isPad()?"Истек ":"Документ истек ")+o(r.expireDays)):2===r.expireStatus&&(t.informerStatus="warning",t.expireWarning="Истекает "+o(r.expireDays))}}return t},getInstruments:function(){return n({method:"GET",url:v.lkApi+"paygate/beta/instruments",withCredentials:!0})},deleteInstrument:function(e){return n({method:"DELETE",url:v.lkApi+"paygate/beta/api/instrument/"+e,withCredentials:!0})},getCardsType:function(e){var t={visa:"visa",mc:"master",mir:"mir",maestro:"maestro"},r="";return r="string"==typeof e&&t[e=e.toLowerCase()]?t[e]:r},watchForInformer:function(){f.getInformerFull().then(function(e){var t=0,r=0;e&&e.data&&(e.data.fine?(e.data.fine.groups||[]).forEach(function(e){e.document&&["CAR_REG_CERTIFICATE","DRIVER_LICENSE"].includes(e.document.type)&&(r+=e.result.amount,t+=e.result.originalAmount||0)}):e.data.result&&e.data.result.fine&&(r=e.data.result.fine.amount,t=e.data.result.fine.originalAmount||0)),r&&v.profile?(v.profile.hasPenalties=!0,v.profile.defaultText="",v.profile.penalty=r,v.profile.penaltyButtonText=t&&r!==t?"Оплатить со скидкой":"Оплатить"):v.profile&&(v.profile.hasPenalties=!1,v.profile.defaultText="Штрафов не найдено"),v.profile&&(v.profile.hasResult=!0,v.profile.loading=!1)})},getBanners:function(e){return o.getTargetPlaces(e).then(function(t){var r=e.split(",");Object.keys(r).forEach(function(e){e=r[e];v.profile.banners[e]=t[e].list}),v.profile.closeBanner=function(e,t){o.removeTargetSlide(e),v.profile.banners["lk-info-banners"].splice(t,1)}})},checkIsLegalIsParty:function(){return n({method:"POST",withCredentials:!0,url:v.siaWebHost+"/esia-rs/api/public/v1/categories/orgs/"+v.user.orgOid+"/check",headers:{Authorization:"Bearer "+y.readCookie("acc_t")},data:{orgOid:v.user.orgOid,categoryIds:["33"]}})},getOrgBranchInfo:function(){return v.loading=!0,n({method:"GET",withCredentials:!0,url:v.lkApi+"users/branch"}).then(function(e){var t;if(e&&200===e.status)return{branchName:{title:"Название филиала",value:(t=e.data).name},kpp:{title:"КПП",value:t.kpp},postAddress:{title:"Почтовый адрес",value:k(t.addresses,"OPS")},email:{title:"Адрес электронной почты",value:k(t.contacts,"OEM"),verified:function(){var e=t.contacts.find(function(e){return"OEM"===e.type});if(e)return e.vrfStu}()},phone:{title:"Телефон",value:k(t.contacts,"OPH")},fax:{title:"Факс",value:k(t.contacts,"OFX")},staffCount:{title:"Количество сотрудников",value:t.staffCount},type:R.BRANCH_INFO}})},getOrgInfo:function(){return{ogrn:{title:"B"===v.orgType?"ОГРНИП":"ОГРН",showEmpty:!0,value:v.user.orgOGRN},inn:{title:"ИНН",showEmpty:!0,value:v.user.orgInn},kpp:{title:"КПП",showEmpty:!0,value:v.user.orgKpp},orgFullName:{title:"Полное название организации",showEmpty:!0,value:v.user.orgName},orgShortName:{title:"Сокращенное название организации",showEmpty:!0,value:v.user.orgShortName},legalAddr:{title:"Юридический адрес",value:k(v.user.addresses,"OLG")},opf:{title:"Организационно-правовая форма",value:v.user.leg},posAddr:{title:"Почтовый адрес",value:k(v.user.addresses,"OPS")},email:{title:"Адрес электронной почты",value:k(v.user.contacts,"OEM")},phone:{title:"Телефон",value:k(v.user.contacts,"OPH")},fax:{title:"Факс",value:k(v.user.contacts,"OFX")},type:R.ORGANIZATION_INFO}},getUserRight:function(){var e={};switch(window.empEpguRole=e.rightName=v.user.empEpguRole,v.user.authorityId&&(e.hasDelegatedRights="hasDelegatedRights"),e.rightName){case"":case"noRight":case g.orgRoles.draftAccess.key:e.showBlocks=!1,e.showButton=!1;break;case g.orgRoles.admin.key:e.showBlocks=!0,e.showButton=!1;break;case g.orgRoles.chief.key:e.showBlocks=!0,e.showButton=!0}return e},getDelegatedRights:function(){var e=r.defer();return v.orgType&&v.user.authorityId&&v.delegationEnabled||v.delegatedInformerEnabled?t?(e.resolve(t),e.promise):n({method:"GET",url:v.lkApi+"users/data/authority/"+v.user.authorityId,withCredentials:!0}).then(function(e){e=e.data;return t=e}):(e.resolve(),e.promise)},setUserActionURL:function(e,t,r,o,n,i){var a="",s=e.type;return e.isPortalUrl?a+=r+s:(a+=t+s+".xhtml",o&&(a=t+o+"/"+s,n)&&(a=t+o+"/branch/"+n+"/"+s)),a},getHumanityPosition:function(e){var t="Сотрудник организации";switch(e){case"chief":t="Руководитель организации";break;case"admin":case"admin&hasDelegatedRights":t="Администратор профиля организации";break;case"draftCreator":case"draftCreator&hasDelegatedRights":t="Создатель черновиков организации";break;case"admin&draftCreator":case"admin&draftCreator&hasDelegatedRights":t="Администратор профиля и создатель черновиков организации";break;case"":case"hasDelegatedRights":case"empty":t="Сотрудник организации"}return t},getUserActions:function(t,r,o,n,i){var a=this,e=this.getUserRight(),s=(s=e.rightName)||"noRights",l=[{title:"Добавление и редактирование сотрудников",type:"emps",access:["chief","admin","admin&draftAccess","admin&hasDelegatedRights","admin&draftAccess&hasDelegatedRights"],orgType:["L","B"],inBranches:!!i},{title:"Редактирование информации об организации",type:"info",access:["chief","admin","admin&draftAccess","admin&hasDelegatedRights","admin&draftAccess&hasDelegatedRights"],orgType:["L","B"]},{title:"Редактирование информации о филиале",type:"info",access:["chief","admin","admin&draftAccess","admin&hasDelegatedRights","admin&draftAccess&hasDelegatedRights"],orgType:["L"],inBranches:!0},{title:"Подача заявлений",type:"catalog",access:["chief","hasDelegatedRights","noRight&hasDelegatedRights","admin&hasDelegatedRights","draftAccess&hasDelegatedRights","admin&draftAccess&hasDelegatedRights"],orgType:["L","B"],isPortalUrl:!0,inBranches:!!i},{title:"Создание черновиков заявлений",type:"catalog",access:["admin","draftAccess","admin&draftAccess","draftAccess&hasDelegatedRights","admin&draftAccess&hasDelegatedRights"],orgType:["L","B"],isPortalUrl:!0,inBranches:!!i},{title:"Управление филиалами",type:"branches",access:["chief","admin","admin&draftAccess","admin&hasDelegatedRights","admin&draftAccess&hasDelegatedRights"],orgType:["L"],inBranches:!1},{title:"Доступ к контрольно-надзорной деятельности",type:v.kndUrl+"form",isPortalUrl:!0,access:["chief","admin","admin&draftAccess","admin&hasDelegatedRights","admin&draftAccess&hasDelegatedRights"],orgType:["L"],inBranches:!1},{title:"Доступ к контрольно-надзорной деятельности",type:v.kndUrl+"form",isPortalUrl:!0,access:["chief","admin","admin&draftAccess","admin&hasDelegatedRights","admin&draftAccess&hasDelegatedRights"],orgType:["B"],inBranches:!!i},{title:"Добавление сотрудников в группы доступа",type:"perms_grp",access:["chief","admin","admin&draftAccess","admin&hasDelegatedRights","admin&draftAccess&hasDelegatedRights"],orgType:["L","B"],inBranches:!!i},{title:"Делегирование полномочий сотрудникам организации",type:"perms_grp/delegation",access:v.delegationEnabled?["chief"]:[],orgType:["L"],inBranches:!!i},{title:"Создание сообщений в службу поддержки",type:"feedback",isPortalUrl:!0,orgType:["L","B"],access:["noRight","draftAccess","hasDelegatedRights","noRight&hasDelegatedRights","draftAccess&hasDelegatedRights"],inBranches:!!i}],c={permissionLevel:this.getHumanRole(s),result:[]};e.draftAccess&&(s+="&"+e.draftAccess),e.hasDelegatedRights&&(s+="&"+e.hasDelegatedRights);e=l.filter(function(e){return-1<e.access.indexOf(s)}).filter(function(e){return-1<e.orgType.indexOf(t)}).filter(function(e){return!!e.inBranches==!!i});c.result=e.map(function(e){return{title:e.title,href:a.setUserActionURL(e,r,o,n,i,s),type:e.type}});for(var u=0;u<c.result.length;u++)c.result[u]||c.result.splice(u,1);return c},getFormattedCardNumber:function(e){var t="";return t=e?"**** "+e.slice(-4):t},scrollToAnchorLink:function(e,t){e.preventDefault(),h(t),d(function(){h(t)},50)},createCardViewDescriptor:function(e,t){switch(e.type){case R.MEDICAL_POLICY:var r={viewingDetailsAllowed:!0,editingAllowed:!0,mobileFormHeightClass:"oms-form-height",empty:{title:"Добавьте полис ОМС",subTitle:"и пользуйтесь медицинскими сервисами, например, вызов врача и запись на прием"},full:{title:"Полис ОМС"},dropdown:[{title:"Номер",value:e.number||""}]};return e.expiryDate?r.dropdown.push({title:"Действителен до",value:e.expiryDate}):v.isMobile()&&r.dropdown.push({title:null,value:"Срок действия не ограничен"}),r;case R.PASSPORT:return{viewingDetailsAllowed:!0,editingAllowed:!0,empty:{title:"Добавьте паспорт",subTitle:"он необходим для получения большинства услуг на портале"},full:{title:"Паспорт РФ"},dropdown:[{title:"Серия и номер",value:e.isNewObjectStub?"":(e.series||"")+" "+(e.number||"")},{title:"Дата выдачи",showEmpty:!0,value:e.issueDate},{title:"Код подразделения",value:e.issueId},{title:"Кем выдан",value:e.issuedBy}]};case R.FID_DOC:return{viewingDetailsAllowed:!0,editingAllowed:!0,empty:{title:"Добавьте основной документ",subTitle:"он необходим для получения большинства услуг на портале"},full:{title:"Основной документ"},dropdown:[{title:"Серия и номер",value:e.isNewObjectStub?"":e.series+" "+e.number},{title:"Дата выдачи",showEmpty:!0,value:e.issueDate},{title:"Код подразделения",value:e.issueId},{title:"Кем выдан",value:e.issuedBy}]};case R.DRIVING_LICENCE:return{viewingDetailsAllowed:!0,editingAllowed:!0,mobileFormHeightClass:"driving-licence-height",empty:{title:"Добавьте водительское удостоверение",subTitle:"чтобы сразу получать уведомления о новых штрафах и оплачивать их со скидкой"},full:{title:"Водительское удостоверение"},dropdown:[{title:"Серия и номер",showEmpty:!0,value:e.isNewObjectStub?"":e.series+" "+e.number},{title:"Дата выдачи",value:e.issueDate},{title:"Действителен до",showEmpty:!0,value:e.expiryDate}]};case R.BIRTH_CERTIFICATE_RF:case R.BIRTH_CERTIFICATE_OLD:case R.BIRTH_CERTIFICATE_FID:case R.BIRTH_CERTIFICATE:return{viewingDetailsAllowed:!0,editingAllowed:!0,empty:{title:"Добавьте свидетельство о рождении",subTitle:"и документ будет всегда под рукой в этом разделе"},full:{title:"Свидетельство о рождении"},dropdown:[{title:"Серия и номер",showEmpty:!0,value:e.isNewObjectStub?"":e.series+" "+e.number},{title:"Дата выдачи",showEmpty:!0,value:e.issueDate},{title:"Действителен до",value:e.expiryDate},{title:"Место государственной регистрации",value:e.issuedBy}]};case R.MILITARY_ID:return{viewingDetailsAllowed:!0,editingAllowed:!0,empty:{title:"Добавьте военный билет",subTitle:"чтобы заполнять меньше форм при получении некоторых услуг"},full:{title:"Военный билет"},dropdown:[{title:"Серия и номер",showEmpty:!0,value:e.isNewObjectStub?"":e.series+" "+e.number},{title:"Дата выдачи",value:e.issueDate},{title:"Выдан военным комиссариатом",showEmpty:!0,value:e.issuedBy}]};case R.FOREIGN_PASSPORT:return{viewingDetailsAllowed:!0,editingAllowed:!0,mobileFormHeightClass:"foreign-passport-height",empty:{title:"Добавьте заграничный паспорт",subTitle:"и эти данные будут автоматически подставляться в поля при получении услуг"},full:{title:"Заграничный паспорт"},dropdown:[{title:"Серия и номер",showEmpty:!0,value:e.isNewObjectStub?"":e.series+" "+e.number},{title:"Дата выдачи",value:e.issueDate},{title:"Действителен до",showEmpty:!0,value:e.expiryDate},{title:"Место государственной регистрации",value:e.issuedBy}]};case R.SNILS:return{viewingDetailsAllowed:!1,editingAllowed:!1,empty:{title:"Добавьте СНИЛС",subTitle:"он необходим для некоторых услуг и может использоваться для авторизации"},full:{title:"СНИЛС"},dropdown:[{title:"Номер",showEmpty:!0,value:e.number}]};case R.INN:return{viewingDetailsAllowed:!1,editingAllowed:!1,empty:{title:"Добавьте ИНН",subTitle:"чтобы получить полный доступ к услугам по налогам и финансам"},full:{title:"ИНН"},dropdown:[{title:"Номер",showEmpty:!0,value:e.number}]};case R.VEHICLE:return{viewingDetailsAllowed:!0,editingAllowed:!0,mobileFormHeightClass:"vehicle-form-height",empty:{title:"Добавить транспортное средство",subTitle:"чтобы сразу получить уведомления о новых штрафах"},full:{title:e.name},dropdown:[{title:"Госномер",showEmpty:!0,value:e.number},{title:"СТС",showEmpty:!0,value:e.stsSeries+" "+e.stsNumber}]};case R.CHILD:r=e.lastName+" "+e.firstName;return{viewingDetailsAllowed:!0,editingAllowed:!0,mobileFormHeightClass:"child-form-height",empty:{title:"Добавить ребенка",subTitle:"чтобы получать услуги, связанные с детьми"},full:{title:35<r.length?r.substring(0,35)+"...":r},dropdown:[{title:"Дата рождения",showEmpty:!0,value:e.birthDate},{title:"Пол",showEmpty:!0,value:"M"===e.gender?"Мальчик":"Девочка"},{title:"Свидетельство о рождении",showEmpty:!0,value:e[R.BIRTH_CERTIFICATE]&&e[R.BIRTH_CERTIFICATE].profileInfo},{title:"Полис ОМС",value:e[R.MEDICAL_POLICY]?(e[R.MEDICAL_POLICY].number||"-")+(e[R.MEDICAL_POLICY].expDate?", истекает: "+e[R.MEDICAL_POLICY].expDate:""):"-"},{title:"СНИЛС",value:e.snils||"-"},{title:"ИНН",value:e.inn||"-"}]};case R.ORGANIZATION_INFO:r=Object.assign({},e);return delete r.type,{viewingDetailsAllowed:!0,editingAllowed:!0,mobileDetailsHeightClass:"organization-view-height",full:{title:"Основная информация"},dropdown:Object.values(r)};case R.BRANCH_INFO:r=Object.assign({},e);return delete r.type,{viewingDetailsAllowed:!0,editingAllowed:!0,mobileDetailsHeightClass:"branch-view-height",full:{title:"Информация о филиале"},dropdown:Object.values(r)};default:return{empty:{},full:{},dropdown:[],viewingDetailsAllowed:!1,editingAllowed:!1}}},createDocumentViewDescriptor:function(e){switch(e.type){case R.PASSPORT:return{title:"Паспорт гражданина Российской Федерации",rows:[{cells:[{label:"Серия и номер",value:e.series+" "+e.number,colSize:3},{label:"Дата выдачи",value:e.issueDate,colSize:3},{label:"Код подразделения",value:e.issueId,colSize:4}]},{cells:[{label:"Кем выдан",value:e.issuedBy,colSize:15}]}]};case R.FID_DOC:return{title:"Основной документ",rows:[{cells:[{label:"Серия и номер",value:e.series+" "+e.number,colSize:3},{label:"Дата выдачи",value:e.issueDate,colSize:3},{label:"Код подразделения",value:e.issueId,colSize:4}]},{cells:[{label:"Кем выдан",value:e.issuedBy,colSize:15}]}]};case R.BIRTH_CERTIFICATE_RF:case R.BIRTH_CERTIFICATE_OLD:case R.BIRTH_CERTIFICATE_FID:case R.BIRTH_CERTIFICATE:return{title:"Свидетельство о рождении",rows:[{cells:[{label:"Серия и номер",value:e.series+" "+e.number,colSize:3},{label:"Дата выдачи",value:e.issueDate,colSize:3},{label:"Действителен до",value:e.expirydDate,colSize:4}]},{cells:[{label:"Место государственной регистрации",value:e.issuedBy,colSize:15}]}]};case R.MILITARY_ID:return{title:"Военный билет",rows:[{cells:[{label:"Серия",value:e.series,colSize:3},{label:"Номер",value:e.number,colSize:3},{label:"Дата выдачи",value:e.issueDate,colSize:4}]},{cells:[{label:"Выдан военным комиссариатом",value:e.issuedBy,colSize:15}]}]}}return E[e.type]||null},getEmpRole:function(e){var t=g.orgRoles.noRight,r=!!e.elements.find(function(e){return"PGU.ORG_CAB.ACCESS"===e.grp_id}),e=!!e.elements.find(function(e){return"ORG_ADMIN"===e.grp_id&&"ESIA"===e.itSystem});return r&&(t=g.orgRoles.draftAccess),t=e?g.orgRoles.admin:t},getHumanRole:function(e){var t;switch(e){case g.orgRoles.chief.key:t=g.orgRoles.chief.value;break;case g.orgRoles.admin.key:t=g.orgRoles.admin.value;break;case g.orgRoles.draftAccess.key:t=g.orgRoles.draftAccess.value;break;default:g.orgRoles.noRight.key;t=g.orgRoles.noRight.value}return t}}}]),function(){"use strict";angular.module("epgu").factory("FiasAddresses",["$rootScope",function(e){var t=[{level:1,levelName:"region",label:"Регион",abbr:"обл",validators:[],maxlength:50},{level:3,levelName:"area",label:"Район",abbr:"р-н",validators:[],maxlength:100},{level:4,levelName:"city",label:"Город",abbr:"г",validators:[],maxlength:150},{level:5,levelName:"cityArea",label:"Внутригородской район",abbr:"окр",supportCheck:!1,subscribe:["city"],validators:[],maxlength:150},{level:6,levelName:"place",label:"Населенный пункт",abbr:"п",subscribe:["city"],validators:[],maxlength:150},{level:7,levelName:"street",label:"Улица",abbr:"ул",validators:[],maxlength:100},{level:90,levelName:"additionalArea",label:"Доп. территория",abbr:"доп. р-н",validators:[]},{level:91,levelName:"additionalStreet",label:"Улица на доп. территории",abbr:"доп. ул",validators:[]}],r=[{level:11,levelName:"house",label:"Дом",abbr:"д",supportCheck:!0,checked:!1,validators:["required"],maxlength:10},{level:12,levelName:"building1",label:"Корпус",abbr:"корп",subscribe:["house"],validators:[],maxlength:10},{level:13,levelName:"building2",label:"Строение",abbr:"стр",validators:[],maxlength:10},{level:14,levelName:"apartment",label:"Квартира",abbr:"кв",validators:["required"],maxlength:10},{level:100,levelName:"post_index",label:"Индекс",abbr:"",validators:["required"],maxlength:6}],o=[].concat(t).concat(r);return{getByLevel:function(e){for(var t=0;t<o.length;t++)if(o[t].level==e)return o[t]},getAll:function(){return o},getMain:function(){return t},getHouse:function(){return r}}}])}(),function(){"use strict";angular.module("epgu").factory("DisclaimerService",["$rootScope","$http","OkatoService","$q",function(r,n,e,t){function o(e){if(e.messages)for(var t in e.messages)if("ru"==e.messages[t].language.toLowerCase())return e.messages[t].message;return""}function i(e){c.priorityDisclaimersCount=c.mainDisclaimersPriorityCount,e&&e.length&&(r.disclaimers.additional&&(r.disclaimers.additional=[]),angular.forEach(e,function(e){var t;~e.mnemonic.indexOf("DESKTOP")&&SmartPhone.isAny()||~e.mnemonic.indexOf("MOBILE")&&!SmartPhone.isAny()||(t={id:e.id,level:e.level.toLowerCase(),text:o(e),notificationEnabled:e.notificationEnabled,mnemonic:e.mnemonic,isPriority:e.isPriority,isHidden:e.isHidden},r.disclaimers.additional.push(t),r.disclaimers[e.mnemonic]||(r.disclaimers[e.mnemonic]=[]),(r.disclaimers[e.mnemonic][e.id]=t).isPriority&&(c.priorityDisclaimersCount++,r.$broadcast("addedPriorityDisclaimers")))}))}var a=r.cmsUrl+"disclaimers/",s=r.cmsUrlV2+"disclaimers/",l=Math.random(),c={mainDisclaimersPriorityCount:0,priorityDisclaimersCount:0},u=n.get(a+"epgu",{cache:!1,params:{region:e.getFederalNum(),_:l},withCredentials:!0}),e=n.get(a+"page",{cache:!1,params:{region:e.getFederalNum(),page:"main_v1",_:l},withCredentials:!0});t.all([e,u]).then(function(e){var t;e&&e.length&&(t=[],e.forEach(function(e){e&&e.data&&e.data.length&&(t=t.concat(e.data))}),t.forEach(function(e){~e.mnemonic.indexOf("DESKTOP")&&SmartPhone.isAny()||~e.mnemonic.indexOf("MOBILE")&&!SmartPhone.isAny()||(r.disclaimers.main||(r.disclaimers.main=[]),r.disclaimers.main.push({id:e.id,level:e.level.toLowerCase(),text:o(e),notificationEnabled:e.notificationEnabled,mnemonic:e.mnemonic,isPriority:e.isPriority,isHidden:e.isHidden}),e.isPriority&&c.mainDisclaimersPriorityCount++)}))});return{counts:c,passportDisclaimer:function(e,t){n.get(a+"structure/"+e+"/passport/"+t,{cache:!1,params:{_:l},withCredentials:!0}).success(i)},serviceDisclaimer:function(e,t){n.get(a+"passport/"+e+"/"+t,{cache:!1,params:{_:l},withCredentials:!0}).success(i)},serviceDisclaimerApi:function(e,t,r,o){n.get(a+"structure/"+e+"/passport/"+t+"/target/"+r,{cache:!1,params:{bookingMnemonic:o,_:l},withCredentials:!0}).success(i)},paymentDisclaimer:function(){n.get(a+"ipsh",{cache:!1,params:{_:l},withCredentials:!0}).success(i)},structureDisclaimer:function(e){n.get(a+"structure/"+e,{cache:!1,params:{_:l},withCredentials:!0}).success(i)},gepsDisclaimer:function(){n.get(a+"geps/",{cache:!1,params:{_:l},withCredentials:!0}).success(i)},checkSubscriptionDisclaimer:function(e){return n({method:"GET",url:r.notificationApiUrl+"subscribe/disclaimer/"+e,cache:!1,params:{_:l,email:r.user.email},withCredentials:!0})},sendSubscriptionDisclaimer:function(e){return n({method:"POST",url:r.notificationApiUrl+"subscribe/disclaimer/",data:e,withCredentials:!0})},fosDisclaimer:function(){n.get(a+"fos",{cache:!1,params:{_:l},withCredentials:!0}).success(i)},landingPayDisclaimer:function(){n.get(a+"pay",{cache:!1,params:{_:l},withCredentials:!0}).success(i)},lkNotificationSetup:function(e){n.get(s+e,{cache:!1,params:{_:l}}).success(i)}}}])}(),function(){"use strict";angular.module("epguUser",[]).factory("UserService",["$rootScope","$http","$moment","ipCookie","$q","ToggleCookie","$timeout",function(i,o,n,a,s,l,c){return{setData:function(e,t){if(i.disableMetric||i.isLk||(o=a("mrid"))&&o==e.secId||(metricReachGoal("authorization"),a("mrid",e.secId)),t)for(var r in t)e[r]=t[r];i.logined=!0,i.orgType=e.orgType,i.assuranceLevel=e.assuranceLevel,i.assuranceLevelHint={AL30:"Подтвержденная учетная запись",AL20:"Подтвержденная учетная запись",AL15:"Стандартная учетная запись",AL10:"Упрощенная учетная запись"}[i.assuranceLevel],i.globalRole=e.globalRole,i.formattedLoginName=e.formattedLoginName,i.isFullAccess=e.isAssuranceLevelCorrect,i.userType=e.orgType||("P"===e.userType&&"F"===e.personType?"F":e.userType),i.loginName=e.lastName+" "+e.firstName.substring(0,1)+".",e.middleName&&(i.loginName+=e.middleName.substring(0,1)+"."),i.user.assuranceLevel=e.assuranceLevel||"",i.user.al=e.assuranceLevel?parseInt(e.assuranceLevel.replace(/[^\d]/g,"")):0,i.user.userId=e.userId||"0",i.user.firstName=e.firstName||"",i.user.lastName=e.lastName||"",i.user.middleName=e.middleName||"";var o=i.user.lastName+" "+i.user.firstName.charAt(0)+".";i.user.middleName&&(o=o+i.user.middleName.charAt(0)+"."),i.user.fullName=o,i.user.birthDate=e.birthDate?n(e.birthDate,"DD-MM-YYYY HH:mm:SS").format("DD.MM.YYYY"):"",i.user.email=e.email||"",i.user.orgOid=e.orgOid||"",i.user.informerUId=i.user.orgOid||i.user.userId,i.user.emailVerified=e.emailVerified||!1,i.user.empEpguRole=window.empEpguRole=e.empEpguRole||"",i.user.mobilePhone=e.mobile||"",i.user.mobilePhoneVerified=e.mobileVerified||!1,i.user.homePhone=e.phone||"",i.user.formattedName=e.formattedName||e.formattedLoginName,i.user.homePhoneVerified=e.phoneVerified||!1,i.user.citizenship=e.citizenship||"",i.user.personCitizenship=e.personCitizenship||"RUS",i.user.inn=e.personINN||(e.person&&e.person.person&&e.person.person.inn?e.person.person.inn:""),i.user.authorityId=e.authorityId||"",i.user.orgInn=e.orgINN||"",i.user.orgKpp=e.orgKPP||"",i.user.snils=e.personSNILS||"",i.user.orgOGRN=e.orgOGRN||"",i.user.personEMail=e.personEMail||"",i.user.corporateContact=e.corporateContact||"",i.user.corporateContactVerified="true"===e.corporateContactVerified,i.user.orgName=e.orgName||"",i.user.orgShortName=e.orgShortName||"",i.user.branchOid=e.branchOid||"",i.user.avatarLink=i.orgType?"L"===i.orgType?i.defaultAvatarImageLegal:i.defaultAvatarImageBusiness:i.defaultAvatarImage,i.user.systemAuthority=e.systemAuthority||"",i.user.passport={series:e.PASSPORT?e.PASSPORT.series:"",number:e.PASSPORT?e.PASSPORT.number:"",date:e.PASSPORT?e.PASSPORT.issueDate:""},i.user.isBiometry=e.person.person.biomStu,e.person&&(e.person.organizations&&e.person.organizations.elements&&e.person.organizations.elements.length&&(i.user.rolesCount=e.person.organizations.elements.length+1,i.user.elements=e.person.organizations.elements),e.person&&e.person.docs&&e.person.docs.length&&(i.user.docs=e.person.docs),e.person&&e.person.person.avatarLink&&(i.user.userAvatarLink=e.person.person.avatarLink+"?_="+Math.random(),i.user.avatarLink=i.user.userAvatarLink),e.person&&e.person.kids&&e.person.kids.length&&(i.user.kids=e.person.kids),e.person&&e.person.person&&e.orgType&&(i.user.isOrgChief=e.person.person.chief,i.user.orgPosition=e.person.person.position,i.user.realOrgType="LEGAL"===e.person.org.type?"L":"AGENCY"===e.person.org.type?"A":"B",i.user.branchesCount=e.person.org.branchesCount,i.user.staffCount=e.person.org.staffCount,i.user.leg=e.person.org.leg),e.person&&e.person.groups&&e.person.groups.length&&e.orgType&&(i.user.groups=e.person.groups),e.person&&e.person.contacts&&e.person.contacts.length&&e.orgType&&(i.user.contacts=e.person.contacts),e.person&&e.person.roles&&e.person.roles.length&&(i.user.roles=e.person.roles),e.person.person)&&e.person.person.birthPlace&&(i.user.birthPlace=e.person.person.birthPlace),i.user.vu={id:e.VU?e.VU.id:void 0,type:e.VU?e.VU.type:void 0,issueDate:e.VU?e.VU.issueDate:void 0,expiryDate:e.VU?e.VU.expiryDate:void 0,expDate:e.VU?e.VU.expDate:void 0,series:e.VU?e.VU.series:"",number:e.VU?e.VU.number:"",date:e.VU?e.VU.issueDate:""},i.user.cars=[],e.CARS&&$.each(e.CARS,function(e,t){var r={number:t.numberPlate,sts:"",name:t.name,id:t.id};t.regCertificate&&(r.sts=t.regCertificate.series+t.regCertificate.number,r.stsSeries=t.regCertificate.series,r.stsNumber=t.regCertificate.number),i.user.cars.push(r)}),i.user.totalVehicles=e.person&&e.person.totalVehicles,i.user.gender=e.gender||"",i.user.liveAddress=e.liveAddress||"",i.user.registrationAddress=e.registrationAddress||"",i.user.addresses=e.addresses&&e.addresses.length?e.addresses:e.person&&e.person.addresses&&e.person.addresses.length?e.person.addresses:[]},load:function(){function e(){return o({method:"GET",url:i.lkApi+"users/data?_="+r,withCredentials:!0,cache:!1}).then(function(e){var t,r,o;e&&e.data?(i.originalUserData=JSON.parse(JSON.stringify(e.data)),e=e.data,n.setData(e,{PASSPORT:!!(e.person&&e.person.docs&&e.person.docs.length)&&(o=e.person.docs.filter(function(e){return"RF_PASSPORT"===e.type})[0],t=e.person.docs.filter(function(e){return"FID_DOC"===e.type})[0],r=e.person.docs.filter(function(e){return"FRGN_PASS"===e.type})[0],(o=o||t||r)?{series:o.series||"",number:o.number||"",issueDate:o.issueDate||""}:{}),VU:!!(e.person&&e.person.docs&&e.person.docs.length)&&((t=e.person.docs.filter(function(e){return"RF_DRIVING_LICENSE"===e.type})[0])?{id:t.id||"",type:t.type||"",issueDate:t.issueDate||"",expiryDate:t.expiryDate||"",expDate:t.expDate||"",series:t.series||"",number:t.number||"",date:t.date||""}:{}),CARS:e.person?e.person.vehicles:[],addresses:e.addresses?addresses:[]})):(i.$broadcast("error-authorized"),navigator.cookieEnabled&&void 0!==a("mailBanner")&&a("mailBanner","",{domain:i.cookieDomain,path:"/",expires:-1}))}).finally(function(e,t,r,o){i.userLoading=!1,i.$broadcast("user-loaded")})}var t,r,n=this;return i.userId||l.readCookie("sp_session")&&l.readCookie("mobVersionBusiness")?(r=Math.random(),l.readCookie("goToEsia")&&i.isLk&&+i.delayLkTimeInMs?(l.eraseCookie("goToEsia"),c(e,+i.delayLkTimeInMs)):e()):(i.userLoading=!1,i.$broadcast("error-authorized"),navigator.cookieEnabled&&void 0!==a("mailBanner")&&a("mailBanner","",{domain:i.cookieDomain,path:"/",expires:-1}),(t=s.defer()).resolve(),t.promise)},afterLoad:function(){var e=s.defer();return!i.userLoading&&i.userId?e.resolve():i.$on("user-loaded",function(){e.resolve()}),e.promise},getAvatarImage:function(){var e;return i.user.userAvatarLink&&"B"!==i.userType&&"L"!==i.userType?i.user.userAvatarLink:(e=i.userType+(i.user.gender||""),i.imgPath+"avatars/"+{PF:"default-avatar-f.svg",PM:"default-avatar-m.svg",FF:"default-avatar-f.svg",FM:"default-avatar-m.svg",BF:"default-avatar-ip.svg",BM:"default-avatar-ip.svg",L:"default-avatar-legal.svg",LM:"default-avatar-legal.svg",LF:"default-avatar-legal.svg"}[e])}}}])}(),function(){"use strict";angular.module("epgu").factory("MailService",["$http","$rootScope",function(o,n){function i(e){var t=e.text,r=e.subject,o=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>|<script[^>]*>|<\/script>/gi;e.text=t?t.replace(o,""):"",e.subject=r&&r.replace(o,"")}var a,s={"Content-Type":"application/json; charset=utf-8"},l={label:"in",limit:10,withCounts:!0};return{getMailsList:function(e,t,r){a=$.isEmptyObject(e)?"":"?"+$.param($.extend({},l,e)),o({method:"GET",withCredentials:!0,url:n.gepsApiUrl+"messages/byCategory"+a,headers:s}).success(function(e){e&&(e.messageList.map(i),t(e))}).error(function(e,t){"function"==typeof r&&r(e,t)})},getMailDetails:function(e,t,r){o({method:e,url:t,headers:s}).success(function(e,t){e&&(e.messages.map(i),r(e)),t&&204===t&&r(t)})},deleteMails:function(e,r){o({method:"DELETE",withCredentials:!0,url:n.gepsApiUrl+"messages/thread",data:e,headers:s}).success(function(e,t){t&&204===t&&r(t)})},restoreMails:function(e,r){o({method:"POST",withCredentials:!0,url:n.gepsApiUrl+"messages/thread/restore",data:e,headers:s}).success(function(e,t){t&&204===t&&r(t)})},searchMails:function(e,t){o({method:"GET",withCredentials:!0,url:n.gepsApiUrl+"messages/byCategory?searchQuery="+encodeURI(e.toString()),headers:s}).success(function(e){e&&t(e)})},deleteAttachment:function(e,t){o({method:"DELETE",withCredentials:!0,url:n.gepsApiUrl+"file/"+e,headers:s}).success(function(e){e&&t(e)})},saveMail:function(e,t){o({method:"PUT",withCredentials:!0,url:n.gepsApiUrl+"messages/draft",data:e,headers:s}).success(function(e){t(e)})},sendMail:function(e,t){o({method:"POST",withCredentials:!0,url:n.gepsApiUrl+"messages/"+e+"/send",headers:s}).success(function(e){t(e)})},mailsTabs:[{title:"Входящие",name:"in"},{title:"Отправленные",name:"out"},{title:"Черновики",name:"draft"},{title:"Удаленные",name:"deleted"}],mailsList:{},mailsListInfo:{emptyList:!1,totalCount:0,perPageCount:0,lastMessageId:0,lastMessageUpdateTime:0,searchMailsQuery:void 0},getExtension:function(e){e=e.fileName;if(e){var t=e.lastIndexOf("."),r=e.length;if(~t){e=e.substr(t+1,r-t-1);if(~["doc","jpeg","jpg","mp3","mp4","pdf","png","ppt","pptx","rtf","tif","tiff","txt","wav","xls","xlsx","zip"].indexOf(e))return"file-types-"+e}}return"file-types-any"}}}]).factory("MailDeliveryService",["$http","$rootScope","FiasAddresses","ToggleCookie","userTypeService","$moment","PerformanceService",function(a,s,c,i,l,u,d){function n(e,t,r){o.isChecked=r,o.status=t,o.data=e}function p(){return Math.random()}var m={"Content-Type":"application/json; charset=utf-8"},o={isChecked:!1,status:null,data:null};return{checkDeliveryStatus:function(r){a({method:"GET",withCredentials:!0,url:s.gepsApiUrl+"rp/json/agreement/status"+(s.userSelectedRegion?"?region="+s.userSelectedRegion:""),params:{_:p()},headers:m}).success(function(e,t){e&&(n(e,t,!0),r(e,t))}).error(function(e,t){n(e,t,!1),r(e,t)})},getDeliveryAddresses:function(t){a({method:"GET",withCredentials:!0,url:s.gepsApiUrl+"rp/json/addresses?silent=true",params:{_:p()},headers:m}).success(function(e){e&&null!==e&&t(e)}).error(function(e){t(e)})},setDeliveryAddresses:function(e,r){s.user&&s.user.mobilePhone,s.user&&s.user.email;a({method:"POST",withCredentials:!0,url:s.gepsApiUrl+"rp/json/addresses",data:{addresses:e},headers:m}).success(function(e,t){t&&r(t)}).error(function(e,t){r(t)})},setDeliveryAddressesNew:function(e,r){a({method:"POST",withCredentials:!0,url:s.gepsApiUrl+"rp/new",data:e,headers:m}).success(function(e,t){t&&r(t)}).error(function(e,t){r(t)})},getAgreementInfo:function(r){a({method:"GET",withCredentials:!0,url:s.gepsApiUrl+"rp/agreement/info",headers:m,params:{_:p()}}).success(function(e,t){e&&r(e)}).error(function(e,t){r(e,t)})},setDeliveryStatus:function(e,r){a({method:"POST",withCredentials:!0,url:s.gepsApiUrl+"rp/json/agreement",data:e,headers:m}).success(function(e,t){t&&r(t)}).error(function(e,t){r(t)})},makeFullAddressFromEsia:function(e,t,r){var o="";if("GEPS"===t){for(var n,i=c.getAll(),a={region:"region",area:"district",city:"city",place:"locality",street:"street",cityArea:"ownership",house:"house",building1:"housing",building2:"building",apartment:"apartment"},s=0;s<i.length;s++){var l=i[s];!e[a[l.levelName]]||"post_index"===l.levelName||"region"===l.levelName&&e.region===e.city||(o=(o+="house"!==l.levelName?", ":", д. ")+e[a[l.levelName]].trim())}(n=e.postalCode||e.post_index||e.zipCode)&&n.length&&(o=n+o)}else e.addressStr&&(o=e.addressStr.trim(),n=e.postalCode||e.post_index||e.zipCode)&&n.length&&(o=n+", "+o);return o},getCookieSession:function(){var e=("; "+document.cookie).split("; acc_t=");if(2==e.length)return e.pop().split(";").shift()},checkDeliveryBusinessStatus:function(r,e){var o="/api/lk/geps/subscription/v2/";d.measureStart(o),a({method:"GET",withCredentials:!0,url:s.gepsApiUrl+"subscription/v2?region="+s.userSelectedRegion,headers:m,params:{_:p(),withHidden:e}}).success(function(e,t){d.measureEnd(o,0,{userType:s.healthUserTypes[s.userType]}),e&&(n(e,t,!0),r(e,t))}).error(function(e,t){d.measureEnd(o,1,{userType:s.healthUserTypes[s.userType],BrowserError:e?.status}),r(e,t)})},setDeliveryBusinessAgreement:function(e,t,r,o){var n="/api/lk/geps/subscription/v2/"+t.code,i=(d.measureStart(n),"SUBSCRIBED"===t.status?"UNSUBSCRIBED":"SUBSCRIBED");t.status=i,a({method:e,withCredentials:!0,url:s.gepsApiUrl+"subscription/v2/"+t.code,data:t,headers:m}).success(function(e,t){d.measureEnd(n,0,{userType:s.healthUserTypes[s.userType]}),t&&r(e,t)}).error(function(e,t){d.measureEnd(n,1,{userType:s.healthUserTypes[s.userType],BrowserError:e?.status}),o(t)})},setDeliveryAgreementForCopy:function(e,t,r,o,n){var i="/api/lk/geps/subscription/v2/"+t.code;d.measureStart(i),t.status=r?"SUBSCRIBED":"DENY_SUBSCRIPTION",a({method:e,withCredentials:!0,url:s.gepsApiUrl+"subscription/v2/"+t.code,data:t,headers:m}).success(function(e,t){d.measureEnd(i,0,{userType:s.healthUserTypes[s.userType]}),t&&(d.measureEnd(i,1,{userType:s.healthUserTypes[s.userType],BrowserError:e?.status}),o(e,t))}).error(function(e,t){n(t)})},setDeliveryGibddAgreement:function(e,t,r,o,n){var i="/api/lk/geps/subscription/v2/"+t.code;d.measureStart(i),t.status=r,a({method:e,withCredentials:!0,url:s.gepsApiUrl+"subscription/v2/"+t.code,data:t,headers:m}).success(function(e,t){d.measureEnd(i,0,{userType:s.healthUserTypes[s.userType]}),t&&o(e,t)}).error(function(e,t){d.measureEnd(i,1,{userType:$$rootScope.healthUserTypes[s.userType],BrowserError:e?.status}),n(t)})},markAsDelivered:function(){var e=i.readCookie("acc_t"),t=i.readCookie("marked_as_delivered");e!==t&&a({method:"PUT",withCredentials:!0,url:s.gepsApiUrl+"messages/markAsDelivered"}).then(function(){i.createCookie("marked_as_delivered",e,1)})},checkPopupAvailable:function(){var e=s.logined&&"F"!==s.userType,t=!s.webViewMode&&(s.isMainPage||s.isLk||window.location.pathname===l.getUserType().rootPath)&&!["/mail/delivery","/notification-setup"].includes(window.location.pathname),r=s.regionSelectOpened||s.npsQuizOpened||s.ezpRemind,o="P"===s.userType&&"true"===s.showGepsEzpPopup||"P"!==s.userType&&"true"===s.showEzpBusinessPopup,n=this.getCookieSession(),n="P"===s.userType&&n===i.readCookie("ezpRemind")||"P"!==s.userType&&n===i.readCookie("ezpRemindBusiness");return e&&t&&!r&&!n&&o},prepareSubscriptionList:function(e,t,r){var o,n,i;return e&&e.length&&(o="P"===s.userType?"PR":"EZP",(n=e.find(function(e){return e.code===o}))&&(e.splice(e.indexOf(n),1),e.push(n)),i=!1,t&&(n=u(t),i=u().isAfter(n)),n=e.filter(function(e){return!(!["NOT_SUBSCRIBED","REMIND_LATER"].includes(e.status)||"PR"===e.code&&!r)&&("NOT_SUBSCRIBED"===e.status||i)})),n||[]},updateMultiSubscriptionState:function(e,r,o){var t=s.gepsApiUrl+"subscription/v2",e=e.map(function(e){var t={code:e,status:r};return"SUBSCRIBED"===r&&"PR"===e&&o&&(t.data={addresses:[]},o.forEach(function(e){t.data.addresses.push({asString:e.asString||e.addressStr})})),t});return a({method:"POST",withCredentials:!0,url:t,data:{items:e},headers:m})},deliveryAddresses:[],deliveryStatusObj:o}}])}(),function(){"use strict";angular.module("epgu").factory("ElectionService",["$rootScope","$http","$moment",function(n,i,a){var s="DD.MM.YYYY",l="YYYY-MM-DD";function c(r,o,n,e){e.length&&e.forEach(function(e,t){o.elections=o.elections.concat(e.elections);e=r[n[t]];e.regOrderId&&(o.regOrderId=e.regOrderId),e.fedOrderId&&(o.fedOrderId=e.fedOrderId),r.splice(n[t],1)})}return{COMMON_DATE_FORMAT:s,NSI_DATE_FORMAT:l,urovProved:{1:{election:"Федеральный",referendum:"Федеральный"},2:{election:"Региональный",referendum:"Региональный"},3:{election:"Выборы в центре субъекта Российской Федерации",referendum:"Референдум в центре субъекта Российской Федерации"},4:{election:"Выборы в муниципальном районе, городском округе",referendum:"Референдум в муниципальном районе, городском округе"},5:{election:"Выборы в городских, сельских поселениях",referendum:"Референдум в городских, сельских поселениях"},6:{election:"Выборы в городских, сельских поселениях",referendum:"Референдум в городских, сельских поселениях"}},stepMap:{"election-info":"info","consignment-info":"election-info","candidate-info":"consignment-info","free-candidate-info":"election-info","uik-info":"info","uik-election-info":"uik-info","history-info":"info"},electionCodes:{success:{values:["100","110","120","121","122"],title:"Зарегистрирован",getTitle:function(e){return"2"===e?"Зарегистрирована":"Зарегистрирован"}},proposed:{values:["800","810","820"],title:"Выдвинут",getTitle:function(e){return"2"===e?"Выдвинута":"Выдвинут"}},nominate:{getTitle:function(e){return"2"===e?"Выдвинута":"Выдвинут"}},victory:{getTitle:function(e){return"2"===e?"Избрана":"Избран"}},notVictory:{getTitle:function(e){return"2"===e?"Не избрана":"Не избран"}},sudim:{getTitle:function(e){return"2"===e?"Не судима":"Не судим"}}},getUserUiks:function(){return i({method:"GET",url:n.lkApi2+"users/uiks",cache:!1,withCredentials:!0})},getCandidateElections:function(){return i({method:"GET",url:n.electionApiUrl+"election/candidateElections?_="+Math.random(),cache:!1,withCredentials:!0})},getUserTimeOffset:function(){return i({method:"GET",url:n.lkApi+"users/userDateOffset",cache:!1,withCredentials:!0})},getElectionPayments:function(e,t){return i({method:"GET",url:n.lkApi+"users/electionsReceipt/"+e+"/"+t,cache:!1,withCredentials:!0})},getElectionData:function(e){return i({method:"POST",url:n.nsiApi+"election/elections/?_="+Math.random(),cache:!1,data:e,withCredentials:!0})},getElectionFullInfo:function(e){var t=e.urlParams,e=e.body;return i({method:"GET",url:n.nsiApi+"election/electionInfo/"+t.electionId+"/"+t.electionType+"?_="+Math.random(),cache:!1,withCredentials:!0,params:{electionSystem:e.electionSystem,subjCode:e.subjCode,numUik:e.numUik}})},getReferendumFullInfo:function(e){return i({method:"GET",url:n.nsiApi+"election/referendum/"+e+"?_="+Math.random(),cache:!1,withCredentials:!0})},getElectionUnitPayments:function(e){return i({method:"GET",url:n.lkApi+"users/referendumReceipt/"+e+"?_="+Math.random(),cache:!1,withCredentials:!0})},getConsignmentInfo:function(e,t,r,o){return i({method:"GET",url:n.nsiApi+"election/candidatesByConsignment/"+e+"/"+t+"?_="+Math.random(),cache:!1,withCredentials:!0,params:{okrugNum:o,hasResults:r}})},getCandidateInfo:function(e){return i({method:"GET",url:n.nsiApi+"election/candidatesById/"+e+"?_="+Math.random(),cache:!1,withCredentials:!0})},getReferendumProtocol:function(e){return i({method:"GET",url:n.nsiApi+"election/referendum/questionProtocol/"+e+"?_="+Math.random(),cache:!1,withCredentials:!0})},getCommonProtocol:function(e,t){return i({method:"GET",url:n.nsiApi+"election/electionResultProtocols/"+e+"?_="+Math.random(),cache:!1,withCredentials:!0,params:{okrugNum:t}})},getUikInfo:function(e){return i({method:"GET",url:n.nsiApi+"election/uikByNum/"+e.uikNum+"/"+e.subjCode+"?_="+Math.random(),cache:!1,withCredentials:!0,params:{mainUikNum:e.mainUikNum,mainSubjCode:e.mainSubjCode}})},getNearestVotingData:function(){return i({method:"GET",url:n.lkApi2+"users/mobile/electionDate",cache:!1,withCredentials:!0})},filterElections:function(t,e,r){e.forEach(function(e){e.isOpen=!1}),r?(r=e.filter(function(e){return e.numUik===t.uikNumber}),t.selfCampaigns=[],t.selfReferendums=[],t.selfCampaigns=r.filter(function(e){return"1"===e.vidVibref||"2"===e.vidVibref}),t.selfReferendums=r.filter(function(e){return"0"===e.vidVibref})):(t.electionCampaigns=[],t.referendums=[],t.electionCampaigns=e.filter(function(e){return"1"===e.vidVibref||"2"===e.vidVibref}),t.referendums=e.filter(function(e){return"0"===e.vidVibref}))},concatElectionItemsByUikNumber:function(e,r){var o=[],t=e.filter(function(e,t){return e.id!==r.id&&e.uikNumber===r.uikNumber&&e.voteDate===r.voteDate&&(o.push(t),!0)});c(e,r,o,t)},concatElectionItemsByVoteDate:function(e,r){var o=[],t=e.filter(function(e,t){return e.id!==r.id&&e.voteDate===r.voteDate&&(o.push(t),!0)});c(e,r,o,t)},startEbsAuth:function(){return i({method:"GET",url:n.lkApi+"bio/verifications?rUrl="+btoa(n.lkUrl+"info"),cache:!1,withCredentials:!0})},saveVote:function(){return i({method:"GET",url:n.lkApi+"users/saveEbsVote",cache:!1,withCredentials:!0})},getEbsAuthResult:function(){return i({method:"GET",url:n.lkApi+"bio/result",cache:!1,withCredentials:!0})},getEvotingStatus:function(){return i({method:"GET",url:n.lkApi+"users/checkEbsVote",cache:!1,withCredentials:!0})},isDateInFuture:function(e,t){return 0===a(e,s).diff(t,"days")||a(e,s).isAfter(t,"day")},addElectionToGroup:function(e,t,r,o){var n=e[t.datGol];n?n.elections.push(t):(n={elections:[t],voteDate:a(t.datGol,s).format(l),showHomeVotingForm:!!r&&r.showHomeVotingForm&&["1","2"].includes(t.urovProved),homeVotingOrderId:r?r.homeVotingOrderId:null,ordersCount:0},r&&r.orderId&&0<r.orderId&&(n.ordersCount++,n.orderId=1===n.ordersCount?r.orderId:null)),n.homeVotingOrderId=n.homeVotingOrderId||!!r&&r.homeVotingOrderId,n.homeVotingEndDate=!!r&&r.homeVotingEndDate,n.isPastElection=n.isPastElection||o,e[t.datGol]=n}}}])}(),function(){"use strict";angular.module("epgu").factory("SmsConfirmService",["$rootScope","$http",function(r,o){var n=[2,0,1,1,1,2];return{getSmsCode:function(e){return o({method:"POST",url:r.lkApi+"orders/"+e+"/sms/confirm/send",withCredentials:!0})},checkSmsCode:function(e,t){return o({method:"GET",url:r.lkApi+"orders/"+e+"/sms/confirm/check?code="+t,withCredentials:!0})},getTitles:function(e,t,r){t=t[4<e%100&&e%100<20?2:n[e%10<5?e%10:5]];return r?e+" "+t:t},convertMillisecondsToHumanView:function(t){var r=this,o={},e=[{label:"msc",labels:["миллисекунда","миллисекунды","миллисекунд"],mod:1e3},{label:"sec",labels:["секунду","секунды","секунд"],mod:60},{label:"min",labels:["минуту","минуты","минут"],mod:60},{label:"hrs",labels:["час","часа","часов"],mod:24},{label:"day",labels:["день","дня","дней"],mod:31}];return e.forEach(function(e){t=(t-(o[e.label]=t%e.mod))/e.mod}),e.reverse().map(function(e){var t=e.label;if("msc"!==t&&o[t])return o[t]?r.getTitles(o[t],e.labels,!0):""}).join(" ").trim()}}}])}(),function(){"use strict";angular.module("epgu").factory("CatalogService",["$rootScope","$q","$http","userTypeService","RegionService","OkatoService",function(s,o,l,n,e,i){var a,c=Math.random(),u=s.isPageServiceEnabled;n.getCurrentUserType();return{getLandingData:function(e,t,r){return l({method:"GET",url:s.catalogApi+"situations/"+r.join("/"),withCredentials:!!u,cache:!1,params:{_:c,region:s.userSelectedRegion,isLanding:t}})},getSavedOtherOccasions:function(){return a},getRecommendedServices:function(){return l({method:"GET",url:window.templatePath+"/js/data/situations/recommendedServices.json",cache:!1})},getOkvedTesting:function(){return l({method:"GET",url:window.templatePath+"/js/data/situations/OKVED.json",cache:!1})},getMainOccasions:function(e,t){var r=s.filterGosBarValue||n.getUserType();return l({method:"GET",url:s.catalogApi+"situations/category",withCredentials:!0,cache:!1,params:{_:c,personTypes:r.occasionType,region:i.getFederalNum()}}).then(function(e){return a=e},function(e){return e})},getOtherOccasions:function(e,t){e=e+"_"+t;return l({method:"GET",url:u?s.catalogApi+"situations/":window.templatePath+"/js/data/occasion.json",withCredentials:!!u,cache:!0,params:{_:c,type:e||"",region:i.getFederalNum()}}).then(function(e){return a=e})},getPopularOccasions:function(e){return l({method:"GET",url:s.catalogApi+"situations/main",withCredentials:!0,params:{_:c,personTypes:e||"",region:i.getFederalNum()}}).then(function(e){return a=e})},getRootCategories:function(){var e=s.filterGosBarValue||n.getUserType();return l({method:"GET",url:s.catalogApi+"categories/",withCredentials:!0,cache:!1,params:{_:c,region:s.userSelectedRegion,platform:window.platform,userType:e.catalogType}})},getPartnersData:function(e){return l({method:"GET",url:s.cmsUrl+"partners/products/"+e,withCredentials:!0,cache:!1,params:{_:c,region:s.userSelectedRegion}})},getCategory:function(e){return l({method:"GET",url:s.catalogApi+"categories/"+e,withCredentials:!0,cache:!0,params:{_:c,region:i.getFederalNum(),platform:window.platform}})},getPassport:function(e){return l({method:"GET",url:s.catalogApi+"passports/"+e,withCredentials:!0,cache:!0,params:{_:c,region:s.userSelectedRegion,platform:window.platform}})},getCategoriesByRegion:function(e){return l({method:"GET",url:s.catalogApi+"passports/region/categories/"+e,withCredentials:!0,cache:!0,params:{_:c,region:s.userSelectedRegion,platform:window.platform}})},getService:function(e,t,r,o,n,i){var a={method:"GET",url:s.catalogApi+"services/"+e+"_"+(t||""),withCredentials:!0,cache:!s.isOp,params:{_:c,platform:r?null:window.platform,region:s.userSelectedRegion,oldStyleCode:o?"true":null,rUrl:s.lkUrl+"notifications/?type=ORDER",isManual:!!n}},e=(s.isOp&&(a.headers={Authorization:"bearer "+s.settings.accessToken}),Object.keys(i||{}));return e.length&&e.forEach(function(e){a.params[e]=i[e]}),l(a)},getServiceOffices:function(e,t,r,o){return l({method:"GET",url:s.catalogApi+"services/"+e+"_"+t+"/offices",withCredentials:!0,cache:!0,params:{_:c,region:s.userSelectedRegion,platform:window.platform,version:r,deptId:o}})},getDepartments:function(){var e=s.filterGosBarValue||n.getUserType();return l({method:"GET",url:s.catalogApi+"departments",withCredentials:!0,cache:!0,params:{_:c,region:s.userSelectedRegion,platform:window.platform,userType:e.departmentsType}})},getDepartment:function(e,t){var r=s.filterGosBarValue||n.getUserType();return l({method:"GET",url:s.catalogApi+"departments/"+e,withCredentials:!0,cache:!1,params:{_:c,region:"00000000000",platform:window.platform,userType:t?"all"==t?"":t:r.departmentItem}})},getPopular:function(e,t){return l({method:"GET",url:s.catalogApi+"passports/popular",withCredentials:!0,cache:!0,params:{_:s.cacheRequestStamp,region:i.getFederalNum(),type:e||null,lang:t||null}})},getPartnersWidgets:function(){return l({method:"GET",withCredentials:!0,url:s.cmsUrl+"partners/widgets",cache:!1,params:{_:c}})},getPartnersServices:function(){return l({method:"GET",url:s.cmsUrl+"partners/products",cache:!1,withCredentials:!0,params:{_:Math.random()}})},checkServiceUrl:function(e,t,r){var o={_:c,platform:window.platform};return r&&(o=angular.extend({},r,o)),l({method:"GET",url:s.catalogApi+"services/"+e+"_"+t+"/check",withCredentials:!0,cache:!1,params:o})},makeDoctor:function(){return l({method:"GET",url:s.lkApi+"/health/informers/10000054959",withCredentials:!0,cache:!1,params:{_:c}})},callDoctor:function(){return l({method:"GET",url:s.lkApi+"/health/informers/33090",withCredentials:!0,cache:!1,params:{_:c}})},healthQuestions:function(){return l({method:"GET",url:window.templatePath+"/js/data/health/health_questions.json",cache:!1,params:{_:c}})},healthResources:function(){return l({method:"GET",url:window.templatePath+"/js/data/health/health_resources.json",cache:!1,params:{_:c}})},healthCard:function(e){var t=o.defer(),e=e?s.lkApi2+"informers/i_med/fetch?refresh=true":s.lkApi2+"informers/i_med/fetch";return epguHandleAtmosphere("long-polling",e,null,"GET",function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise},getHeaderInfoBarInfo:function(){return l({method:"GET",url:window.templatePath+"/js/data/check-user-level.json",cache:!1,params:{_:c}})},getMaxSize:function(t){return l({method:"GET",url:s.lkApi+"eds/config",cache:!1}).then(function(e){t&&e&&e.data&&t(e.data)})},checkSignature:function(e){var t=o.defer(),r=s.lkApi+"eds/upload/check";return epguHandleAtmosphere("long-polling",r,e,"POST",function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise},getElmDetails:function(e,t,r){return l({method:"GET",url:s.catalogApi+"elm/get/"+e+"/"+t,withCredentials:!0,cache:!1,params:{_:c,userType:r||null,region:i.getFederalNum()}})},getFeedsInfo:function(e,t,r,o){return l({method:"GET",url:s.lkApi+"feeds/service/"+e+"/"+t,withCredentials:!0,cache:!1,headers:{Authorization:"bearer "+(s.settings&&s.settings.accessToken)},params:{_:c,pageSize:r||("mob"==s.version?1:null),startDate:o||null}})},saveEsiaAddresses:function(e){return l({method:"POST",withCredentials:!0,cache:!1,url:s.lkApi+"users/address",data:e})},getGroups:function(e){return l({method:"GET",url:s.cmsUrl+"i18/groups/"+e,withCredentials:!0})}}}])}(),function(){"use strict";angular.module("epgu").factory("FilteredFeedState",[function(){var t=!1;return{set:function(e){t=e},get:function(){return t}}}]).factory("LkService",["$rootScope","$http","$q","$moment","PerformanceService","FilteredFeedState","$location","ToggleCookie",function(l,c,o,n,i,a,s,u){function d(e,t,r){return e instanceof Date?n(e).format("YYYY-MM-DDTHH:mm:ss"+(r?"":".SSS")+"ZZ"):"string"==typeof e&&n(e,"YYYY-MM-DDTHH:mm:ss.SSSZZ").isValid()?e:t?n(t).format("YYYY-MM-DDTHH:mm:ss"+(r?"":".SSS")+"ZZ"):null}function p(e,t){var r=o.defer(),e={method:"GET",url:l.lkApi+"feeds/",withCredentials:!0,params:e};return c(e).then(function(e){e&&e.data&&e.data.items?r.resolve(e.data):r.reject()},function(e){i.measureEnd(t,1,{BrowserError:e.status}),r.reject(e)}),r.promise}var m=Math.random(),e=(new Date).getTime(),t=[{text:"Любое время",value:"all",time:null},{text:"За последний год",value:"year",time:new Date(e-31536e6)},{text:"За последний месяц",value:"month",time:new Date(e-2592e6)},{text:"За последнюю неделю",value:"week",time:new Date(e-6048e5)},{text:"За последний день",value:"day",time:getTooday()}],r={MEDICAL_POLICY:"MDCL_PLCY",FOREIGN_PASSPORT:"FRGN_PASS",DRIVING_LICENCE:"RF_DRIVING_LICENSE",PASSPORT:"RF_PASSPORT",FID_DOC:"FID_DOC",BIRTH_CERTIFICATE:"BRTH_CERT",BIRTH_CERTIFICATE_RF:"RF_BRTH_CERT",BIRTH_CERTIFICATE_FID:"FID_BRTH_CERT",BIRTH_CERTIFICATE_OLD:"OLD_BRTH_CERT",MILITARY_ID:"MLTR_ID",INN:"INN",SNILS:"SNILS",OTHER_DOC:"DOCS"},h=Object.assign({},r,{ORGANIZATION_INFO:"ORG_INFO",BRANCH_INFO:"BRANCH_INFO",CHILD:"CHILD",VEHICLE:"VEHICLE"}),f=null;return{getOrder:function(e,t){return"Array"==typeof t?t=t.join(","):void 0===t&&(t="STATUS_HISTORY,ATTRIBUTE,EQUEUE,INFO_MESSAGE,TEXT_MESSAGE,PAYMENT_STATUS,PAYMENT,RESPONSE_FILE,ATTACHMENT_FILE"),c({method:"GET",url:l.lkApi+"orders/"+e,withCredentials:!0,cache:!0,params:{_:m,embed:t}})},getResult:function(e){return c({method:"GET",url:l.lkApi+"orders/"+e+"/result",withCredentials:!0})},sendResult:function(e,t,r){return c({method:"POST",url:l.lkApi+"orders/"+e+"/result/mail",withCredentials:!0,params:{id:t,to:r}})},sendStatus:function(e,t,r){return c({method:"POST",url:l.lkApi+"orders/"+e+"/status/"+t+"/mail",withCredentials:!0,data:r})},notificationsFilter:{timeRange:t[0],query:"",feed:"all"},getTimeRanges:function(){return t},getFeedCount:function(){var e={isArchive:!1,startDate:"all"==this.notificationsFilter.timeRange.value?null:d(this.notificationsFilter.timeRange.time,null,!1),_:Math.random()};return"L"!==l.userType&&"B"!==l.userType?e.types="ORDER,EQUEUE,COMPLEX_ORDER,APPEAL,CLAIM,GEPS,ACCOUNT,BIOMETRICS,PROFILE,PAYMENT":e.types="all_v2",c({method:"GET",url:l.lkApi+"feeds/counters",withCredentials:!0,params:e})},getAllCounters:function(){return this.getFeedCount().then(function(e){e.data.counter=e.data.list||e.data.counter;var t={total:0,all:e.data.total||0};return e&&e.data&&e.data.counter&&(e.data.counter.filter(function(e){return e.type&&"DRAFT"!=e.type&&"FEEDBACK"!=e.type}).forEach(function(e){t[e.type.toLowerCase()]=e.unread,t.total+=e.unread}),t.notificationsCount=t.total),t},function(){return{total:0}})},getFeed:function(e,t,r){return p({q:this.notificationsFilter.query,lastFeedDate:e?d(t,new Date):null,lastFeedId:e,isArchive:!1,isHide:!1,startDate:"all"==this.notificationsFilter.timeRange.value||l.menuShow?null:d(this.notificationsFilter.timeRange.time),types:"all"==this.notificationsFilter.feed||l.menuShow||"all"==this.notificationsFilter.feed?"all_v2":this.notificationsFilter.feed,unread:!l.menuShow&&"showUnread"===a.get(),pageSize:!l.isLk||l.menuShow?3:10,_:Math.random()},r)},getMainFeed:function(e){return p({pageSize:1,_:Math.random()},e)},getDetails:function(e,t){return c({method:"GET",url:l.lkApi+"feeds/"+(t?t.toUpperCase()+"/":"")+e,withCredentials:!0,params:{_:m}})},pushOrder:function(e){return c({method:"GET",url:l.lkApi+"orders/"+e+"/push",withCredentials:!0})},getServiceUrl:function(e){return c({method:"GET",url:l.lkApi+"orders/"+e+"/serviceUrl",withCredentials:!0,params:{rUrl:l.lkUrl+"notifications"}})},deleteOrder:function(e){return c({method:"DELETE",url:l.lkApi+"orders/"+e,withCredentials:!0})},useAsTemplate:function(e){return c({method:"POST",url:l.lkApi+"orders/"+e,withCredentials:!0,params:{deleteExistsDrafts:"L"!==l.userType}})},saveRegion:function(e){return c({method:"POST",url:l.lkApi+"users/region",withCredentials:!0})},getObjectTypes:function(e){return e?r:h},createDocument:function(e){return c({method:"POST",url:l.lkApi+"users/docs",withCredentials:!0,data:e,params:{_:m}}).then(function(e){return e.data})},updateDocument:function(e){return c({method:"POST",url:l.lkApi+"users/docs/"+e.id,withCredentials:!0,data:e,params:{_:m}}).then(function(e){return e.data})},dropDocument:function(e){return c({method:"DELETE",url:l.lkApi+"users/docs/"+e.id,withCredentials:!0,params:{_:m}}).then(function(e){return e.data})},registerChild:function(e){return c({method:"POST",url:l.lkApi+"users/kids",withCredentials:!0,data:e,params:{_:m}}).then(function(e){return e.data})},updateChildInfo:function(e){return c({method:"POST",url:l.lkApi+"users/kids/"+e.id,withCredentials:!0,data:e,params:{_:m}}).then(function(e){return e.data})},unregisterChild:function(e){return c({method:"DELETE",url:l.lkApi+"users/kids/"+e.id,withCredentials:!0,params:{_:m}}).then(function(e){return e.data})},createCar:function(e){return c({method:"POST",url:l.lkApi+"users/cars",withCredentials:!0,data:e,params:{_:m}}).then(function(e){return e.data})},updateCar:function(e){return c({method:"POST",url:l.lkApi+"users/cars/"+e.id,withCredentials:!0,data:e,params:{_:m}}).then(function(e){return e.data})},deleteCar:function(e){return c({method:"DELETE",url:l.lkApi+"users/cars/"+e.id,withCredentials:!0,params:{_:m}}).then(function(e){return e.data})},submitFeedback:function(e,t,r){return c({method:"POST",url:l.lkApi+"/feedback/message",withCredentials:!0,data:{text:e,msgId:t,uploadedFiles:r||[]}})},integrationConfirm:function(e){return c({method:"GET",url:l.imApiUrl+"requests/"+e+"/confirm",withCredentials:!0})},integrationCancel:function(e){return c({method:"GET",url:l.imApiUrl+"requests/"+e+"/cancel",withCredentials:!0})},integrationBlock:function(e){return c({method:"GET",url:l.imApiUrl+"requests/"+e+"/block",withCredentials:!0})},getConfirmAgreement:function(e){return c({method:"POST",url:l.lkApi+"orders/"+e+"/agreements/confirm",data:{},withCredentials:!0})},sendErrorAgreement:function(e,t){return c({method:"POST",url:l.lkApi+"orders/"+e+"/agreements/error",data:t,withCredentials:!0})},clearCatalogData:function(){f=null},saveCatalogData:function(e,t){(f=e).feedOrder=t},getCatalogFormData:function(){var e,t,r,o;return f?(e=f.data,t={formConfig:{orderId:f.feedOrder.tpRequestInfo.orderId,integrationModuleMode:!0,integrationModuleDisclaimer:(r=f.feedOrder,{title:"Проверьте данные и подтвердите заявление, сформированое по запросу "+(o=r.tpRequestInfo.orgName)+", до "+n(r.tpRequestInfo.expire).format("HH:mm DD.MM.YYYY")+".",text:"Вы не можете редактировать это заявление. В случае ошибки или некорректности данных необходимо отклонить запрос. Если вы хотите запретить "+o+" направлять вам запросы в будущем, заблокируйте организацию."})},requestFormConfig:{},feedResponse:e,order:f.feedOrder},e.additionalAttributes.forEach(function(e){"EPGU_CODE"===e.name&&(t.requestFormConfig.targetId=e.value),"PASS_CODE"===e.name&&(t.requestFormConfig.passportId=e.value)}),e.passport.services.forEach(function(e){e.epguId===t.requestFormConfig.targetId&&(t.formConfig.mnemonic=e.id.eid,t.formConfig.serviceTargetExtId=e.id.lid)}),t):null},sendStarRating:function(e,t,r){return c({method:"POST",url:l.lkApi+"quiz/fnps/submit",withCredentials:!0,data:{text:r,evaluation:t,id:e}})},resultEds:function(e,t){return c({method:"POST",url:l.lkApi+"orders/"+e+"/edsResult",withCredentials:!0,data:{link:t}})},checkEds:function(e,t){return c({method:"POST",url:l.lkApi+"orders/"+e+"/edsCheck?link="+t,withCredentials:!0})},resultGepsEds:function(e){return c({method:"GET",url:l.gepsApiUrl+"file/"+e+"/eds",withCredentials:!0})},sendFilterStats:function(e){var t,r,o=s.search().type;switch(o||"all"){case"all":"markAllAsRead"===e?r=t="all":"markAsRead"===e&&(r="unread",t="all");break;case"PAYMENT":"markAllAsRead"===e?(t="payment",r="all"):"markAsRead"===e&&(r="unread",t="payment");break;case"APPEAL":case"ORDER":"markAllAsRead"===e?(t="order",r="all"):"markAsRead"===e&&(r="unread",t="order");break;case"EQUEUE":"markAllAsRead"===e?(t="appoinment",r="all"):"markAsRead"===e&&(r="unread",t="appoinment");break;case"GEPS":"markAllAsRead"===e?(t="gepsMessage",r="all"):"markAsRead"===e&&(r="unread",t="gepsMessage");break;case"FEEDBACK":"markAllAsRead"===e?(t="supportMessage",r="all"):"markAsRead"===e&&(r="unread",t="supportMessage")}l.disableMetric||metricReachGoal24845174("Event_all_read",{readMode:r,currentTab:t})},changeFeedNote:function(e,t){return c({method:"POST",url:l.lkApi+"orders/"+t+"/note",withCredentials:!0,data:{text:e}})},getOrgListData:function(e,t,r){t=t,o=r,i=e.split(","),o?n={treeFiltering:"ONELEVEL",pageNum:t.pageNum,pageSize:t.pageSize,filter:{union:{unionKind:"AND",subs:[{union:{unionKind:"OR",subs:s()}},{union:{unionKind:"OR",subs:[a("ORG_CONTACT_NAME"),a("OGRN_OGRNIP")]}}]}},parentRefItemValue:"",selectAttributes:["*"]}:1===i.length?n={treeFiltering:"ONELEVEL",pageNum:t.pageNum,pageSize:t.pageSize,filter:{simple:{attributeName:"CONTACT_TYPE",condition:"EQUALS",value:{asString:i[0]}}},parentRefItemValue:"",selectAttributes:["*"]}:1<i.length&&(n={treeFiltering:"ONELEVEL",pageNum:t.pageNum,pageSize:t.pageSize,filter:{union:{unionKind:"OR",subs:s()}},parentRefItemValue:"",selectAttributes:["*"]});var o,n,i,r=n;function a(e){return{simple:{attributeName:e,condition:"CONTAINS",value:{asString:o}}}}function s(){var t=[];return i.forEach(function(e){t.push({simple:{attributeName:"CONTACT_TYPE",condition:"EQUALS",value:{asString:e}}})}),t}return c({method:"POST",url:l.nsiApi+"dictionary/CONTACT_LIST",withCredentials:!0,data:r})},checkByStatus:function(e,t,r,o){e={method:"POST",url:l.lkApi+"orders/checkByStatus",withCredentials:!0,data:{eserviceCode:e,serviceTargetId:t,statuses:r,date:o}};return l.settings&&l.settings.accessToken&&(e.headers={Authorization:"bearer "+l.settings.accessToken}),c(e)},getProfilingAgencies:function(){return c({method:"GET",url:l.lkApi+"kno/profiling",withCredentials:!0,params:{_:m}})},getAgencyRequirements:function(e){return c({method:"GET",url:l.lkApi+"kno/"+e+"/reqlist",withCredentials:!0,params:{type:"mandatory",_:m}})},getAgencyDeclarations:function(e){return c({method:"GET",url:l.lkApi+"kno/"+e+"/reqlist",withCredentials:!0,params:{type:"declaring",_:m}})},getAgencyAssessments:function(e){return c({method:"GET",url:l.lkApi+"kno/"+e+"/reqlist",withCredentials:!0,params:{type:"assessment",_:m}})},getAgencySupervisors:function(e){return c({method:"GET",url:l.lkApi+"kno/"+e+"/supervisors",withCredentials:!0,params:{_:m}})},getRequirementDetails:function(e,t,r){return c({method:"GET",url:l.lkApi+"kno/"+e+"/requirement",withCredentials:!0,params:{reqListId:t,reqInListId:r,_:m}})},getDeclarationDetails:function(e,t,r,o){return c({method:"GET",url:l.lkApi+"kno/"+e+"/requirement",withCredentials:!0,params:{reqListId:t,reqInListId:r,answersType:"declare",withAnswers:o,_:m}})},getAssessmentDetails:function(e,t,r,o){return c({method:"GET",url:l.lkApi+"kno/"+e+"/requirement",withCredentials:!0,params:{reqListId:t,reqInListId:r,answersType:"assess",withAnswers:o,withViolations:!0,_:m}})},saveDeclaration:function(e,t){return c({method:"POST",url:l.lkApi+"kno/"+e+"/requirement/declare",withCredentials:!0,params:{_:m},data:t})},saveAssessment:function(e,t){return c({method:"POST",url:l.lkApi+"kno/"+e+"/requirement/assess",withCredentials:!0,params:{_:m},data:t})},getSupervisorEstimatedObjectRisks:function(e,t,r,o){o={type:"object",pageSize:o,pageNum:r,_:m};return null!==t&&(o.supId=t),c({method:"GET",url:l.lkApi+"kno/"+e+"/risks",withCredentials:!0,params:o})},getSupervisorOrganizationCommonRisks:function(e,t){var r={type:"common",pageSize:10,pageNum:1,_:m};return null!==t&&(r.supId=t),c({method:"GET",url:l.lkApi+"kno/"+e+"/risks",withCredentials:!0,params:r})},getEmployees:function(e){var t=l.user.branchOid?"&brhOid="+l.user.branchOid:"",r=encodeURIComponent(e.query);return c({method:"GET",headers:{Authorization:"Bearer "+u.readCookie("acc_t"),"Content-Type":"application/json; charset=utf-8"},url:l.esiaApi+"orgs/"+e.orgOid+"/emps?embed=(groups.elements,person.elements)"+t+"&pageIndex="+e.pageIndex+"&pageSize="+e.pageSize+"&fio="+r,withCredentials:!0})},sendRole:function(e){return c({method:"POST",url:l.lkApi+"users/groups/"+e.oid+"?oldGroup="+e.oldGroup+"&newGroup="+e.newGroup,withCredentials:!0})},setNotificationsAgreement:function(e,t){return c({method:"POST",url:l.notificationApiUrl+"usernotificationplan/all/"+t,withCredentials:!0,params:e})},checkMedicClaimAvailable:function(){return c({method:"POST",url:l.lkApi+"orders/check/398500/1",withCredentials:!0})},getLinkToSendMfcForm:function(e){return c({method:"POST",url:l.lkApi+"mfc/send-files",withCredentials:!0,data:{orderId:e},params:{source:"LK"}})},getAttachmentsFiles:function(e){return c({method:"GET",url:l.gepsApiUrl+"file/"+e+"/head",withCredentials:!0,params:{_:Math.random()}})},getELKChannelNSI:function(){return c({method:"POST",url:l.nsiApi+"dictionary/ELK_CHANNEL",data:{refName:"ELK_CHANNEL",treeFiltering:0}})},createProactivityOrder:function(e,t){return c({method:"POST",url:l.lkApi+"orders/proactivity/create",withCredentials:!0,params:{mnemonic:e,orderId:t}})},checkIfOrderIdExists:function(e,t){return c({method:"POST",url:l.baseApiUrl+`service/${e}/scenario/checkIfOrderIdExists`,withCredentials:!0,data:{targetId:t}})}}}]).factory("transportObjectService",["LkService","ngDialog","$rootScope","UserService","FormServer","$route","$routeParams","$location","$timeout","autoNumbersPatterns","esiaTransportService",function(e,n,t,r,o,i,a,s,l,c,u){function d(){t.user={},t.loading=!0,t.profile=void 0,t.informerKnd=!1,t.menuShow=!1,window.scrollTo(0,0),l(function(){r.load().then(function(){i.reload(),t.loading=!1,t.userId=t.user.userId,o.invalidateInformer("gibdd","?refresh=true"),a.rUrl?window.location=t.betaUrl+a.rUrl:s.search("type",null)})},+t.delayLkTimeInMs)}function p(t){return c.getCarNumberPatterns().some(function(e){return e.test(t)})}function m(e){return c.getBikeNumberPattern().test(e)}function h(t,r,o){e.createCar(t).then(function(e){e.error||!e.id?o(e):(n.closeAll(),r?(t.id=e.id,t=u.transformTransportData(t),r(t,e)):d())},function(e){o(e)})}function f(t,r,o){e.updateCar(t).then(function(e){e.error||!e.id?o(e):(n.closeAll(),r&&(t=u.transformTransportData(t),r(t,e)))},function(e){o(e)})}return{isCarNumber:p,isMotoNumber:m,isValidCertNumber:function(e){return c.getCarCertNumberPattern().test(e)},isValidName:function(e){return c.getTransportNamePattern().test(e)},deleteTransport:function(t,r){return e.deleteCar(t).then(function(e){if(n.closeAll(),e)return r&&r(t,e),t;d()},function(e){return n.closeAll(),e})},deleteAllTransports:function(){return u.deleteAllTransports().then(function(e){return e},function(e){return $q.reject(e)})},createNewTransport:h,updateTransport:f,getCountVehicles:function(){return u.getTransports({pageSize:1,pageIndex:1}).then(function(e){return e.size})},get:function(){return{numberField:{codeName:"RegNumber",showErrors:!1,trim:!0,inputMaxLength:11,pattern:c.getCarNumberSinglePattern()},stsFieldUiOptions:{clearOnBlur:!1,allowInvalidValue:!0,maskDefinitions:{"*":c.getCarCertLettersSet()}},stsField:{codeName:"STS",showErrors:!1,uiOptions:"profile.addCarProps.stsFieldUiOptions",trim:!0,maxLength:12,inputMaxLength:12,mask:"99 ** 999999",pattern:c.getCarCertNumberPattern()},nameField:{codeName:"Name",showErrors:!1,trim:!0,minLength:0,maxLength:64,inputMaxLength:64,pattern:c.getTransportNamePattern()},getErrorMessage:function(e,t){var r,o=e.$error,n="",i={sts:"Транспортное средство с таким СТС уже добавлено в личный кабинет.",required:"Поле обязательно для заполнения.",mask:"Указан некорректный номер СТС.",parse:"Указан некорректный номер СТС.",patternRegNumber:"Указан некорректный государственный номер.",patternName:'Название может содержать только русские и английские буквы, цифры, пробелы и символы "-", " \' ", "." и ",".',minlength:"Количество символов должно быть не менее: "+(t?t.minLength:0)};for(r in o)if(o.hasOwnProperty(r)){if(n=i[r+(t.codeName||"")]||i[r],"pattern"===r||"mask"===r)break;if(n)break}return n},showTsIcon:function(e){return e&&m(e)?"1":e&&p(e)?"2":"0"},isRequired:function(e){return e.$dirty},saveCar:function(e,t,r,o,n){e.preventDefault(),e.stopPropagation(),o?(n.carNumberForm.$dirty=!0,n.carStsForm.$dirty=!0,n.carNameForm.$dirty=!0):(e=t.callback,o=t.errorCallback,n={name:r.name,numberPlate:r.number,regCertificate:{series:r.sts.substr(0,4),number:r.sts.substr(4,r.sts.length)}},("add"===t.mode?h:(n.id=r.id,f))(n,e,o))}}}}}]).factory("NotificationMailService",["$rootScope","$http",function(t,r){return{getData:function(e){return r({method:"GET",url:t.notificationApiUrl+"getEmail",withCredentials:!0,params:{_:Math.random(),type:"ORDER_STATUS",objectUserId:e}})}}}]).factory("ResendService",["$rootScope","$http",function(t,r){return{setAcceptStatus:function(e){return r({method:"POST",url:t.gepsApiUrl+"transfer/v1/subscribe",withCredentials:!0,data:e})},setCancelStatus:function(e){return r({method:"POST",url:t.gepsApiUrl+"messages/thread/"+e+"/cancel",withCredentials:!0})},sendMessage:function(e){return r({method:"POST",url:t.gepsApiUrl+"transfer/v1/notify",withCredentials:!0,data:e})},resendMessage:function(e){return r({method:"POST",url:t.gepsApiUrl+"transfer/v1/send",withCredentials:!0,data:e})},loadGepsBlacklist:function(){return r({method:"GET",url:t.gepsApiUrl+"transfer/v1/status/blocked",withCredentials:!0,params:{_:Math.random()}})},unblockGepsUser:function(e){return r({method:"POST",url:t.gepsApiUrl+"/transfer/v1/subscribe",withCredentials:!0,data:{status:"UNLINK",fromOid:e}})},getResendData:function(e){return r({method:"GET",url:t.lkApi+"orders/getFilesForResend/"+e,withCredentials:!0,params:{_:Math.random()}})},searchUser:function(e){return r({method:"GET",url:t.gepsApiUrl+"transfer/v1/search?"+e,withCredentials:!0,params:{_:Math.random()}})},checkCurrentUser:function(){return r({method:"GET",url:t.gepsApiUrl+"transfer/v1/blackList",withCredentials:!0,params:{_:Math.random()}})},checkFilesForResend:function(e){return r({method:"POST",url:t.lkApi+"orders/sentOtherUsers",withCredentials:!0,data:[e]})}}}])}(),function(){"use strict";angular.module("epgu").factory("VaccineService",["$rootScope","$q","$http",function(r,e,o){return{getVaccineRegisterInfo:function(e){return o(-1!==e?{method:"GET",url:r.vaccineUrlv2+"?_="+Math.random()+"&"+window.location.search.slice(1),withCredentials:!0}:{method:"GET",url:r.vaccineUrlv2+"?_="+Math.random(),withCredentials:!0})},sendConfirmStatus:function(e,t){return o({method:"POST",url:r.vaccineUrlv2+"?_="+Math.random(),data:{id:r.userId,status:e,unrz:t},withCredentials:!0})},getPdfCovidCert:function(e){e=r.covidCertPdfUrl.replace("{unrzFull}",e);return o.get(e,{responseType:"arraybuffer",withCredentials:!0})}}}])}(),function(){"use strict";angular.module("epgu").factory("LangService",["$rootScope","ipCookie","$sce",function(n,t,i){function e(e){for(var t=e.split("."),r=a,o=0;o<t.length;o++){if(!r.hasOwnProperty(t[o]))return i.trustAsHtml(e);r=r[t[o]]}return r.hasOwnProperty(n.lang)?i.trustAsHtml(r[n.lang]):i.trustAsHtml(e)}var a={main:{home:{ru:"Главная",en:"Main",de:"Startseite",fr:"Accueil"},menu:{health:{ru:"Моё здоровье",en:"My health",de:"meine Gesundheit",fr:"ma santé"},catalog:{ru:"Услуги",en:"E-Services",de:"E-Services",fr:"E-Services"},support:{ru:"Поддержка",en:"FAQ",de:"FAQ",fr:"FAQ"},payments:{ru:"Оплата",en:"Payments",de:"Zahlungen",fr:"Paiements"},signIn:{ru:"Личный кабинет",en:"Sign in",de:"Einlogen",fr:"Entrer"},selectLocation:{ru:"Выберите регион",en:"Select location",de:"Wählen Sie Region aus",fr:"Choisir une région"},forCitizen:{ru:"Для граждан",en:"For Citizen",de:"Für Bürger",fr:"Pour les citoyens"},forEntrepreneurs:{ru:"Для предпринимателей",en:"For Entrepreneurs",de:"Для предпринимателей",fr:"Для предпринимателей"},forLegal:{ru:"Для юридических лиц",en:"For Legal Entities",de:"Для юридических лиц",fr:"Для юридических лиц"},forPartners:{ru:"Для партнеров",en:"For Partners",de:"Для партнеров",fr:"Для партнеров"},forForeignCitizen:{ru:"Для иностранных граждан",en:"For Foreign Citizens",de:"Для иностранных граждан",fr:"Для иностранных граждан"}},footer:{description:{ru:"Официальный интернет-портал государственных услуг",en:"The official internet portal<br/>of Public services",de:"Das offizielle Portal<br/>der öffentlichen Dienstleistungen",fr:"Le Portail Commun des Services d’Etat"},year:{ru:"г.",en:"",de:"",fr:""},social:{ru:"Госуслуги в социальных сетях",en:"",de:"",fr:""},feedback:{ru:"Оставить отзыв",en:"Feedback form",de:"Feedback form",fr:"Feedback form"}}},pages:{foreigners:{title:{ru:"Государственные услуги для иностранных граждан",en:"Government services for foreign citizens",de:"Staatliche Dienstleistungen für Ausländer",fr:"Services de l'Etat pour les étrangers"}},langPopup:{title:{en:"This section is only available in Russian",de:"Dieser Abschnitt ist nur auf Russian verfügbar",fr:"Cette section est uniquement disponible en russe"},text:{en:"We're sorry, but other services currently are not presented in English",de:"Es tut uns leid, aber andere Dienstleistungen derzeit nicht in deutscher Sprache vorgelegt",fr:"Nous sommes désolés, mais d'autres services actuellement ne sont pas présentés en français"},getBack:{en:"Get back",de:"Zurück",fr:"Retour"},continue:{en:"Continue",de:"Fortsetzen",fr:"Continuez"}}}};return{setLang:function(e){~n.allowedLangs.indexOf(e)&&(t("userSelectedLanguage",e,{domain:n.cookieDomain,path:"/",expires:8760,expirationUnit:"hours"}),n.lang=e)},getMessage:n.getMessage=e}}])}(),function(){"use strict";angular.module("epgu").factory("CMSService",["$rootScope","$http","$location","$q","$timeout","MainPageService","RegionService","OkatoService",function(n,i,a,s,e,l,t,c){var u=Math.random(),d="EPGUV3_"+("dk"==n.version?"DESK":"mob"==n.version?"MOB":"TAB"),p={"Content-Type":"application/json; charset=utf-8"};return n.vkShareUrl="https://vk.com/share.php?act=count&index=1&url=",n.fbShareUrl="//graph.facebook.com/",n.okShareUrl="https://connect.ok.ru/dk?st.cmd=extLike&tp=json&ref=",{removeTargetSlide:function(e,t){var r;n.user.userId?(r={_:u},t&&(r.bCode=t),i({method:"DELETE",url:n.quadrupelUrl+"banners/"+e,withCredentials:!0,cache:!1,params:r})):t&&this.sendTargetBannersStatistic([t],"CLOSE")},getTargetPlaces:function(e,t){var r,e={groups:e,platform:d,_:n.cacheRequestStamp,region:n.userSelectedRegion};function o(e){var r=e,o={};return Object.keys(r).forEach(function(e){var t=r[e].group;o[t]={},o[t].list=r[e].banners,r[e].bgImage&&(o[t][t+"_bg"]=r[e].bgImage),!n.disableMetric&&o[t][0]&&metricReachGoal(t,{id:o[t].banners[0].id})}),o}return a.$$path&&~a.$$path.indexOf("/r/")&&(r=a.$$path.replace("/r/","")).length&&(e.manualRegion=r),n.userId||t?i({method:"GET",url:n.quadrupelUrl+"banners",withCredentials:!0,cache:!1,headers:{"Cache-Control":"no-cache"},params:e}).then(function(e){if(e&&e.data)return o(e.data)}):l.getAll().then(function(){return o(l.getBanners())})},getSliders:function(e,t){return i({method:"GET",url:n.cmsUrl+"sliders/"+d,withCredentials:!0,params:{c:e||null,lang:t||null,_:u},headers:p})},getNews:function(e,t,r){return i({method:"GET",url:n.cmsUrl+"news",headers:p,params:e,withCredentials:!0})},showNewsDetail:function(e,t,r,o){return e.region=c.getFederalNum(),i({method:"GET",url:n.cmsUrl+"news/"+t,headers:p,params:e,withCredentials:!0})},getAll:function(){return i({method:"GET",url:n.cmsUrl+"informations",params:{_:u},withCredentials:!0})},getCodeData:function(e){return i({method:"GET",url:n.cmsUrl+"informations/"+e,params:{_:u},withCredentials:!0})},getFooter:function(){return i({method:"GET",url:n.cmsUrl+"footers/"+d,params:{_:n.cacheRequestStamp,region:n.userSelectedRegion},withCredentials:!0})},getFaq:function(){return i({method:"GET",url:n.cmsUrl+"faq/categories/top",params:{_:u},withCredentials:!0})},getFaqDetail:function(){return i({method:"GET",url:n.cmsUrl+"faq",params:{_:u},withCredentials:!0})},voteForResource:function(e,t,r,o){return i({method:"GET",cache:!1,url:n.cmsUrl+"vote/"+encodeURIComponent(e)+"/"+encodeURIComponent(t),params:{platform:d||"",value:r,url:o,_:u},withCredentials:!0})},checkVoteForResource:function(e,t){return i({method:"GET",url:n.cmsUrl+"vote/check/"+encodeURIComponent(e)+"/"+encodeURIComponent(t),params:{_:Math.random()},cache:!1,withCredentials:!0})},getHelpful:function(){return i({method:"GET",url:n.cmsUrl+"tips",params:{_:u},withCredentials:!0})},getHelpFullNew:function(){return i({method:"GET",url:n.cmsUrl+"faq/blocks",params:{_:u},withCredentials:!0})},getFaqAnswers:function(e){var t="popular"===e;return i({method:"GET",url:n.cmsUrl+"faq/categories/"+e,cache:t,params:{_:t?n.cacheRequestStamp:u,region:c.getFederalNum()},withCredentials:!0})},getFaqMain:function(){return i({method:"GET",url:n.cmsUrl+"faq/main",params:{_:u},withCredentials:!0})},getFaqSidebar:function(){return i({method:"GET",url:n.cmsUrl+"faq/categories/toc",cache:!1,params:{_:u},withCredentials:!0})},checkOldLink:function(t){var e=a.search().q||a.hash(),r=a.path(),o=s.defer();return"/help/faq"!==r&&"/help/faq/"!==r||(location.href=n.betaUrl+"help/faq/popular"),e?i({method:"GET",url:n.cmsUrl+"faq/convert",cache:!1,params:{_:u,code:e},withCredentials:!0}).then(function(e){return e&&200==e.status&&e.data?(location.href=n.betaUrl+t+e.data.categoryCode,n.betaUrl+t+e.data.categoryCode):(o.reject(),function(){return o.promise})},function(e){return o.reject(),function(){return o.promise}}):(o.resolve(),function(){return o.promise})},getPartnerBanners:function(){return i({method:"GET",url:n.quadrupelUrl+"banners",params:{_:n.cacheRequestStamp,groups:"partners_main_banner",platform:d,region:n.userSelectedRegion}})},getRegionMrotInfo:function(e){return i({url:n.nsiApi+"dictionary/MROT_OKATO_3_7",method:"POST",withCredentials:!0,data:{selectAttributes:["*"],filter:{simple:{attributeName:"OKATO",condition:"EQUALS",value:{asString:e}}}}})},sendTargetBannersStatistic:function(e,t){e&&e.length&&i({url:n.quadrupelUrl+"bstats",method:"GET",withCredentials:!0,params:{bCodes:e.toString(),evtType:t}})},getBannersBCodes:function(e){return e.filter(function(e){return!!e.bcode}).map(function(e){return e.bcode})}}}])}(),function(){"use strict";angular.module("epgu").factory("PerformanceService",["$rootScope","$http","$moment","$timeout","$httpParamSerializerJQLike","$routeParams",function(c,e,t,r,u,d){function i(e,t,r,o,n){var i,a,s,l;c.timingApi&&!p&&(void 0===r&&(r=0),-1==(i=(window.location.pathname+window.location.hash).replace(/[(#\/):\.&\?=]/g,"_").slice(1).toLowerCase()).indexOf("order")&&-1==i.indexOf("payment")||(a=i?i.split("_"):[])&&4==a.length&&(a.splice(-1,1),i=a.join("_")),d.utm_source&&(s=d.utm_source),c.isLk&&!i&&(i="lk"),n&&n.feeds&&(i=n.feeds),l=c.timingApi+"?_="+Math.random()+"&pageId="+(i||"_")+"&event="+e+(s?"&utm_source="+s:"")+"&timing="+t+"&result="+r+(o&&u(o)?"&"+u(o):""),Object.keys(n||{}).forEach(function(e){l+="&"+e+"="+n[e]}),window.makeRequestHealth(l,i,e,t,r))}var a={},p=$("html").is(".ie9");return{measureStart:function(e){a[e]=Date.now()},measureEnd:function(e,t,r,o){var n=a[e];n&&(n=Date.now()-n,i(e,n,t,r,o),delete a[e])},measure:function(e,t){i(e,0,0,0,t)}}}])}(),function(){"use strict";angular.module("epgu").factory("ProtectionService",["$q","$rootScope","$injector",function(e,l,t){var c,u="",r="Error while getting schema.json",o=null;function s(e,t,r,o,n,i){return f((t=f(f(t,e),f(o,i)))<<n|t>>>32-n,r)}function d(e,t,r,o,n,i,a){return s(t&r|~t&o,e,t,n,i,a)}function p(e,t,r,o,n,i,a){return s(t&o|r&~o,e,t,n,i,a)}function m(e,t,r,o,n,i,a){return s(t^r^o,e,t,n,i,a)}function h(e,t,r,o,n,i,a){return s(r^(t|~o),e,t,n,i,a)}function f(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function g(e){for(var t,r=function(e){for(var t="",r=0;r<32*e.length;r+=8)t+=String.fromCharCode(e[r>>5]>>>r%32&255);return t}(function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var r=1732584193,o=-271733879,n=-1732584194,i=271733878,a=0;a<e.length;a+=16){var s=r,l=o,c=n,u=i,o=h(o=h(o=h(o=h(o=m(o=m(o=m(o=m(o=p(o=p(o=p(o=p(o=d(o=d(o=d(o=d(o,n=d(n,i=d(i,r=d(r,o,n,i,e[a+0],7,-680876936),o,n,e[a+1],12,-389564586),r,o,e[a+2],17,606105819),i,r,e[a+3],22,-1044525330),n=d(n,i=d(i,r=d(r,o,n,i,e[a+4],7,-176418897),o,n,e[a+5],12,1200080426),r,o,e[a+6],17,-1473231341),i,r,e[a+7],22,-45705983),n=d(n,i=d(i,r=d(r,o,n,i,e[a+8],7,1770035416),o,n,e[a+9],12,-1958414417),r,o,e[a+10],17,-42063),i,r,e[a+11],22,-1990404162),n=d(n,i=d(i,r=d(r,o,n,i,e[a+12],7,1804603682),o,n,e[a+13],12,-40341101),r,o,e[a+14],17,-1502002290),i,r,e[a+15],22,1236535329),n=p(n,i=p(i,r=p(r,o,n,i,e[a+1],5,-165796510),o,n,e[a+6],9,-1069501632),r,o,e[a+11],14,643717713),i,r,e[a+0],20,-373897302),n=p(n,i=p(i,r=p(r,o,n,i,e[a+5],5,-701558691),o,n,e[a+10],9,38016083),r,o,e[a+15],14,-660478335),i,r,e[a+4],20,-405537848),n=p(n,i=p(i,r=p(r,o,n,i,e[a+9],5,568446438),o,n,e[a+14],9,-1019803690),r,o,e[a+3],14,-187363961),i,r,e[a+8],20,1163531501),n=p(n,i=p(i,r=p(r,o,n,i,e[a+13],5,-1444681467),o,n,e[a+2],9,-51403784),r,o,e[a+7],14,1735328473),i,r,e[a+12],20,-1926607734),n=m(n,i=m(i,r=m(r,o,n,i,e[a+5],4,-378558),o,n,e[a+8],11,-2022574463),r,o,e[a+11],16,1839030562),i,r,e[a+14],23,-35309556),n=m(n,i=m(i,r=m(r,o,n,i,e[a+1],4,-1530992060),o,n,e[a+4],11,1272893353),r,o,e[a+7],16,-155497632),i,r,e[a+10],23,-1094730640),n=m(n,i=m(i,r=m(r,o,n,i,e[a+13],4,681279174),o,n,e[a+0],11,-358537222),r,o,e[a+3],16,-722521979),i,r,e[a+6],23,76029189),n=m(n,i=m(i,r=m(r,o,n,i,e[a+9],4,-640364487),o,n,e[a+12],11,-421815835),r,o,e[a+15],16,530742520),i,r,e[a+2],23,-995338651),n=h(n,i=h(i,r=h(r,o,n,i,e[a+0],6,-198630844),o,n,e[a+7],10,1126891415),r,o,e[a+14],15,-1416354905),i,r,e[a+5],21,-57434055),n=h(n,i=h(i,r=h(r,o,n,i,e[a+12],6,1700485571),o,n,e[a+3],10,-1894986606),r,o,e[a+10],15,-1051523),i,r,e[a+1],21,-2054922799),n=h(n,i=h(i,r=h(r,o,n,i,e[a+8],6,1873313359),o,n,e[a+15],10,-30611744),r,o,e[a+6],15,-1560198380),i,r,e[a+13],21,1309151649),n=h(n,i=h(i,r=h(r,o,n,i,e[a+4],6,-145523070),o,n,e[a+11],10,-1120210379),r,o,e[a+2],15,718787259),i,r,e[a+9],21,-343485551),r=f(r,s);o=f(o,l),n=f(n,c),i=f(i,u)}return Array(r,o,n,i)}(function(e){for(var t=Array(e.length>>2),r=0;r<t.length;r++)t[r]=0;for(r=0;r<8*e.length;r+=8)t[r>>5]|=(255&e.charCodeAt(r/8))<<r%32;return t}(e),8*e.length)),o="0123456789ABCDEF",n="",i=0;i<r.length;i++)t=r.charCodeAt(i),n+=o.charAt(t>>>4&15)+o.charAt(15&t);return n}function v(e,t,r){var o,n="";r&&((o=new Date).setTime(o.getTime()+1e3*r),n="; expires="+o.toUTCString()),document.cookie=`${e}=${t}${n}; domain=${l.cookieDomain}; path=/`}function n(i){var e=navigator.userAgent,t=Math.floor((new Date).getTime()/1e3),a=i.a,r=i.ip,s=(u=e+":"+r+":"+(t-t%a),0);!function e(){for(var t,r,o=!1,n=0;n<1e3;n++)if("3FE3"===(t=g(u+(r=s+n))).slice(6,10)){o=!0;break}o?(v(i.cn,t,a),v(i.cn+"_2",r,a),c=t,l.$broadcast("protectHash",c)):(s=r,setTimeout(function(){e()},0))}()}return{generatedHash:c,schemaError:r,generateCookieHashByUserData:function(){var e;o?n(o):(e=l.baseApiUrl.replace("api/","")+"__jsch/schema.json",t.get("$http")({method:"GET",url:e,headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){n(o=e.data)}).catch(function(e){c=r,l.$broadcast("protectHash",c)}))},clearHash:function(){c=""}}}])}(),function(){"use strict";function a(e,r,t){function o(e){return e&&e.includes("@")}function n(e){return e&&/^[\d\.\*#\-–\+\(\)\s]+$/.test(e)}function i(e){return e&&!o(e)&&!n(e)}var a={type:"Feature",id:e.oid,geometry:{type:"Point",coordinates:e.coords||e.location&&e.location.coordinates},properties:Object.assign(angular.copy(e),{officeName:t?e.raname||e.organizationShirtName:e.orgName,fullName:t&&e.raname?e.organizationShirtName:null,address:e.address,distance:e.distance,approximateDistanceText:1e3<=e.distance?Math.round(e.distance/100)/10+" км":10*Math.round(e.distance/10)+" м",contact:e.contact,worktime:e.worktime,comment:e.comment||e.information&&e.information.add_inf,urlCard:e.urlCard,email:o(e.contact)?e.contact:(e.contacts||[]).find(o),phones:n(e.contact)?[e.contact.replace(/\s/g,"")]:(e.contacts||[]).filter(n).map(function(e){return e.replace(/\s/g,"")}),contacts:i(e.contact)?[e.contact]:(e.contacts||[]).filter(i),features:e.features||[],opnModes:e.opnModes||[],services:(e.features||[]).map(function(t){return r.find(function(e){return e.code===t})})}),hashedCriteriaCodes:{}};return d.forEach(function(e){e=a.properties[e];Array.isArray(e)?e.forEach(function(e){a.hashedCriteriaCodes[e]=!0}):a.hashedCriteriaCodes[e]=!0}),a}function s(e,t,r,o){this.code=e,this.title=t,this.pointsProvider=r,this.filters=o}function l(e,t,r){this.field=e,this.title=t,this.options=r,this.hashedSelectedCodes=[],this.updateHashedSelectedCodes()}function c(e,t,r){this.code=e,this.title=t,this.checked=r}function u(e,t,r,o,n){this.serviceRef=e,this.serviceCode=t,this.serviceUrl=r,this.fieldAliases=o,this.definitions=n,this.resetState()}var t=[37.64,55.76],d=["features","opnModes"];s.prototype.getProvider=function(){return this.pointsProvider},s.prototype.getFilters=function(){return this.filters},l.prototype.isHashed=function(){return d.includes(this.field)},l.prototype.getField=function(){return this.field},l.prototype.getTitle=function(){return this.title},l.prototype.getOptions=function(){return this.options},l.prototype.getSelected=function(){return(this.options||[]).filter(function(e){return e.isChecked()})},l.prototype.updateHashedSelectedCodes=function(){this.hashedSelectedCodes=this.getSelected().map(function(e){return e.getCode()})},l.prototype.getHashedSelectedCodes=function(){return this.hashedSelectedCodes},l.prototype.isDoubleColumned=function(){return 5<=(this.options||[]).length},c.prototype.getCode=function(){return this.code},c.prototype.getTitle=function(){return this.title},c.prototype.isChecked=function(){return this.checked},c.prototype.setChecked=function(e){this.checked=e};u.prototype.getServiceCode=function(){return this.serviceCode},u.prototype.getServiceUrl=function(){return this.serviceUrl},u.prototype.getFieldAliases=function(){return this.fieldAliases},u.prototype.resetState=function(){this.cachedItems=[],this.cachedListItems=[],this.moreListPointsAvailable=!0},u.prototype.getPoints=function(e){this.requestInProgress=!0;var r="co"===this.serviceCode;return this.serviceRef.getHttpService()({url:this.serviceUrl,method:"POST",withCredentials:!0,data:{bounds:e,usercoords:this.serviceRef.getUserCoords(),oids:this.cachedItems.map(function(e){return e.id}),insideBounds:!0}}).then(function(e){var t;if(e&&200===e.status&&e.data&&e.data.services&&void 0!==e.data.services)return(t=e.data.services.map(function(e){return a(e,this.definitions,r)}.bind(this)).filter(function(t){return!this.cachedItems.some(function(e){return t.id===e.id}.bind(this))}.bind(this))).forEach(function(e){this.cachedItems.push(e)}.bind(this)),t;throw e.statusMessage}.bind(this))},u.prototype.downloadMoreListPoints=function(r,o,e){var n=e||1,i="co"===this.serviceCode;return r?this.downloadMoreListPoints(0,null,n).then(function(t){var e=t.filter(o).length;return r<=e||!t.length?t:this.downloadMoreListPoints(r-e,o,n+1).then(function(e){return t.concat(e)})}.bind(this)):(e=(e=[10,10,10,10,50,50,50,100,100,100,1e3,1e3,1e3]).length<n?1e4:e[n-1],this.serviceRef.getHttpService()({url:this.serviceUrl,method:"POST",withCredentials:!0,data:{usercoords:this.serviceRef.getUserCoords(),oids:this.cachedListItems.map(function(e){return e.id}),insideBounds:!1,bounds:[[0,0],[0,0]],count:e}}).then(function(e){var t;if(e&&200===e.status&&e.data&&e.data.services&&void 0!==e.data.services)return this.moreListPointsAvailable=0<e.data.services.length,(t=e.data.services.map(function(e){return a(e,this.definitions,i)}.bind(this))).forEach(function(e){this.cachedListItems.push(e)}.bind(this)),t;throw e.statusMessage}.bind(this)))},u.prototype.isMoreListPointsAvailable=function(){return this.moreListPointsAvailable},u.prototype.getDownloadedListPoints=function(){return this.cachedListItems},u.prototype.hasCachedState=function(){return!!this.cachedItems.length},u.prototype.getCachedState=function(){return this.cachedItems},angular.module("epgu").factory("EpguMapPageService",["$rootScope","$http",function(r,n){var i={},a=null,o=null;return{getLayers:function(){return n({url:r.mapApi+"layers",method:"GET",dataType:"json",withCredentials:!0,params:{_:Math.random()}}).then(function(e){if(e&&200===e.status&&e.data)return e.data;throw new Error("Unable to read layers from service, "+e.statusText)})},selectActiveLayer:function(e){var t=e&&e.code,o=e&&e.title;if(t)return i[t]?(a=i[t],Promise.resolve(a)):n({url:r.mapApi+"layers/"+t,method:"GET",dataType:"json",withCredentials:!0,params:{_:Math.random()}}).then(function(r){if(r&&200===r.status&&r.data)return i[t]=new s(t,o,new u(this,t,r.data.serviceUrl,r.data.sysColumnOverload,r.data.constants),(r.data.filters||[]).map(function(e){return new l(e.field,e.title,(e.codes||[]).map(function(t){var e=(r.data.constants||[]).find(function(e){return e.code===t});if(e)return new c(e.code,e.title,!1);throw new Error("Wrong Filter Option code specified, unable to map to: "+t)}))})),a=i[t],Promise.resolve(a);throw new Error("Unable to read layer data from service: "+r.statusText)}.bind(this));throw"Invalid layer code"},initializeUserCoords:function(e){return e&&e.id&&"00000000000"!=e.id?n({url:r.nsiApi+"address/resolve",data:{address:[e.path]},method:"POST",dataType:"json"}).then(function(e){var t=e.data;if(t&&!t.error&&0<t.coords.length)return t=[(t=t.coords[0]).longitude,t.latitude],o=t;throw new Error("Failed to resolve address, "+e.statusText)}):(o=t,Promise.resolve(o))},getHttpService:function(){return n},getUserCoords:function(){return o}}}])}(),function(){"use strict";angular.module("epgu").factory("UniversityPageService",["$rootScope","$q","$http","esiaTransportService","declineOfUnit","$moment","CatalogService","PerformanceService","DadataService",function(g,v,y,r,m,c,e,b,o){var n=[],i=[],a=[],u="DD.MM.YYYY",w=g.universityApiUrl+"orders/",l={examId:"subjectCode",examName:"subject"},S={phone:"mobilePhone",otherPassport:"otherPassportWasUsed",otherDocs:{typeId:"dictionaryActive",series:"series",number:"number",date:"issueDate",issuedBy:"issuedBy",surname:"lastName",name:"firstName",patronymic:"middleName"},certificate:{series:"seriesCert",number:"numberCert",date:"issueDateCert",issuedBy:"issuedByCert"}};return{getDescription:function(e){return{title:e.HEADER,text:e.DESCRIPTION,upload:e.UPLOAD}},getFormContent:function(){return{formStep1:{className:"FormStep",visible:!0,number:1,shaded:!0,title:"Результаты Единого Государственного Экзамена"},formStep2:{className:"FormStep",visible:!0,number:2,method:"getUniversitiesFromOrder",shaded:!0,title:"Выбор вузов и направлений подготовки"},formStep3:{className:"FormStep",visible:!0,number:3,method:"getAchievements",shaded:!0,title:"Индивидуальные достижения"},formStep4:{className:"FormStep",visible:!0,number:4,method:"getUserData",shaded:!0,title:"Персональные данные"},formStep5:{className:"FormStep",visible:!1,shaded:!1,loadedDraft:!1,number:5,method:"getPassportPhoto",title:"Загрузите копии страниц паспорта"},formStep6:{className:"FormStep",visible:!1,shaded:!1,loadedDraft:!1,number:6,method:"",title:"Загрузите фотографию абитуриента"},agreeExamResult:{parent:"formStep1",className:"FieldCheckbox",visible:!0,value:"no",checked:!1,required:!0,label:"Прошу учесть результаты сданных мною ЕГЭ по мере их опубликования и использовать при поступлении максимальные баллы"},agreePrivacy:{parent:"formStep4",className:"FieldCheckbox",visible:!0,required:!0,value:"no",checked:!1,label:"Я согласен на обработку данных, включая обработку данных вузами сроком на один год"},agreeRules:{parent:"formStep4",className:"FieldCheckbox",visible:!0,required:!0,value:"no",checked:!1,label:'Я ознакомился с фактами, перечисленными в <a target="_blank" href="https://base.garant.ru/71238710/53f89421bbdaf741eb2d1ecc4ddb4c33"> п. 66 Порядка приема на обучение по образовательным программам высшего образования</a>, а также с Уставами вузов, на поступление в которые подаю заявление'},agreeRulesYounger18:{parent:"formStep4",className:"FieldCheckbox",visible:!0,required:!0,value:"no",checked:!1,label:"Мной получено согласие родителей (законных представителей) на обработку моих данных, включая обработку данных вузами"},agreeRulesCount:{parent:"formStep4",className:"FieldCheckbox",visible:!0,required:!0,value:"no",checked:!1,label:"Я подтверждаю, что, учитывая все способы подачи заявления, подаю заявления не более чем в 5 вузов по 3 направлениям подготовки в каждом вузе"},otherPassportWasUsed:{parent:"formStep1",className:"FieldCheckbox",visible:!0,value:"no",checked:!1,label:"При сдаче ЕГЭ у меня были другие документы"},lastName:{parent:"formStep4",className:"FieldText",visible:!0,readonly:!0,value:"",label:""},firstName:{parent:"formStep4",className:"FieldText",visible:!0,readonly:!0,value:"",label:"Имя"},middleName:{parent:"formStep4",className:"FieldText",visible:!0,readonly:!0,value:"",label:"Отчество"},birthDate:{parent:"formStep4",className:"FieldText",visible:!0,readonly:!0,value:"",label:"Дата рождения"},birthPlace:{parent:"formStep4",className:"FieldText",visible:!0,readonly:!0,value:"",label:"Место рождения"},snils:{parent:"formStep4",className:"FieldText",visible:!0,readonly:!0,value:"",label:"СНИЛС"},gender:{parent:"formStep4",className:"FieldRadio",visible:!0,readonly:!0,value:"",label:""},email:{parent:"formStep4",className:"FieldText",visible:!0,readonly:!0,required:!0,value:"",label:"Электронная почта"},mobilePhone:{parent:"formStep4",className:"FieldText",required:!0,visible:!0,readonly:!0,value:"",label:"Контактный телефон"},registrationAddress:{parent:"formStep4",className:"FieldText",required:!0,visible:!0,readonly:!0,value:"",label:"Адрес регистрации"},homePhone:{parent:"formStep4",className:"FieldText",visible:!0,readonly:!1,value:"",label:"Домашний телефон"},docType:{parent:"formStep4",className:"FieldDropdown",visible:!0,required:!0,readonly:!0,value:"",textValue:""},series:{parent:"formStep4",className:"FieldText",visible:!0,required:!0,readonly:!0,value:""},number:{parent:"formStep4",className:"FieldText",visible:!0,required:!0,readonly:!0,value:""},issueDate:{parent:"formStep4",className:"FieldText",visible:!0,required:!0,readonly:!0,value:""},issueId:{parent:"formStep4",className:"FieldText",visible:!0,readonly:!0,required:!0,value:""},issuedBy:{parent:"formStep4",className:"FieldText",visible:!0,readonly:!1,required:!0,value:""},seriesOld:{parent:"formStep4",className:"FieldText",visible:!0,readonly:!1,required:!0,value:""},numberOld:{parent:"formStep4",className:"FieldText",visible:!0,readonly:!1,required:!0,value:""},issueDateOld:{parent:"formStep4",className:"FieldText",visible:!0,readonly:!1,required:!0,value:""},issuedByOld:{parent:"formStep4",className:"FieldText",visible:!0,readonly:!1,required:!0,value:""},seriesCert:{parent:"formStep4",className:"FieldText",visible:!0,readonly:!1,required:!1,value:""},numberCert:{parent:"formStep4",className:"FieldText",visible:!0,readonly:!1,required:!0,value:""},issueDateCert:{parent:"formStep4",className:"FieldText",visible:!0,readonly:!1,required:!0,value:""},issuedByCert:{parent:"formStep4",className:"FieldText",visible:!0,required:!0,readonly:!1,value:""},achievements:{parent:"formStep4",className:"FieldUpload",required:!0,name:"FieldUploadAchievements",visible:!0,readonly:!1,value:""}}},checkFormAcceptByDate:function(e){var t=v.defer(),r={},o=g.universityApiUrl+"check";return r._=Math.random(),r.fromVersion=e||0,b.measureStart("getCheck"),y({url:o,params:r,method:"GET",dataType:"json",withCredentials:!0}).then(function(e){e&&200===e.status?(b.measureEnd("getCheck",0),t.resolve()):(b.measureEnd("getCheck",1,{ServiceError:1}),t.reject({}))},function(e){b.measureEnd("getCheck",1,{BrowserError:e?e.status:""}),e&&403===e.status?t.reject({code:"finishAcceptError"}):t.reject(e)}),t.promise},checkUserByCatalogApi:function(){var t=v.defer();return g.universityCheckServiceUrl?e.checkServiceUrl("-100012345678","1001",{oldStyleCode:!0}).then(function(e){e=e?e.data:null;e&&e.length?t.reject({code:"102",isHint:e[0]}):t.resolve()},function(e){t.reject({code:"102"})}):t.resolve(),t.promise},getOrder:function(r){var o=this,n=v.defer(),e="",t="",i=g.settings,e=i&&"function"==typeof i.getPlatform?(t=i.getPlatform())?"FG-MOB-"+t.toUpperCase():"":i&&i.sessionToken?"OP-WIDGET":"BETA",t=g.lkApi+"orders?mode=createOrGetNonClosed",i=(b.measureStart("createOrGetNonClosed"),{serviceTargetCode:"-100012345678",eServiceCode:"1001",sourceSystem:e,userSelectedRegion:g.userSelectedRegion});return y({url:t,data:i,method:"POST",dataType:"json",withCredentials:!0}).then(function(e){var t;e&&200===e.status&&e.data?(t=e.data,b.measureEnd("createOrGetNonClosed",0),o.checkFormAcceptByDate(r).then(function(){n.resolve(t)},function(e){n.reject(e)})):(b.measureEnd("createOrGetNonClosed",1,{ServiceError:1}),n.reject({code:"getOrder"}))},function(e){b.measureEnd("createOrGetNonClosed",1,{BrowserError:e?e.code:""}),n.reject({code:"getOrder"})}),n.promise},getUnifiedExamResults:function(){var e=v.defer();return e.resolve(),e.promise},getUserFavorites:function(){var t=v.defer(),e=g.ppGetUserFavoritesUrl;return b.measureStart("getUserFavorite"),y({url:e,data:{entities:["organizations","specialities"]},method:"POST",headers:{Authorization:"Bearer "+r.getToken()},dataType:"json",withCredentials:!0}).then(function(e){e&&200===e.status?(b.measureEnd("getUserFavorite",0),e=e.data,t.resolve(e)):b.measureEnd("getUserFavorite",1,{ServiceError:1})},function(e){b.measureEnd("getUserFavorite",1,{BrowserError:e?e.code:""}),t.reject({error:!0})}),t.promise},getUniversities:function(e,t,r,n){var i=v.defer(),o=g.universityApiUrl+"universities",a={},s=r.length?r:[],r=void 0!==e;return r&&e.length<3?i.resolve(s):(t.id?o+=t.id:r?(a.type="name",a.name=e):(a.type="param",Object.keys(t).forEach(function(e){t[e]&&(a[e]=t[e])})),a._=Math.random(),y({url:o,params:a,method:"GET",dataType:"json",withCredentials:!0}).then(function(e){var e=e.data,o=[];e.forEach(function(e,t){var r={title:e.shortTitle,fullTitle:e.fullTitle,value:e.id,isFavorite:!1};n[e.id]||o.push(r)}),e=s.concat(o),i.resolve(e)},function(e){i.resolve(s)})),i.promise},getAchievementCategories:function(){var t=v.defer();return n.length?t.resolve({achievementCategories:n}):y({url:g.nsiApi+"dictionary/VUZ_ACHIEVEMENT_CATEGORIES",method:"POST",withCredentials:!0,data:{treeFiltering:"ONELEVEL",pageNum:1,selectAttributes:["*"],tx:""}}).then(function(e){(n=e.data.items).forEach(function(e){var t=e.attributeValues||{};e.orderNumberToNumber=isNaN(t.ORDERNUMBER)?0:parseInt(t.ORDERNUMBER,10)}),n.sort(m.sortByAttr("orderNumberToNumber")),t.resolve({achievementCategories:n})},function(e){t.resolve({achievementCategories:n,error:!0})}),t.promise},getAchievementCategoriesChilds:function(e){var t=v.defer();return t.resolve({items:[]}),t.promise},getRegions:function(){var t=v.defer();return i.length?t.resolve({regions:i}):y({url:g.nsiApi+"dictionary/VUZ_REGIONS",method:"POST",withCredentials:!0,data:{treeFiltering:"ONELEVEL",pageNum:1,selectAttributes:["*"],tx:""}}).then(function(e){i=e.data.items,t.resolve({regions:i})},function(e){t.resolve({regions:i,error:!0})}),t.promise},getUserDocs:function(){var t=v.defer();return a.length?t.resolve({userDocs:a}):y({url:g.nsiApi+"dictionary/VUZ_DOCUMENT_TYPES",method:"POST",withCredentials:!0,data:{treeFiltering:"ONELEVEL",pageNum:1,selectAttributes:["*"],filter:{union:{unionKind:"AND",subs:[{simple:{attributeName:"ID_CATEGORY",condition:"EQUALS",value:{asString:"1"}}},{simple:{attributeName:"ACTUAL",condition:"EQUALS",value:{asString:"true"}}}]}},tx:""}}).then(function(e){e=e.data;e&&e.items.length&&(a=e.items),t.resolve({userDocs:a})},function(e){t.resolve({userDocs:a,error:!0})}),t.promise},getDocItem:function(){var t=v.defer();return this.getUserDocs().then(function(e){t.resolve({item:item})}),t.promise},setSelectedGroups:function(e,r){var t=!1,o=!1,n=-1;e.length?e.forEach(function(e,t){r.isSelect?e.id===r.id&&(o=!0):(e.id===r.id&&(n=t),o=!0)}):t=!0,!t&&o||e.push(r),~n&&e.splice(n,1)},setUserDataToForm:function(e,o,t){var n=this,i=["series","issueDate","number","issuedBy","issueId"],a=["lastName","firstName","snils","gender","email","birthDate","registrationAddress"];t.forEach(function(t){var r;"RF_PASSPORT"===t?(o.docType.value="Паспорт РФ",o.docType.readonly=!0,(r=e.docs.find(function(e){return e.type===t}))&&i.forEach(function(e){o[e].value=r[e],o[e].readonly=!0})):(o[t].value="mobilePhone"===t?n.getPhoneRawData(e[t]):e[t],~a.indexOf(t)?o[t].readonly=!0:o[t].readonly=!!e[t])})},getPhoneRawData:function(e){return e=(e=0===e.indexOf("+")?e.substr(2):e).replace(/[^0-9\.]+/g,"")},getGenders:function(){return{M:{label:"M",icon:"M",value:"M"},F:{label:"Ж",icon:"F",value:"F"}}},getPrices:function(){return{budget:{label:"Только с бюджетными местами",value:"budget"},paid:{label:"Платные места",value:"paid"}}},onAddedItemWrapper:function(e){var t=v.defer();return t.resolve(e),t.promise},removeFile:function(e,t){var r=v.defer();return y({url:g.formPlayerStorageUrl+"/"+e+"/2?mnemonic="+t,method:"DELETE",dataType:"json",withCredentials:!0,noTestScope:!0}).then(function(e){r.resolve()},function(e){r.resolve()}),r.promise},removeFiles:function(t,e){var r=this;e.forEach(function(e){r.removeFile(t,e)})},saveExamsResults:function(e,n){var i=this.getOrderId(),t=v.defer(),a=[],s=moment().format("DD.MM.YYYY"),e=(e.forEach(function(t){var e,r={orderId:i,manual:n,examCheckDate:s},o=1===t.points.length?t.points[0]:t.points.find(function(e){return e.value===t.selected.value});for(e in l)l.hasOwnProperty(e)&&(r[e]=o[l[e]]);a.push(r)}),w+i+"/ege");return b.measureStart("postEge"),y({url:e,method:"POST",dataType:"json",data:a,withCredentials:!0,noTestScope:!0}).then(function(e){e&&200===e.status?(b.measureEnd("postEge",0),t.resolve()):(b.measureEnd("postEge",1,{ServiceError:1}),t.reject(error))},function(e){b.measureEnd("postEge",1,{BrowserError:e?e.code:""}),t.reject(e)}),t.promise},getExamsResults:function(){var e=this.getOrderId(),t=v.defer(),e=w+e+"/ege";return b.measureStart("getEge"),y({url:e,method:"GET",params:{_:Math.random()},dataType:"json",withCredentials:!0,noTestScope:!0}).then(function(e){var a;e&&200===e.status?(b.measureEnd("getEge",0),e=e.data,a=[],e&&e.forEach(function(e){var t={title:e.examName,points:[],examCheckDate:e.examCheckDate},r=m.get(e.examGrade,["балл","балла","баллов"]),o="(результаты "+e.examYear+")",n=e.examGrade||0,i=e.examYear||2020,n={point:n,pointDigit:n,subject:e.examName,subjectCode:e.examId,title:n+" "+r+" "+o,value:n+"_"+i,year:i,yearText:" "+o,pointText:r,examCheckDate:e.examCheckDate};t.points.push(n),a.push(t)}),t.resolve(a)):(t.reject(),b.measureEnd("getEge",1,{ServiceError:1}))},function(e){b.measureEnd("getEge",1,{BrowserError:e?e.code:""}),t.reject(e)}),t.promise},deleteExamsResult:function(e){var t=this.getOrderId(),r=v.defer(),t=w+t+"/ege/"+e;return b.measureStart("deleteEge"),y({url:t,method:"DELETE",dataType:"json",withCredentials:!0,noTestScope:!0}).then(function(e){e&&200===e.status?b.measureEnd("deleteEge",0):b.measureEnd("deleteEge",1,{ServiceError:1}),r.resolve()},function(e){b.measureEnd("deleteEge",1,{BrowserError:e?e.code:""}),r.resolve()}),r.promise},saveUniversities:function(t){var n=this.getOrderId(),r=v.defer(),i=[],a={},o=this,e=w+n+"/group";return t.forEach(function(o){o.specialities.forEach(function(r){r.contestGroups.forEach(function(e){var t;e.wasSaved&&o.wasSavedNeedHostel===o.needHostel||(t={childOrderId:0,orderId:n,orgId:o.id,directionId:r.id,groupId:e.id,ppOrg:o.isFavorite,ppDirection:!!r.isFavorite,ppGroup:!!e.isFavorite,needHostel:o.needHostel},e.itemId?t.itemId=e.itemId:a[e.id]=!0,i.push(t))})})}),i.length?(b.measureStart("postGroup"),y({url:e,method:"POST",dataType:"json",data:i,withCredentials:!0,noTestScope:!0}).then(function(e){e&&200===e.status?(b.measureEnd("postGroup",0),o.getUniversitiesFromOrder("temp").then(function(e){e&&e.selectedGroups&&e.selectedGroups.forEach(function(e){a[e.groupId]=e.itemId}),t.forEach(function(e){e.wasSavedNeedHostel=e.needHostel,e.specialities.forEach(function(e){e.contestGroups.forEach(function(e){a[e.id]&&"boolean"!==a[e.id]&&(e.itemId=a[e.id]),e.wasSaved=!0})})}),r.resolve()},function(e){t.forEach(function(e){e.wasSavedNeedHostel=e.needHostel,e.specialities.forEach(function(e){e.contestGroups.forEach(function(e){e.wasSaved=!0})})}),r.resolve()})):(b.measureEnd("postGroup",1,{ServiceError:1}),r.reject())},function(e){b.measureEnd("postGroup",1,{BrowserError:e?e.code:""}),r.reject(e)})):r.resolve(),r.promise},deleteUniversity:function(t){var e=this.getOrderId(),r=v.defer(),e=w+e+"/group/"+t;return b.measureStart("deleteGroup"),y({url:e,method:"DELETE",dataType:"json",withCredentials:!0,noTestScope:!0}).then(function(e){e&&200===e.status?b.measureEnd("deleteGroup",0):b.measureEnd("deleteGroup",1,{ServiceError:1}),r.resolve()},function(e){b.measureEnd("deleteGroup",1,{BrowserError:e?e.code:""}),r.reject(e,t)}),r.promise},deleteGroupsFromEdit:function(t){var e=this.getOrderId(),r=v.defer(),e=w+e+"/cancel";return t.length?(b.measureStart("deleteGroups"),y({url:e,method:"DELETE",dataType:"json",data:t,withCredentials:!0,noTestScope:!0}).then(function(e){e&&200===e.status?b.measureEnd("deleteGroups",0):b.measureEnd("deleteGroups",1,{ServiceError:1}),r.resolve()},function(e){b.measureEnd("deleteGroups",1,{BrowserError:e?e.code:""}),r.reject(e,t)})):r.resolve(),r.promise},getSelectedGroupsByIds:function(e){var t=v.defer(),r=[],o={ids:e,_:Math.random()},n=g.universityApiUrl+"universities/byGroups";return e?(b.measureStart("getUniversitiesByGroups"),y({url:n,method:"GET",params:o,dataType:"json",withCredentials:!0,noTestScope:!0}).then(function(e){e&&200===e.status?(b.measureEnd("getUniversitiesByGroups",0),r=e.data,t.resolve(r)):(b.measureEnd("getUniversitiesByGroups",1,{ServiceError:1}),t.reject())},function(e){b.measureEnd("getUniversitiesByGroups",1,{BrowserError:e?e.code:""}),t.reject(e)})):t.resolve(r),t.promise},setGroupsIds:function(e){this.groupsIds=e},getGroupsIds:function(){return this.groupsIds?this.groupsIds.concat():[]},clearGroupsIds:function(){this.groupsIds&&(this.groupsIds.length=0)},setUniversityIds:function(e){this.universityIds=e},getUniversityIds:function(){return this.universityIds?this.universityIds.concat():[]},clearUniversityIds:function(){this.universityIds&&(this.universityIds.length=0)},setAchievementsData:function(e){this.achievementsData=e},getAchievementsData:function(){return this.achievementsData?this.achievementsData.concat():[]},clearAchievementsData:function(){this.achievementsData&&(this.achievementsData.length=0)},getUniversitiesFromOrder:function(u){var e=this.getOrderId(),d=v.defer(),p=this,e=w+e+"/group";return b.measureStart("getGroup"),y({url:e,method:"GET",dataType:"json",params:{_:Math.random()},withCredentials:!0,noTestScope:!0}).then(function(e){e&&200===e.status?b.measureEnd("getGroup",0):b.measureEnd("getGroup",1,{ServiceError:1});var e=e.data,o={},t={},n={},i={},a={},r=[],s=[],l="",c=["группы","групп","групп"];"temp"!==u?(e&&e.organizations&&e.organizations.length&&e.organizations.forEach(function(e){s.push(e.orgId),e.ppOrg&&(t[e.orgId]=!0),e.directions&&e.directions.length&&e.directions.forEach(function(e){e.ppDirection&&(n[e.directionId]=!0)})}),e&&e.selectedGroups&&(e.selectedGroups.forEach(function(e){o[e.groupId]=e.itemId,!(i[e.groupId]=!0)===e.editable&&"1"===u&&(a[e.groupId]=!0)}),Object.keys(o).forEach(function(e,t){r.push(e),l+=e+"|"})),p.setGroupsIds(r),p.setUniversityIds(s),p.getSelectedGroupsByIds(l).then(function(e){e.forEach(function(r){r.wasSavedNeedHostel=!1,r.originalSpecialitiesLength=r.totalTrainingAreasCount,r.originalSpecialitiesLengthText=m.get(r.totalTrainingAreasCount,["направления","направлений","направлений"]),r.isFavorite=!!t[r.id],r.specialities=r.trainingAreas.map(function(t){return t.contestGroups.forEach(function(e){e.needHostel&&(r.needHostel=!0,r.wasSavedNeedHostel=!0),a[e.id]&&(t.editable=!1,e.editable=!1),e.itemId=o[e.id],e.isSelect=!0,e.wasSaved=!0,e.isFavorite=!!i[e.id]}),{id:t.id,name:t.name,editable:t.editable,isFavorite:!!n[t.id],selectedGroups:t.contestGroups?t.contestGroups.length:0,originalGroupsLength:t.totalContentGroupsCount,selectedGroupsText:m.get(t.totalContentGroupsCount,c),contestGroups:t.contestGroups}})}),d.resolve(e)},function(e){d.reject(e)})):d.resolve(e)},function(e){b.measureEnd("getGroup",1,{BrowserError:e?e.code:""}),d.reject(e)}),d.promise},saveAchievement:function(t,e){var r,o=this.getOrderId(),n=v.defer();return e?n.resolve({achievement:t}):(r={achievementId:isNaN(t.value)?0:parseInt(t.value,10),files:[],orderId:o},t.categoryValue&&(r.childAchievementId=t.categoryValue),t.serverId&&(r.id=t.serverId),e=w+o+"/achievements",t.files.forEach(function(e){r.files.push(e.mnemonic)}),13==t.value&&t.otherDescription&&(r.comment=t.otherDescription),b.measureStart("postAchievements"),y({url:e,method:"POST",dataType:"json",data:r,withCredentials:!0,noTestScope:!0}).then(function(e){e&&200===e.status?(n.resolve({achievement:t,serverId:e.data}),b.measureEnd("postAchievements",0)):(b.measureEnd("postAchievements",1,{ServiceError:1}),n.reject({code:"postAchievements"}))},function(e){b.measureEnd("postAchievements",1,{BrowserError:e?e.code:""}),n.reject(e)})),n.promise},getAchievements:function(){var l=this,e=this.getOrderId(),o=v.defer(),e=w+e+"/achievements";return b.measureStart("getAchievements"),y({url:e,method:"GET",dataType:"json",params:{_:Math.random()},withCredentials:!0,noTestScope:!0}).then(function(e){e&&200===e.status?b.measureEnd("getAchievements",0):b.measureEnd("getAchievements",1,{ServiceError:1});var t=e.data;t&&t.length?(l.setAchievementsData(t.concat()),l.getAchievementCategories().then(function(e){var i=e.achievementCategories,a=[],s=[];t.forEach(function(e){var t=e.achievementId,o=0,r=i.find(function(e){return e.value==t}),n=l.getDescription(r&&r.attributeValues||{}),r={title:r&&r.title||"",value:t,id:t,serverId:e.id,description:n,categoryValue:e.childAchievementId||"",otherDescription:e.comment,trbError:!1};e.files&&e.files.length&&(r.files=e.files.map(function(e){var t="",r=(e.name||"").split(".");return e.name||(o++,e.trbError=!0),e.mimeType?t=e.mimeType:r&&1<r.length&&(t=r[r.length-1]),{name:e.name,size:e.size||e.files,loadingPercent:100,loaded:!0,type:t,mnemonic:e.mmemonic,trbError:e.trbError}})),o&&(o===r.files.length?(r.trbErrorText=1===o?"Не удалось загрузить файл. Удалите достижение, приложите другой файл или попробуйте загрузить файл еще раз":"Не удалось загрузить несколько файлов. Удалите достижение, приложите другой файл или попробуйте загрузить файлы еще раз",r.trbErrorAll=!0):(r.trbError=!0,r.trbErrorText=1===o?"Не удалось загрузить еще один файл. Попробуйте загрузить его еще раз, чтобы он был учтен при поступлении":"Не удалось загрузить несколько файлов. Попробуйте загрузить их еще раз, чтобы они были учтены при поступлении")),s.push(l.getAchievementCategoriesChilds(r.categoryValue?r.value:"")),a.push(r)}),v.all(s).then(function(r){a.forEach(function(t,e){t.categoryValue&&r[e].items&&r[e].items.length&&(e=r[e].items.find(function(e){return e.value==t.categoryValue}))&&(t.categoryTitle=e.title)}),o.resolve(a)})})):o.resolve([])},function(e){o.reject(e),b.measureEnd("getAchievements",1,{BrowserError:e?e.code:""})}),o.promise},deleteAchievement:function(t,e){var r=this.getOrderId(),o=v.defer();return t&&"2"!==e?(e=w+r+"/achievements/"+t,b.measureStart("deleteAchievements"),y({url:e,method:"DELETE",dataType:"json",withCredentials:!0,noTestScope:!0}).then(function(e){e&&200===e.status?b.measureEnd("deleteAchievements",0):b.measureEnd("deleteAchievements",1,{ServiceError:1}),o.resolve()},function(e){b.measureEnd("deleteAchievements",1,{BrowserError:e?e.code:""}),o.reject(e,t)})):o.resolve(),o.promise},deleteAchievementFile:function(t,r){var e=this.getOrderId(),o=v.defer();return t&&r?(e=w+e+"/achievements/"+t+"/file?"+("mnemonic="+r),b.measureStart("deleteAchievementsFile"),y({url:e,method:"DELETE",dataType:"json",withCredentials:!0,noTestScope:!0}).then(function(e){e&&200===e.status?b.measureEnd("deleteAchievementsFile",0):b.measureEnd("deleteAchievementsFile",1,{ServiceError:1}),o.resolve()},function(e){b.measureEnd("deleteAchievementsFile",1,{BrowserError:e?e.code:""}),o.reject(e,t,r)})):o.resolve(),o.promise},saveUserData:function(t,e,r,n){var o=this.getOrderId(),i=v.defer(),a={orderId:o},s=this,e=(Object.keys(S).forEach(function(o){"string"!=typeof S[o]?"otherDocs"!==o?(a[o]={},Object.keys(S[o]).forEach(function(e){a[o][e]=t[S[o][e]].value||("certificate"===o&&"series"===e?"нет":"")})):(a[o]=[],t[S.otherPassport].checked&&r.forEach(function(t){var r={};Object.keys(S[o]).forEach(function(e){"issueDate"!==S[o][e]||s.checkDatePickerValue(t[S[o][e]])?r[e]=t[S[o][e]].value:r[e]=""}),a[o].push(r)})):"otherPassport"!==o&&(a[o]="phone"===o?n.replace(/\s/g,""):t[S[o]].value)}),e&&e.length&&(a.files=e.map(function(e){return e.mnemonic})),a.registrationAddr={FullStr:t.registrationAddress.value},t.registrationAddressCode.value&&(a.registrationAddr.VuzRegion=t.registrationAddressCode.value),w+o+"/data");return b.measureStart("postData"),y({url:e,method:"POST",dataType:"json",data:a,withCredentials:!0,noTestScope:!0}).then(function(e){e&&200===e.status?(b.measureEnd("postData",0),i.resolve()):(b.measureEnd("postData",1,{ServiceError:1}),i.reject({code:"saveUserData"}))},function(e){b.measureEnd("postData",1,{BrowserError:e?e.code:""}),i.reject({code:"saveUserData"})}),i.promise},getUserData:function(n){var i=this,e=this.getOrderId(),a=v.defer(),s=[],l=[],e=w+e+"/data";return b.measureStart("getData"),y({url:e,method:"GET",params:{_:Math.random()},dataType:"json",withCredentials:!0,noTestScope:!0}).then(function(e){e&&200===e.status?b.measureEnd("getData",0):b.measureEnd("getData",1,{ServiceError:1});var t=e.data;if(200===e.status&&t){for(var r in S)if(S.hasOwnProperty(r))if("string"!=typeof S[r]){if("otherDocs"!==r)for(var o in S[r])S[r].hasOwnProperty(o)&&("date"===o&&t[r][o]?n[S[r][o]].value=c(t[r][o],u).format(u):n[S[r][o]].value=t[r][o])}else"otherPassport"!==r&&(n[S[r]].value="phone"===r?i.getPhoneRawData(t[r]):t[r]);t.otherDocs&&t.otherDocs.length&&(t.otherDocs.forEach(function(e){e.date&&(e.date=c(e.date,u).format(u))}),l=t.otherDocs),t.metaFiles&&t.metaFiles.length&&(s=t.metaFiles.map(function(e){var t=e.fileName.split("."),r="";return e.mimeType?r=e.mimeType:t&&1<t.length&&(r=t[t.length-1]),{name:e.fileName,size:e.fileSize,type:r,mnemonic:e.mnemonic,loaded:!0,loadingPercent:100,defer:v.defer()}}))}a.resolve({files:s,otherDocs:l,formMapOtherDocs:S.otherDocs,dateFormat:u})},function(e){b.measureEnd("getData",1,{BrowserError:e?e.code:""}),a.reject(e)}),a.promise},formPush:function(){var t=v.defer(),r=this.getOrderId(),e=w+r+"/push";return b.measureStart("push"),y({url:e,method:"POST",dataType:"json",withCredentials:!0,noTestScope:!0}).then(function(e){e&&200===e.status?(b.measureEnd("push",0),t.resolve({orderId:r})):(b.measureEnd("push",1,{ServerError:1}),t.reject({universitiesEmpty:!0,error:!0}))},function(e){b.measureEnd("push",1,{BrowserError:e?e.code:""}),e&&e.status?409===e.status?t.reject({code:"fileStorageError",achievements:e.data}):403===e.status?t.reject({code:"finishAcceptErrorFromPush"}):t.reject({code:"submitError"}):t.reject({code:"submitError"})}),t.promise},saveUniversitiesFromEdit:function(e,t){var r=v.defer(),o=this.getOrderId();return b.measureStart("push"),y({url:w+o+"/push/1",method:"POST",data:{newItems:e,groupIdsForCancel:t},dataType:"json",withCredentials:!0,noTestScope:!0}).then(function(e){e&&200===e.status?(b.measureEnd("push",0),r.resolve({orderId:o})):(b.measureEnd("push",1,{ServiceError:1}),r.reject({universitiesEmpty:!0,error:!0}))},function(e){b.measureEnd("push",1,{BrowserError:e?e.code:""}),403===e.status?r.reject({code:"finishAcceptErrorFromPush"}):r.reject({code:"submitError"})}),r.promise},setOrderId:function(e){this.orderId=e},getOrderId:function(){return this.orderId},setChildOrderId:function(e){this.childOrderId=e},getChildOrderId:function(){return this.childOrderId},setReachGoalStaticParams:function(e){this.staticParams=e},getReachGoalStaticParams:function(){return this.staticParams},sendReachGoal:function(e,t){var r=this.getReachGoalStaticParams(),o={},e=(e&&(o={action:e}),angular.extend(o,r));t?metricReachGoal24845174("otherGoal",e):metricReachGoal24845174("universityOrder",e)},validateByPattern:function(e,t){return e.lastIndex=0,e.test(t)},checkDatePickerValue:function(e){return!!((e.value||"").replace(/(_)|(\.)/g,"")||e.required||e.requiredTo)||""},validateByLimits:function(e,t,r){var o,n,i,a="",s=e.limits,t=t.replace(/_/g,""),l=c(t,u);if(10!==t.length||!l.isValid())return a=this.checkDatePickerValue(e)?"incorrect":a;for(o in s)if(s.hasOwnProperty(o))switch(o){case"after":a||l.isSameOrBefore(c().endOf("day"))||(a=o);break;case"byField":a||(i=(n=s[o].split("|"))[0],">"!==n[1])||l.isAfter(c(r[i].value,u),"day")||(a=o)}return a},saveEditUserData:function(s,l,c,e,u,t,d){var p=v.defer(),m=this.getOrderId(),h=this,f=w+m+"/push/2";return b.measureStart("push"),v.all([this.saveEditAchievements(l),this.saveCertFiles(c,e,t)]).then(function(e){var o,t,r={persData:{},achievements:[]},n={orderId:m},i=e[0].removedFiles.concat(e[1].removedFiles);for(o in S)if(S.hasOwnProperty(o))if("string"!=typeof S[o])if("otherDocs"!==o)for(var a in n[o]={},S[o])S[o].hasOwnProperty(a)&&(t="certificate"===o&&"series"===a,n[o][a]=s[S[o][a]].value||(t?"нет":""));else n[o]=[],s[S.otherPassport].checked&&u.forEach(function(e){var t,r={};for(t in S[o])S[o].hasOwnProperty(t)&&("issueDate"!==S[o][t]||h.checkDatePickerValue(e[S[o][t]])?r[t]=e[S[o][t]].value:r[t]="");n[o].push(r)});else"otherPassport"!==o&&(n[o]="phone"===o?d.replace(/\s/g,""):s[S[o]].value);c&&c.length&&(n.files=c.map(function(e){return e.mnemonic})),r.persData=n,l&&l.length&&l.forEach(function(e){var t={achievementId:isNaN(e.value)?0:parseInt(e.value,10),files:[],orderId:m};e.categoryValue&&(t.childAchievementId=e.categoryValue),e.serverId&&(t.id=e.serverId),e.files&&e.files.length&&e.files.forEach(function(e){t.files.push(e.mnemonic)}),r.achievements.push(t)}),y({url:f,method:"POST",data:r,dataType:"json",withCredentials:!0,noTestScope:!0}).then(function(e){e&&200===e.status?(i.length&&i.forEach(function(e){h.removeFile(h.getOrderId(),e)}),b.measureEnd("push",0),p.resolve({orderId:m})):(b.measureEnd("push",1,{ServiceError:1}),p.reject({code:"submitError"}))},function(e){b.measureEnd("push",1,{BrowserError:e?e.code:""}),403===e.status?p.reject({code:"finishAcceptErrorFromPush"}):p.reject({code:"submitError"})})},function(e){p.reject({code:"submitError"})}),g.$emit("uploader-launch"),p.promise},pushFormV3:function(o){var n=v.defer(),i=this.getOrderId(),a=this,s=w+i+"/push/3";return b.measureStart("push3"),v.all([a.saveUserPhotoData(o.passport,[],o.editMode,"passportFiles"),a.saveUserPhotoData(o.user,[],o.editMode,"userPhotoFiles")]).then(function(e){var t=o.user[0].mnemonic,r=o.passport[0].mnemonic,t={childOrderId:a.getChildOrderId(),photoFileMnemonic:t,documentFileMnemonic:r};y({url:s,method:"POST",data:t,dataType:"json",withCredentials:!0,noTestScope:!0}).then(function(e){e&&200===e.status?(b.measureEnd("push3",0),n.resolve({orderId:i})):(b.measureEnd("push3",1,{ServiceError:1}),n.reject({code:"submitErrorPush3"}))},function(e){b.measureEnd("push3",1,{BrowserError:e?e.status:""}),n.reject({code:"submitErrorPush3"})})},function(e){n.reject(e)}),g.$emit("uploader-launch"),n.promise},saveEditAchievements:function(e){var t,r=v.defer(),o=this.getAchievementsData(),n={},i=[],a=[];for(t in o.forEach(function(t){n[t.achievementId]={needRemove:!0},t.files&&t.files.length&&(n[t.achievementId].files={},t.files.forEach(function(e){n[t.achievementId].files[e.mmemonic]=!0}))}),e.forEach(function(t){n[t.id]?(n[t.id].needRemove=!1,t.files&&t.files.length&&t.files.forEach(function(e){n[t.id].files[e.mnemonic]?n[t.id].files[e.mnemonic]=!1:e.loaded||(e.defer=v.defer(),a.push(e.defer.promise))})):t.files&&t.files.length&&t.files.forEach(function(e){e.loaded||(e.defer=v.defer(),a.push(e.defer.promise))})}),n)if(n.hasOwnProperty(t))if(n[t].needRemove){if(n[t].files)for(var s in n[t].files)n[t].files.hasOwnProperty(s)&&i.push(s)}else if(n[t].files)for(var l in n[t].files)n[t].files.hasOwnProperty(l)&&n[t].files[l]&&i.push(l);return v.all(a).then(function(){r.resolve({removedFiles:i})},function(){r.reject()}),r.promise},saveCertFiles:function(e,t,r){var o,n=this.getOrderId(),i=v.defer(),a=[],s={},l=[],c=[];for(o in t&&t.length&&t.forEach(function(e){e.mnemonic&&e.loaded&&(s[e.mnemonic]=!0)}),e.forEach(function(e){s[e.mnemonic]&&(s[e.mnemonic]=!1),e.loaded||(e.defer=v.defer(),a.push(e.defer.promise))}),s)s.hasOwnProperty(o)&&s[o]&&(r?l.push(o):c.push(this.removeFile(n,o)));return v.all(c).then(function(){v.all(a).then(function(){i.resolve({removedFiles:l})},function(){i.reject({code:"uploadCertFiles"})}),r||g.$emit("uploader-launch")},function(e){i.reject({code:"deleteCertFiles"})}),i.promise},saveUserPhotoData:function(e,t,r,o){var n,i=this.getOrderId(),a=v.defer(),s=[],l={},c=[],u=[];for(n in t&&t.length&&t.forEach(function(e){e.mnemonic&&e.loaded&&(l[e.mnemonic]=!0)}),e.forEach(function(e){l[e.mnemonic]&&(l[e.mnemonic]=!1),e.loaded||(e.defer=v.defer(),s.push(e.defer.promise))}),l)l.hasOwnProperty(n)&&l[n]&&(r?c.push(n):u.push(this.removeFile(i,n)));return v.all(u).then(function(){v.all(s).then(function(){a.resolve({removedFiles:c})},function(){a.reject({code:o+"UploadError"})})},function(e){a.reject({code:o+"DeleteError"})}),a.promise},checkOrderModeV3:function(e){var t=this.getOrderId();return y({url:w+t+"/allowedSendAdditionalFiles",params:{_:Math.random()},method:"GET",dataType:"json",withCredentials:!0,noTestScope:!0})},checkOrderMode:function(r){var o=this,n=v.defer(),e=this.getOrderId(),e=w+e+"/details";return r?"3"===r?this.checkOrderModeV3(r).then(function(e){var t=e.data;200===e.status&&t&&t.length&&1===t.length?(o.setChildOrderId(t[0]),n.resolve({editMode:r})):n.reject({code:"submitErrorPush3"})},function(e){n.reject({code:"submitErrorPush3"})}):y({url:e,params:{_:Math.random()},method:"GET",dataType:"json",withCredentials:!0,noTestScope:!0}).then(function(e){200===e.status&&(e=e.data).rights&&e.rights.length?"1"===r?~e.rights.indexOf("editGroup")?n.resolve({editMode:r}):n.reject({code:"checkOrderMode"}):"2"===r&&~e.rights.indexOf("crudPersonalData")?n.resolve({editMode:r}):n.reject({code:"checkOrderMode"}):n.reject({code:"checkOrderMode"})},function(e){n.reject({code:"checkOrderMode"})}):n.resolve({editMode:""}),n.promise},setKladrCode:function(e,t){o.normalizeDadataAddress({q:e,_:Math.random()},function(e){e=(e.address&&e.address.elements||[]).find(function(e){return 1===e.level});t.value=e.kladrCode?+e.kladrCode.substring(0,2):null},function(e){})}}}]).factory("LoadUUIDJS",["$rootScope","$q",function(o,n){return{isLoadedUUIDJS:!1,loadScript:function(){var e=this,t=n.defer(),r=o.staticDomainUrl+"htdocs/js/js/university/uuidv4.min-b1bb39fcc4.1682593322983.js";return this.isLoadedUUIDJS?t.resolve():window.loadJSAsync([r],function(){e.isLoadedUUIDJS=!0,t.resolve()},function(){t.reject()}),t.promise}}}]).factory("declineOfUnit",function(){return{get:function(e,t){return t[e%10==1&&e%100!=11?0:2<=e%10&&e%10<=4&&(e%100<10||20<=e%100)?1:2]},sortByAttr:function(r,e){return e?function(e,t){return t[r]>e[r]?1:-1}:function(e,t){return e[r]>t[r]?1:-1}}}})}(),function(){"use strict";angular.module("profileConfig",[]).factory("ConfigService",[function(){return{orgRoles:{admin:{key:"admin",value:"Администратор организации",desc:"Может все, за исключением подачи заявлений на получение услуг от лица организации."},chief:{key:"chief",value:"Руководитель организации"},draftAccess:{key:"draftAccess",value:"Создатель черновиков",desc:"Может создавать черновки заявлений на получение услуг, но не может подавать их от лица организации."},noRight:{key:"noRight",value:"Сотрудник организации",desc:"Может просматривать общую информацию на портале и писать обращения в службу поддержки."}}}}])}(),function(){"use strict";angular.module("healthCard",["ngRoute","ui.mask"]).config(["$routeProvider",function(r){var o={"/94757/form":{redirectTo:function(e,t){return t.replace("/94757/form","/94757/1/form")}},"/94757/1/form":{controller:"healthCardCtrl",templateUrl:window.templatePath+"/tpl/healthCard/"+(SmartPhone.isAny()?SmartPhone.isPhone()?"health-card-mob.html":"health-card-pad.html":"health-card.html")}};Object.keys(o).forEach(function(e){var t=o[e];"/94757/form"!==e&&(t.resolve=t.resolve||{},t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}]),r.whenAuthorized(e,o[e]).whenAuthorized(e+"/o/:okato",t)})}]).controller("healthCardCtrl",["$scope","$rootScope","CatalogService","$moment","PerformanceService","RegionService",function(r,e,t,o,n,i){function a(){r.healthCard.error={},r.healthCard.error.title="Что-то пошло не так!",r.healthCard.error.text="В данный момент сервис недоступен. Попробуйте позже."}function s(){r.healthCard.emptyCardList=!0}function l(){n.measureStart("medicalCardInformer"),t.healthCard(!0).then(function(e){var t;e.error&&0!=e.error.errorCode?(n.measureEnd("medicalCardInformer",1,{BrowserError:e.error.errorCode}),a()):e&&e.content&&(n.measureEnd("medicalCardInformer",0),(e=JSON.parse(e.content)).elements)&&e.elements.length?(e.elements=(t=e.elements,angular.forEach(t,function(e){e.cureStartDate=e.cureStartDate&&e.cureStartDate.split("-").reverse().join("."),e.cureEndDate=e.cureEndDate&&e.cureEndDate.split("-").reverse().join(".")}),t),r.healthCard.places=e.elements,t=e.elements,r.healthCard.placesFiltered=[],t.reduce(function(e,t){return e.indexOf(t.moName)<0&&(e.push(t.moName),r.healthCard.placesFiltered.push(t)),e},[]),r.healthCard.placesFiltered.unshift({moName:"Все медицинские организации",isLabel:!0})):(n.measureEnd("medicalCardInformer",0),s()),r.loading=!1},function(e){e&&e.status&&n.measureEnd("medicalCardInformer",1,{ServiceError:e.status}),a(),r.loading=!1})}e.pageNameCls="group-health catalog-page passport-page health-card guideline",r.loading=!0,r.regionNotSupported=!1,e.breadcrumbs=[{text:"Категории услуг",href:"/category"},{text:"Моё здоровье",href:"/category/health"},{text:"Сведения об оказанной медицинской помощи"}],r.healthCard={title:"Сведения об оказанной медицинской помощи",icon:"https://gu-st.ru/content/catalog/pas/23.svg",place:{moName:"Все медицинские организации",isLabel:!0},changePlace:function(e){e.isLabel?r.filterByMoName=!1:r.filterByMoName=e.moName}},"AL10"===e.assuranceLevel||"P"!==e.userType?(r.error=!0,r.loading=!1):i.check(!0,"94757").then(function(e){e?l():(r.loading=!1,r.regionNotSupported=!0)})}])}(),function(){"use strict";angular.module("pfr",["ngRoute","ui.mask"]).config(["$routeProvider",function(r){var o={"/10042/form":{redirectTo:function(e,t){return t.replace("/10042/form","/10042/1/form")}},"/orders/result/:id":{controller:"pfrInfo",templateUrl:window.templatePath+"/tpl/pfr/"+(SmartPhone.isAny()?SmartPhone.isPhone()?"pfr-info-mob.html":"pfr-info-pad.html":"pfr-info.html"),resolve:{loadPfrCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/pfr-3a6d90ce41.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/pfr-min-e99d639e64.1682593322983.js")}]}}};Object.keys(o).forEach(function(e){var t=o[e];"/10042/form"!==e&&(t.resolve=t.resolve||{},t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}]),r.whenAuthorized(e,o[e]).whenAuthorized(e+"/o/:okato",t)})}])}(),function(){"use strict";angular.module("kndForm",["ngRoute","ui.mask"]).config(["$routeProvider",function(r){var o={};o["/"+window.kndUrl+"form"]={controller:"kndCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()?"/tpl/knd/knd-form-mob-c82256dcdc.html":"/tpl/knd/knd-form-pad-ca1d516515.html":"/tpl/knd/knd-form-ef55b3df57.html"),resolve:{checkKndEnabled:["KndFormService",function(e){e.redirectToMain()}],loadKndCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/knd-1b605496bd.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/knd-min-20579b2fed.1682593322983.js")}]}},o["/"+window.kndUrl+"form/:erpid"]={redirectTo:function(e,t){return e.type&&"results"===e.type?"/"+window.kndUrl+"form/results/"+e.erpid:e.type&&"documents"===e.type?"/"+window.kndUrl+"form/documents/"+e.erpid:"/"+window.kndUrl+"form/info/"+e.erpid}},o["/"+window.kndUrl+"form/:kndDetailsTab/:erpid/:objectNumber?"]={controller:"kndDetailsCtrl",redirectTo:function(e,t){if(!e.kndDetailsTab||!["info","results","documents"].includes(e.kndDetailsTab))return"/"+window.kndUrl+"form/info/"+e.erpid},templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()?"/tpl/knd/knd-details-main-mob-266cb8b382.html":"/tpl/knd/knd-details-main-pad-5b0eee1507.html":"/tpl/knd/knd-details-main-192279cc90.html"),resolve:{checkKndEnabled:["KndFormService",function(e){e.redirectToMain()}],loadKndDetailsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/knd-1b605496bd.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/knd-min-20579b2fed.1682593322983.js")}]}},Object.keys(o).forEach(function(e){var t=o[e];t.resolve?(t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}],r.whenAuthorized(e,o[e]).whenAuthorized(e+"/o/:okato",t)):r.whenAuthorized(e,o[e])})}])}(),function(){"use strict";angular.module("nps",["ngRoute","ui.mask"]).config(["$routeProvider",function(e){e.whenAuthorized("/nps/:reestrId",{controller:"npsCtrl",templateUrl:window.templatePath+"/tpl/nps/nps-be6c8f49dd.html"}).whenAuthorized("/nps/:reestrId/o/:okato",{controller:"npsCtrl",templateUrl:window.templatePath+"/tpl/nps/nps-be6c8f49dd.html",resolve:{checkRegionCtrl:["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}]}})}]).controller("npsCtrl",["$scope","$rootScope","$routeParams","$location","npsService",function(a,e,t,r,o){a.user=e.user,a.lkApi=e.lkApi+"quiz/NPS/",a.loading=!1,e.pageNameCls="nps-page",a.error={},a.quittanceSend=!1,a.quittanceSendLoading=!1,a.loadingNps=!1,a.answer={isMob:SmartPhone.isAny()},e.breadcrumbs=[{text:"Опрос"}],o.getDataNps(t.reestrId,function(e){if(e&&e.blocks&&e.blocks.length){a.answer.quizId=e.blocks[0].questions[0].id,a.answer.title=e.blocks[0].questions[0].text;for(var t=[],r=[],o=0,n=0;n<e.blocks[0].questions[0].answers.length;n++){var i=parseInt(e.blocks[0].questions[0].answers[n].id,0);e.blocks[0].questions[0].answers[n].otherAnswer?a.answer.otherAnswerId=i:(t.push(i),r.push(++o))}10<r.length&&(t.length=r.length=10),a.answer.labels=r,a.answer.ticks=t,a.quittanceSend=!1,a.quittanceSendLoading=!1,a.errorLoadNps=!1,a.loadingNps=!0}else a.errorLoadNps=!0,a.loadingNps=!1;a.loading=!0},function(e){a.errorLoadNps=409!=e&&0!=e,a.loadingNps=!1,a.loading=!0}),a.sendQuiz=function(){var e;a.answer.id&&(a.quittanceSendLoading=!0,e={qaItems:[{questionId:a.answer.quizId,answerId:a.answer.id,answer:a.answer.message}],source:a.answer.isMob?SmartPhone.isPhone()?"MOBILE_EPGU_V3":"TABLET_EPGU_V3":"EPGU_V3",serviceId:t.reestrId,serviceType:"Service"},o.setDataNps(e,function(){a.quittanceSend=!0,a.quittanceSendLoading=!1},function(){a.quittanceSend=!0,a.quittanceSendLoading=!1}))}}])}(),function(e,t){if("function"==typeof define&&define.amd)define(["jquery"],t);else if("object"==typeof module&&module.exports){var r;try{r=require("jquery")}catch(e){r=null}module.exports=t(r)}else e.Slider=t(e.jQuery)}(this,function(t){var e,w,r,o,S;return function(){"use strict";function e(){}var c,u,d=Array.prototype.slice;(c=t)&&(u="undefined"==typeof console?e:function(e){console.error(e)},c.bridget=function(e,t){var s,l,r;(r=t).prototype.option||(r.prototype.option=function(e){c.isPlainObject(e)&&(this.options=c.extend(!0,this.options,e))}),s=e,l=t,c.fn[s]=function(t){if("string"==typeof t){for(var e=d.call(arguments,1),r=0,o=this.length;r<o;r++){var n=this[r],n=c.data(n,s);if(n)if(c.isFunction(n[t])&&"_"!==t.charAt(0)){var i=n[t].apply(n,e);if(void 0!==i&&i!==n)return i}else u("no such method '"+t+"' for "+s+" instance");else u("cannot call methods on "+s+" prior to initialization; attempted to call '"+t+"'")}return this}var a=this.map(function(){var e=c.data(this,s);return e?(e.option(t),e._init()):(e=new l(this,t),c.data(this,s,e)),c(this)});return!a||1<a.length?a:a[0]}},c.bridget)}(),w=t,o=function(e){return"Invalid input value '"+e+"' passed in"},S={linear:{toValue:function(e){var t=e/100*(this.options.max-this.options.min);if(0<this.options.ticks_positions.length){for(var r,o,n,i=0,a=0;a<this.options.ticks_positions.length;a++)if(e<=this.options.ticks_positions[a]){r=0<a?this.options.ticks[a-1]:0,n=0<a?this.options.ticks_positions[a-1]:0,o=this.options.ticks[a],i=this.options.ticks_positions[a];break}0<a&&(t=r+(e-n)/(i-n)*(o-r))}t=this.options.min+Math.round(t/this.options.step)*this.options.step;return t<this.options.min?this.options.min:t>this.options.max?this.options.max:t},toPercentage:function(e){if(this.options.max===this.options.min)return 0;if(0<this.options.ticks_positions.length){for(var t,r,o,n=0,i=0;i<this.options.ticks.length;i++)if(e<=this.options.ticks[i]){t=0<i?this.options.ticks[i-1]:0,o=0<i?this.options.ticks_positions[i-1]:0,r=this.options.ticks[i],n=this.options.ticks_positions[i];break}if(0<i)return o+(e-t)/(r-t)*(n-o)}return 100*(e-this.options.min)/(this.options.max-this.options.min)}},logarithmic:{toValue:function(e){var t=0===this.options.min?0:Math.log(this.options.min),r=Math.log(this.options.max),r=Math.exp(t+(r-t)*e/100);return(r=this.options.min+Math.round((r-this.options.min)/this.options.step)*this.options.step)<this.options.min?this.options.min:r>this.options.max?this.options.max:r},toPercentage:function(e){var t,r;return this.options.max===this.options.min?0:(t=Math.log(this.options.max),r=0===this.options.min?0:Math.log(this.options.min),100*((0===e?0:Math.log(e))-r)/(t-r))}}},(e=function(e,t){return n.call(this,e,t),this}).prototype={_init:function(){},constructor:e,defaultOptions:{id:"",min:0,max:10,step:1,precision:0,orientation:"horizontal",value:5,range:!1,selection:"before",tooltip:"show",tooltip_split:!1,handle:"round",reversed:!1,enabled:!0,formatter:function(e){return Array.isArray(e)?e[0]+" : "+e[1]:e},natural_arrow_keys:!1,ticks:[],ticks_positions:[],ticks_labels:[],ticks_snap_bounds:0,scale:"linear",focus:!1},over:!1,inDrag:!1,getValue:function(){return this.options.range?this.options.value:this.options.value[0]},setValue:function(e,t,r){e=e||0;var o=this.getValue(),e=(this.options.value=this._validateInputValue(e),this._applyPrecision.bind(this)),e=(this.options.range?(this.options.value[0]=e(this.options.value[0]),this.options.value[1]=e(this.options.value[1]),this.options.value[0]=Math.max(this.options.min,Math.min(this.options.max,this.options.value[0])),this.options.value[1]=Math.max(this.options.min,Math.min(this.options.max,this.options.value[1]))):(this.options.value=e(this.options.value),this.options.value=[Math.max(this.options.min,Math.min(this.options.max,this.options.value))],this._addClass(this.handle2,"hide"),this.options.value[1]="after"===this.options.selection?this.options.max:this.options.min),this.percentage=this.options.max>this.options.min?[this._toPercentage(this.options.value[0]),this._toPercentage(this.options.value[1]),100*this.options.step/(this.options.max-this.options.min)]:[0,0,100],this._layout(),this.options.range?this.options.value:this.options.value[0]);return!0===t&&this._trigger("slide",e),o!==e&&!0===r&&this._trigger("change",{oldValue:o,newValue:e}),this._setDataVal(e),this},destroy:function(){this._removeSliderEventHandlers(),this.sliderElem.parentNode.removeChild(this.sliderElem),this.element.style.display="",this._cleanUpEventCallbacksMap(),this.element.removeAttribute("data"),w&&(this._unbindJQueryEventHandlers(),this.$element.removeData("slider"))},disable:function(){return this.options.enabled=!1,this.handle1.removeAttribute("tabindex"),this.handle2.removeAttribute("tabindex"),this._addClass(this.sliderElem,"slider-disabled"),this._trigger("slideDisabled"),this},enable:function(){return this.options.enabled=!0,this.handle1.setAttribute("tabindex",0),this.handle2.setAttribute("tabindex",0),this._removeClass(this.sliderElem,"slider-disabled"),this._trigger("slideEnabled"),this},toggle:function(){return this.options.enabled?this.disable():this.enable(),this},isEnabled:function(){return this.options.enabled},on:function(e,t){return this._bindNonQueryEventHandler(e,t),this},getAttribute:function(e){return e?this.options[e]:this.options},setAttribute:function(e,t){return this.options[e]=t,this},refresh:function(){return this._removeSliderEventHandlers(),n.call(this,this.element,this.options),w&&w.data(this.element,"slider",this),this},relayout:function(){return this._layout(),this},_removeSliderEventHandlers:function(){this.handle1.removeEventListener("keydown",this.handle1Keydown,!1),this.handle1.removeEventListener("focus",this.showTooltip,!1),this.handle1.removeEventListener("blur",this.hideTooltip,!1),this.handle2.removeEventListener("keydown",this.handle2Keydown,!1),this.handle2.removeEventListener("focus",this.handle2Keydown,!1),this.handle2.removeEventListener("blur",this.handle2Keydown,!1),this.sliderElem.removeEventListener("mouseenter",this.showTooltip,!1),this.sliderElem.removeEventListener("mouseleave",this.hideTooltip,!1),this.sliderElem.removeEventListener("touchstart",this.mousedown,!1),this.sliderElem.removeEventListener("mousedown",this.mousedown,!1)},_bindNonQueryEventHandler:function(e,t){void 0===this.eventToCallbackMap[e]&&(this.eventToCallbackMap[e]=[]),this.eventToCallbackMap[e].push(t)},_cleanUpEventCallbacksMap:function(){for(var e=Object.keys(this.eventToCallbackMap),t=0;t<e.length;t++){var r=e[t];this.eventToCallbackMap[r]=null}},_showTooltip:function(){!1===this.options.tooltip_split?(this._addClass(this.tooltip,"in"),this.tooltip_min.style.display="none",this.tooltip_max.style.display="none"):(this._addClass(this.tooltip_min,"in"),this._addClass(this.tooltip_max,"in"),this.tooltip.style.display="none"),this.over=!0},_hideTooltip:function(){!1===this.inDrag&&!0!==this.alwaysShowTooltip&&(this._removeClass(this.tooltip,"in"),this._removeClass(this.tooltip_min,"in"),this._removeClass(this.tooltip_max,"in")),this.over=!1},_layout:function(){var e,t,r,o=this.options.reversed?[100-this.percentage[0],this.percentage[1]]:[this.percentage[0],this.percentage[1]];if(this.handle1.style[this.stylePos]=o[0]+"%",this.handle2.style[this.stylePos]=o[1]+"%",Array.isArray(this.options.ticks)&&0<this.options.ticks.length){var n=Math.max.apply(Math,this.options.ticks),i=Math.min.apply(Math,this.options.ticks),a="vertical"===this.options.orientation?"height":"width",s="vertical"===this.options.orientation?"marginTop":"marginLeft",l=this.size/(this.options.ticks.length-1);if(this.tickLabelContainer){var c=0;if(0===this.options.ticks_positions.length)this.tickLabelContainer.style[s]=-l/2+"px",c=this.tickLabelContainer.offsetHeight;else for(u=0;u<this.tickLabelContainer.childNodes.length;u++)this.tickLabelContainer.childNodes[u].offsetHeight>c&&(c=this.tickLabelContainer.childNodes[u].offsetHeight);"horizontal"===this.options.orientation&&(this.sliderElem.style.marginBottom=c+"px")}for(var u=0;u<this.options.ticks.length;u++){var d=this.options.ticks_positions[u]||100*(this.options.ticks[u]-i)/(n-i);this.ticks[u].style[this.stylePos]=d+"%",this._removeClass(this.ticks[u],"in-selection"),this.options.range?o[0]<=d&&d<=o[1]&&this._addClass(this.ticks[u],"in-selection"):("after"===this.options.selection&&o[0]<=d||"before"===this.options.selection&&d<=o[0])&&this._addClass(this.ticks[u],"in-selection"),this.tickLabels[u]&&(this.tickLabels[u].style[a]=l+"px",void 0!==this.options.ticks_positions[u])&&(this.tickLabels[u].style.position="absolute",this.tickLabels[u].style[this.stylePos]=this.options.ticks_positions[u]+"%",this.tickLabels[u].style[s]=-l/2+"px")}}"vertical"===this.options.orientation?(this.trackLow.style.top="0",this.trackLow.style.height=Math.min(o[0],o[1])+"%",this.trackSelection.style.top=Math.min(o[0],o[1])+"%",this.trackSelection.style.height=Math.abs(o[0]-o[1])+"%",this.trackHigh.style.bottom="0",this.trackHigh.style.height=100-Math.min(o[0],o[1])-Math.abs(o[0]-o[1])+"%"):(this.trackLow.style.left="0",this.trackLow.style.width=Math.min(o[0],o[1])+"%",this.trackSelection.style.left=Math.min(o[0],o[1])+"%",this.trackSelection.style.width=Math.abs(o[0]-o[1])+"%",this.trackHigh.style.right="0",this.trackHigh.style.width=100-Math.min(o[0],o[1])-Math.abs(o[0]-o[1])+"%",t=this.tooltip_min.getBoundingClientRect(),r=this.tooltip_max.getBoundingClientRect(),t.right>r.left?(this._removeClass(this.tooltip_max,"top"),this._addClass(this.tooltip_max,"bottom"),this.tooltip_max.style.top="18px"):(this._removeClass(this.tooltip_max,"bottom"),this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top=this.tooltip_min.style.top)),this.options.range?(e=this.options.formatter(this.options.value),this._setText(this.tooltipInner,e),this.tooltip.style[this.stylePos]=(o[1]+o[0])/2+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-top",-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-left",-this.tooltip.offsetWidth/2+"px"),"vertical"===this.options.orientation?this._css(this.tooltip,"margin-top",-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-left",-this.tooltip.offsetWidth/2+"px"),t=this.options.formatter(this.options.value[0]),this._setText(this.tooltipInner_min,t),r=this.options.formatter(this.options.value[1]),this._setText(this.tooltipInner_max,r),this.tooltip_min.style[this.stylePos]=o[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip_min,"margin-top",-this.tooltip_min.offsetHeight/2+"px"):this._css(this.tooltip_min,"margin-left",-this.tooltip_min.offsetWidth/2+"px"),this.tooltip_max.style[this.stylePos]=o[1]+"%","vertical"===this.options.orientation?this._css(this.tooltip_max,"margin-top",-this.tooltip_max.offsetHeight/2+"px"):this._css(this.tooltip_max,"margin-left",-this.tooltip_max.offsetWidth/2+"px")):(e=this.options.formatter(this.options.value[0]),this._setText(this.tooltipInner,e),this.tooltip.style[this.stylePos]=o[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-top",-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-left",-this.tooltip.offsetWidth/2+"px"))},_removeProperty:function(e,t){e.style.removeProperty?e.style.removeProperty(t):e.style.removeAttribute(t)},_mousedown:function(e){if(!this.options.enabled)return!1;this.offset=this._offset(this.sliderElem),this.size=this.sliderElem[this.sizePos];var t,r=this._getPercentage(e),o=(this.options.range?(o=Math.abs(this.percentage[0]-r),t=Math.abs(this.percentage[1]-r),this.dragged=o<t?0:1):this.dragged=0,this.percentage[this.dragged]=this.options.reversed?100-r:r,this._layout(),this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),this.mousemove&&document.removeEventListener("mousemove",this.mousemove,!1),this.mouseup&&document.removeEventListener("mouseup",this.mouseup,!1),this.mousemove=this._mousemove.bind(this),this.mouseup=this._mouseup.bind(this),this.touchCapable&&(document.addEventListener("touchmove",this.mousemove,!1),document.addEventListener("touchend",this.mouseup,!1)),document.addEventListener("mousemove",this.mousemove,!1),document.addEventListener("mouseup",this.mouseup,!1),this.inDrag=!0,this._calculateValue());return this._trigger("slideStart",o),this._setDataVal(o),this.setValue(o,!1,!0),this._pauseEvent(e),this.options.focus&&this._triggerFocusOnHandle(this.dragged),!0},_triggerFocusOnHandle:function(e){0===e&&this.handle1.focus(),1===e&&this.handle2.focus()},_keydown:function(e,t){if(!this.options.enabled)return!1;var r,o,n;switch(t.keyCode){case 37:case 40:r=-1;break;case 39:case 38:r=1}return r?(this.options.natural_arrow_keys&&(n="vertical"===this.options.orientation&&!this.options.reversed,o="horizontal"===this.options.orientation&&this.options.reversed,n||o)&&(r=-r),n=this.options.value[e]+r*this.options.step,this.options.range&&(n=[e?this.options.value[0]:n,e?n:this.options.value[1]]),this._trigger("slideStart",n),this._setDataVal(n),this.setValue(n,!0,!0),this._trigger("slideStop",n),this._setDataVal(n),this._layout(),this._pauseEvent(t),!1):void 0},_pauseEvent:function(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1},_mousemove:function(e){return this.options.enabled&&(e=this._getPercentage(e),this._adjustPercentageForRangeSliders(e),this.percentage[this.dragged]=this.options.reversed?100-e:e,this._layout(),e=this._calculateValue(!0),this.setValue(e,!0,!0)),!1},_adjustPercentageForRangeSliders:function(e){this.options.range&&(0===this.dragged&&this.percentage[1]<e?(this.percentage[0]=this.percentage[1],this.dragged=1):1===this.dragged&&this.percentage[0]>e&&(this.percentage[1]=this.percentage[0],this.dragged=0))},_mouseup:function(){var e;return this.options.enabled&&(this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),document.removeEventListener("mousemove",this.mousemove,!1),document.removeEventListener("mouseup",this.mouseup,!1),(this.inDrag=!1)===this.over&&this._hideTooltip(),e=this._calculateValue(!0),this._layout(),this._trigger("slideStop",e),this._setDataVal(e)),!1},_calculateValue:function(e){var t;if(this.options.range?(t=[this.options.min,this.options.max],0!==this.percentage[0]&&(t[0]=this._toValue(this.percentage[0]),t[0]=this._applyPrecision(t[0])),100!==this.percentage[1]&&(t[1]=this._toValue(this.percentage[1]),t[1]=this._applyPrecision(t[1]))):(t=this._toValue(this.percentage[0]),t=parseFloat(t),t=this._applyPrecision(t)),e){for(var r=[t,1/0],o=0;o<this.options.ticks.length;o++){var n=Math.abs(this.options.ticks[o]-t);n<=r[1]&&(r=[this.options.ticks[o],n])}if(r[1]<=this.options.ticks_snap_bounds)return r[0]}return t},_applyPrecision:function(e){var t=this.options.precision||this._getNumDigitsAfterDecimalPlace(this.options.step);return this._applyToFixedAndParseFloat(e,t)},_getNumDigitsAfterDecimalPlace:function(e){e=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0},_applyToFixedAndParseFloat:function(e,t){e=e.toFixed(t);return parseFloat(e)},_getPercentage:function(e){e=((e=!this.touchCapable||"touchstart"!==e.type&&"touchmove"!==e.type?e:e.touches[0])[this.mousePos]-this.offset[this.stylePos])/this.size*100,e=Math.round(e/this.percentage[2])*this.percentage[2];return Math.max(0,Math.min(100,e))},_validateInputValue:function(e){if("number"==typeof e)return e;if(Array.isArray(e))return this._validateArray(e),e;throw new Error(o(e))},_validateArray:function(e){for(var t=0;t<e.length;t++){var r=e[t];if("number"!=typeof r)throw new Error(o(r))}},_setDataVal:function(e){this.element.setAttribute("data","value: '"+e+"'"),this.element.setAttribute("value",e),this.element.value=e},_trigger:function(e,t){t=t||0===t?t:void 0;var r=this.eventToCallbackMap[e];if(r&&r.length)for(var o=0;o<r.length;o++)(0,r[o])(t);w&&this._triggerJQueryEvent(e,t)},_triggerJQueryEvent:function(e,t){e={type:e,value:t};this.$element.trigger(e),this.$sliderElem.trigger(e)},_unbindJQueryEventHandlers:function(){this.$element.off(),this.$sliderElem.off()},_setText:function(e,t){void 0!==e.innerText?e.innerText=t:void 0!==e.textContent&&(e.textContent=t)},_removeClass:function(e,t){for(var r=t.split(" "),o=e.className,n=0;n<r.length;n++)var i=r[n],i=new RegExp("(?:\\s|^)"+i+"(?:\\s|$)"),o=o.replace(i," ");e.className=o.trim()},_addClass:function(e,t){for(var r=t.split(" "),o=e.className,n=0;n<r.length;n++){var i=r[n];new RegExp("(?:\\s|^)"+i+"(?:\\s|$)").test(o)||(o+=" "+i)}e.className=o.trim()},_offsetLeft:function(e){for(var t=e.offsetLeft;(e=e.offsetParent)&&!isNaN(e.offsetLeft);)t+=e.offsetLeft;return t},_offsetTop:function(e){for(var t=e.offsetTop;(e=e.offsetParent)&&!isNaN(e.offsetTop);)t+=e.offsetTop;return t},_offset:function(e){return{left:this._offsetLeft(e),top:this._offsetTop(e)}},_css:function(e,t,r){w?w.style(e,t,r):(t=t.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(e,t){return t.toUpperCase()}),e.style[t]=r)},_toValue:function(e){return this.options.scale.toValue.apply(this,[e])},_toPercentage:function(e){return this.options.scale.toPercentage.apply(this,[e])}},w&&(r=w.fn.slider?"bootstrapSlider":"slider",w.bridget(r,e)),e;function n(e,t){"string"==typeof e?this.element=document.querySelector(e):e instanceof HTMLElement&&(this.element=e),t=t||{};for(var r=Object.keys(this.defaultOptions),o=0;o<r.length;o++){var n=r[o],i=t[n];i=null!==(i=void 0!==i?i:function(t,e){e="data-slider-"+e.replace(/_/g,"-"),t=t.getAttribute(e);try{return JSON.parse(t)}catch(e){return t}}(this.element,n))?i:this.defaultOptions[n],this.options||(this.options={}),this.options[n]=i}var a,s,l,c,u,e=this.element.style.width,d=!1,p=this.element.parentNode;if(this.sliderElem)d=!0;else{this.sliderElem=document.createElement("div"),this.sliderElem.className="slider";var m=document.createElement("div");if(m.className="slider-track",(s=document.createElement("div")).className="slider-track-low",(a=document.createElement("div")).className="slider-selection",(l=document.createElement("div")).className="slider-track-high",(c=document.createElement("div")).className="slider-handle min-slider-handle",(u=document.createElement("div")).className="slider-handle max-slider-handle",m.appendChild(s),m.appendChild(a),m.appendChild(l),this.ticks=[],Array.isArray(this.options.ticks)&&0<this.options.ticks.length){for(o=0;o<this.options.ticks.length;o++){var h=document.createElement("div");h.className="slider-tick",this.ticks.push(h),m.appendChild(h)}a.className+=" tick-slider-selection"}if(m.appendChild(c),m.appendChild(u),this.tickLabels=[],Array.isArray(this.options.ticks_labels)&&0<this.options.ticks_labels.length)for(this.tickLabelContainer=document.createElement("div"),this.tickLabelContainer.className="slider-tick-label-container",o=0;o<this.options.ticks_labels.length;o++){var f=document.createElement("div");f.className="slider-tick-label",f.innerHTML=this.options.ticks_labels[o],this.tickLabels.push(f),this.tickLabelContainer.appendChild(f)}function g(e){var t=document.createElement("div"),r=(t.className="tooltip-arrow",document.createElement("div"));r.className="tooltip-inner",e.appendChild(t),e.appendChild(r)}var v=document.createElement("div"),y=(v.className="tooltip tooltip-main",g(v),document.createElement("div")),b=(y.className="tooltip tooltip-min",g(y),document.createElement("div"));b.className="tooltip tooltip-max",g(b),this.sliderElem.appendChild(m),this.sliderElem.appendChild(v),this.sliderElem.appendChild(y),this.sliderElem.appendChild(b),this.tickLabelContainer&&this.sliderElem.appendChild(this.tickLabelContainer),p.insertBefore(this.sliderElem,this.element),this.element.style.display="none"}if(w&&(this.$element=w(this.element),this.$sliderElem=w(this.sliderElem)),this.eventToCallbackMap={},this.sliderElem.id=this.options.id,this.touchCapable="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,this.tooltip=this.sliderElem.querySelector(".tooltip-main"),this.tooltipInner=this.tooltip.querySelector(".tooltip-inner"),this.tooltip_min=this.sliderElem.querySelector(".tooltip-min"),this.tooltipInner_min=this.tooltip_min.querySelector(".tooltip-inner"),this.tooltip_max=this.sliderElem.querySelector(".tooltip-max"),this.tooltipInner_max=this.tooltip_max.querySelector(".tooltip-inner"),S[this.options.scale]&&(this.options.scale=S[this.options.scale]),!0===d&&(this._removeClass(this.sliderElem,"slider-horizontal"),this._removeClass(this.sliderElem,"slider-vertical"),this._removeClass(this.tooltip,"hide"),this._removeClass(this.tooltip_min,"hide"),this._removeClass(this.tooltip_max,"hide"),["left","top","width","height"].forEach(function(e){this._removeProperty(this.trackLow,e),this._removeProperty(this.trackSelection,e),this._removeProperty(this.trackHigh,e)},this),[this.handle1,this.handle2].forEach(function(e){this._removeProperty(e,"left"),this._removeProperty(e,"top")},this),[this.tooltip,this.tooltip_min,this.tooltip_max].forEach(function(e){this._removeProperty(e,"left"),this._removeProperty(e,"top"),this._removeProperty(e,"margin-left"),this._removeProperty(e,"margin-top"),this._removeClass(e,"right"),this._removeClass(e,"top")},this)),"vertical"===this.options.orientation?(this._addClass(this.sliderElem,"slider-vertical"),this.stylePos="top",this.mousePos="pageY",this.sizePos="offsetHeight",this._addClass(this.tooltip,"right"),this.tooltip.style.left="100%",this._addClass(this.tooltip_min,"right"),this.tooltip_min.style.left="100%",this._addClass(this.tooltip_max,"right"),this.tooltip_max.style.left="100%"):(this._addClass(this.sliderElem,"slider-horizontal"),this.sliderElem.style.width=e,this.options.orientation="horizontal",this.stylePos="left",this.mousePos="pageX",this.sizePos="offsetWidth",this._addClass(this.tooltip,"top"),this.tooltip.style.top=-this.tooltip.outerHeight-14+"px",this._addClass(this.tooltip_min,"top"),this.tooltip_min.style.top=-this.tooltip_min.outerHeight-14+"px",this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top=-this.tooltip_max.outerHeight-14+"px"),Array.isArray(this.options.ticks)&&0<this.options.ticks.length&&(this.options.max=Math.max.apply(Math,this.options.ticks),this.options.min=Math.min.apply(Math,this.options.ticks)),Array.isArray(this.options.value)?this.options.range=!0:this.options.range&&(this.options.value=[this.options.value,this.options.max]),this.trackLow=s||this.trackLow,this.trackSelection=a||this.trackSelection,this.trackHigh=l||this.trackHigh,"none"===this.options.selection&&(this._addClass(this.trackLow,"hide"),this._addClass(this.trackSelection,"hide"),this._addClass(this.trackHigh,"hide")),this.handle1=c||this.handle1,this.handle2=u||this.handle2,!0===d)for(this._removeClass(this.handle1,"round triangle"),this._removeClass(this.handle2,"round triangle hide"),o=0;o<this.ticks.length;o++)this._removeClass(this.ticks[o],"round triangle hide");if(-1!==["round","triangle","custom"].indexOf(this.options.handle))for(this._addClass(this.handle1,this.options.handle),this._addClass(this.handle2,this.options.handle),o=0;o<this.ticks.length;o++)this._addClass(this.ticks[o],this.options.handle);this.offset=this._offset(this.sliderElem),this.size=this.sliderElem[this.sizePos],this.setValue(this.options.value),this.handle1Keydown=this._keydown.bind(this,0),this.handle1.addEventListener("keydown",this.handle1Keydown,!1),this.handle2Keydown=this._keydown.bind(this,1),this.handle2.addEventListener("keydown",this.handle2Keydown,!1),this.mousedown=this._mousedown.bind(this),this.touchCapable&&this.sliderElem.addEventListener("touchstart",this.mousedown,!1),this.sliderElem.addEventListener("mousedown",this.mousedown,!1),"hide"===this.options.tooltip?(this._addClass(this.tooltip,"hide"),this._addClass(this.tooltip_min,"hide"),this._addClass(this.tooltip_max,"hide")):"always"===this.options.tooltip?(this._showTooltip(),this._alwaysShowTooltip=!0):(this.showTooltip=this._showTooltip.bind(this),this.hideTooltip=this._hideTooltip.bind(this),this.sliderElem.addEventListener("mouseenter",this.showTooltip,!1),this.sliderElem.addEventListener("mouseleave",this.hideTooltip,!1),this.handle1.addEventListener("focus",this.showTooltip,!1),this.handle1.addEventListener("blur",this.hideTooltip,!1),this.handle2.addEventListener("focus",this.showTooltip,!1),this.handle2.addEventListener("blur",this.hideTooltip,!1)),this.options.enabled?this.enable():this.disable()}}),function(){"use strict";angular.module("search",["ngRoute","ui.mask"]).config(["$routeProvider",function(r){var o;window.searchSputnikEnabled&&(o={"/search":{controller:"searchData",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()?"/tpl/search/search-mob-207b077382.html":"/tpl/search/search-pad-0cf18abdc2.html":"/tpl/search/search-7eb67da143.html"),reloadOnSearch:!1}},Object.keys(o).forEach(function(e){var t=o[e];t.resolve=t.resolve||{},t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}],r.when(e,o[e]).when(e+"/o/:okato",t)}))}]).factory("searchResults",["$http",function(o){return{simpleRequest:function(e,t,r){o(e).success(function(e){t(e)}).error(function(){r&&r()})}}}]).controller("searchData",["$scope","$rootScope","$routeParams","$http","$location","$timeout","ipCookie","searchResults","RegionService","IconService","userTypeService","OkatoService","PerformanceService",function(u,a,t,s,r,d,l,o,n,p,e,i,m){u.user=a.user,u.routeParams=t,u.loading=!!t.query,a.pageNameCls="search-page";Math.random();u.empty=!1,u.search={query:"",addSearch:!1,recipient:e.getHeaderFilter().searchSputnikParam||e.getUserType().searchSputnikParam,serviceType:"",online:null,filter:"all",existResults:!1},u.platform="EPGUV3_"+("dk"==a.version?"DESK":"mob"==a.version?"MOB":"TAB"),u.needShowPopup=!1,u.popupSettings={title:"Не нашли, что искали?",sendTitle:"Спасибо за отзыв!",placeholder:"Оставьте отзыв",buttonText:"Отправить",url:"/api/search/v3/feedback",needScroll:!0,data:{platform:u.platform,id:a.user.id||null}},u.serviceRecipient=[{text:"Любой",value:"all"},{text:"Гражданин РФ",value:"PERSON"},{text:"Индивидуальный предприниматель",value:"SOLE_PROPRIETOR"},{text:"Юридическое лицо",value:"LEGAL"},{text:"Партнеры",value:"PARTNERS"},{text:"Иностранный гражданин",value:"FOREIGNER"}],u.popupCounter=0,a.searchPing=a.searchPing&&1e3*parseInt(a.searchPing)||3e3,u.cancelActionsWait=function(){u.needShowPopup=!0,d.cancel(u.test)},u.waitForActions=function(){u.popupCounter+=1,a.searchPing&&(u.unbindPopupWatch=u.$watchGroup(["needShowPopup","search.query"],function(e,t){e!==t||u.test||(u.popupSettings.showSearchPopup=!1,u.test=d(function(){u.clearSearch(),u.popupSettings.data.reason="P",u.popupSettings.showSearchPopup=!0;var e=["searchProblem",u.search.query,u.platform];u.sendMetric("searchProblem",e)},a.searchPing))}))},u.clearSearch=function(){u.popupSettings.send=!1,u.popupSettings.data.text&&delete u.popupSettings.data.text},u.sendMetric=function(e,t){a.userSelectedRegion&&t.push(a.userSelectedRegion),a.isLk&&(window.yaCounter24845174=ym(24845174,"init",{defer:!0,clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,trackHash:!0,triggerEvent:!0})),window.metricReachGoal24845174(e,t)},u.$watchGroup(["userTypeGosBar","changeHeaderFilter"],function(){u.userType={type:e.getHeaderFilter()||e.getUserType()},1!=u.userType.type.individual?(u.search.addSearch=!0,u.search.recipient=u.userType.type.searchSputnikParam,u.recipientFilter=u.serviceRecipient.find(function(e){return e.value==u.userType.type.searchSputnikParam})):(u.search.recipient="all",u.recipientFilter=u.serviceRecipient.find(function(e){return"all"==e.value}))},!0),u.$on("$routeUpdate",function(){t.query||(u.results=null,u.search={query:"",addSearch:!1,recipient:"",serviceType:"",online:null,filter:"all",existResults:!1},u.loading=!1)}),n.get().then(function(e){u.myRegion=e}),u.select=function(){a.$broadcast("region-select"),u.cancelActionsWait()},u.$on("region-changed",function(){n.get().then(function(e){u.myRegion=e})}),a.breadcrumbs=[{text:"Поиск"}],u.size=20,u.showAdded=function(){u.prevResult=u.results,c(!1,u.search.filter)},"mob"!==a.version&&(u.serviceType=[{text:"Все",value:"all"},{text:"Федеральные",value:"FEDERAL"},{text:"Региональные",value:"REGIONAL"},{text:"Муниципальные",value:"MUNICIPAL"}],u.addedParameters=function(){u.search.addSearch=!u.search.addSearch},u.recipientChange=function(e){u.search.recipient=e.value},u.typeChange=function(e){u.search.serviceType=e.value}),u.typeClick=function(e,t){var r=!0,e=(e.preventDefault(),u.cancelActionsWait(),["searchTabs",u.platform,t,u.search.query]);u.sendMetric("searchTabs",e),u.epguTypeForStatistics=t;for(var o=0;o<u.searchFilter.length;o++)if(u.searchFilter[o].type==t){if(u.searchFilter[o].active)return;u.searchFilter[o].active=!0,u.search.filter=u.searchFilter[o].type,u.searchFilter[o].results&&u.searchFilter[o].results.length?(u.prevResult=u.searchFilter[o].prevResult||[],u.snptPassport=u.searchFilter[o].snptPassport||{},u.snptInformation=u.searchFilter[o].snptInformation||{},u.snptDepartment=u.searchFilter[o].snptDepartment||{},u.snptSituation=u.searchFilter[o].snptSituation||{},u.results=u.searchFilter[o].results||[],u.search.existResults=u.searchFilter[o].existResults,r=!1):(u.searchFilter[o].from=1,u.prevResult=[],u.snptPassport={},u.snptInformation={},u.snptDepartment={},u.snptSituation={})}else u.searchFilter[o].active=!1;r&&c(!1,u.search.filter)},u.searchFilter=[{text:"Все",type:"all",count:0,from:1},{text:"Услуги",type:"service",count:0,from:1},{text:"Ведомства",type:"stateStructure",count:0,from:1},{text:"Информация и помощь",type:"information",count:0,from:1},{text:"Жизненные ситуации",type:"ls",count:0,from:1}],u.showSnpt=function(){u.sendStatistics({},"snpt"),u.cancelActionsWait();for(var e=u.snptPassport.commonServicesPortion.length,t=u.snptPassport&&u.snptPassport.commonServices.length&&e+6<=u.snptPassport.commonServices.length?e+6:u.snptPassport.commonServices.length,r=e;r<u.snptPassport.commonServices.length&&!(t<=r);r++)u.snptPassport.commonServicesPortion.push(u.snptPassport.commonServices[r])},u.showSnptPassports=function(){u.sendStatistics({},"snpt"),u.cancelActionsWait();for(var e=u.snptDepartment.passportsPortion.length,t=u.snptDepartment&&u.snptDepartment.passports.length&&e+6<=u.snptDepartment.passports.length?e+6:u.snptDepartment.passports.length,r=e;r<u.snptDepartment.passports.length&&!(t<=r);r++)u.snptDepartment.passportsPortion.push(u.snptDepartment.passports[r])},u.showSnptSituation=function(){u.sendStatistics({},"snpt"),u.cancelActionsWait();for(var e=u.snptSituation.commonPortion.length,t=u.snptSituation&&u.snptSituation.children.length&&e+6<=u.snptSituation.children.length?e+6:u.snptSituation.children.length,r=e;r<u.snptSituation.children.length&&!(t<=r);r++)u.snptSituation.commonPortion.push(u.snptSituation.children[r])},u.searchFilterChange=function(e){u.cancelActionsWait();var t=["searchTabs",u.platform,e.type,u.search.query];if(u.sendMetric("searchTabs",t),e&&u.search.filter!=e.type){var r=!0;u.search.filter=e.type;for(var o=0;o<u.searchFilterMob.length;o++)if(u.searchFilterMob[o].type==u.search.filter)for(var n=0;n<u.searchFilter.length;n++)if(u.searchFilter[n].type==u.search.filter){u.searchFilter[n].results&&u.searchFilter[n].results.length?(u.prevResult=u.searchFilter[n].prevResult||[],u.snptPassport=u.searchFilter[n].snptPassport||{},u.snptInformation=u.searchFilter[n].snptInformation||{},u.snptDepartment=u.searchFilter[n].snptDepartment||{},u.snptSituation=u.searchFilter[o].snptSituation||u.searchFilter[o].snptPartnersProduct||{},u.results=u.searchFilter[n].results||[],u.search.existResults=u.searchFilter[n].existResults,r=!1):(u.searchFilter[n].from=1,u.prevResult=[],u.snptPassport={},u.snptInformation={},u.snptDepartment={},u.snptSituation={});break}u.searchFilterCurrent=u.searchFilterMob.find(function(e){return e.type==u.search.filter}),r&&c(!1,u.search.filter)}};var c=function(e,t){0<u.popupCounter&&u.popupSettings.data.query!=u.search.query&&(u.popupCounter=0,u.test=null),u.popupSettings.data.query=u.search.query,u.correct="";var s={query:u.search.query,userRegionOkato:u.myRegion.id,size:u.size,_:Math.random()};if(s.query){u.search.query=h(s.query);try{s.query=decodeURIComponent(u.search.query)}catch(e){s.query=u.search.query}}u.search.recipient&&"all"!=u.search.recipient&&(s.serviceRecipient=u.search.recipient),u.search.serviceType&&"all"!=u.search.serviceType&&(s.serviceType=u.search.serviceType),null!=u.search.online&&(s.isOnline=u.search.online),u.getIcon=function(e,t){if(e.icons&&0<e.icons.length){e=e.icons.find(function(e){if(e.iconType==t)return!0});if(e)return e.path}return""};function l(l,c,e){l.query&&("all"!=c?l.epguType=c:l.epguType&&delete l.epguType,u.hasDocs=!1,l.from=e,a.userType&&(l.userType=a.userType),m.measureStart("search"),o.simpleRequest({url:a.searchApiUrl+"search",headers:{"Content-Type":"application/json; charset=utf-8"},method:"GET",params:l,cache:!1,withCredentials:!0},function(e){u.loading=!1,u.correct={correction:""};var t=["searchProblem",u.search.query,u.platform];if(!e||e.error&&0!==e.error.code?g("search",1,u.search.query,e&&e.error&&e.error.code,null):g("search",0,u.search.query,null,null),e&&e.kmdata)if(e.kmdata.correct&&(u.popupCounter<1?u.waitForActions():(u.clearSearch(),u.popupSettings.showSearchPopup=!1,d.cancel(u.test)),u.correct=e.kmdata.correct,u.correct.correction)&&(u.search.query=u.correct.correction,u.correct.correction=l.query),e.kmdata.epgu&&e.kmdata.epgu.kms&&e.kmdata.epgu.kms.s&&0<e.kmdata.epgu.kms.s.rs){SmartPhone.isAny()||(u.recipientFilter=u.serviceRecipient.find(function(e){return e.value==u.search.recipient}),u.checkOnline=function(){u.search.online=null==u.search.online||!u.search.online},u.typeFilter=u.serviceType.find(function(e){return e.value==u.search.serviceType}));var r,o=e.kmdata.epgu.kms.s.rs;if(e.snptPassport){var n=0,i=u.snptPassport&&u.snptPassport.commonServicesPortion&&u.snptPassport.commonServicesPortion.length?u.snptPassport.commonServicesPortion.length:3;if(u.snptPassport=e.snptPassport,u.snptPassport.commonServicesPortion=[],u.snptPassport.commonServices&&u.snptPassport.commonServices.length)for(a=n;a<u.snptPassport.commonServices.length&&!(i<=a);a++)u.snptPassport.commonServicesPortion.push(u.snptPassport.commonServices[a])}else if(e.snptDepartment){if(n=0,i=u.snptDepartment&&u.snptDepartment.passports&&u.snptDepartment.passportsPortion.length?u.snptDepartment.passportsPortion.length:3,u.snptDepartment=e.snptDepartment,u.logoPath=p.setIcon(u.snptDepartment),u.snptDepartment.passportsPortion=[],e.snptDepartment.passports&&e.snptDepartment.passports.length)for(a=n;a<e.snptDepartment.passports.length&&!(i<=a);a++)u.snptDepartment.passportsPortion.push(e.snptDepartment.passports[a])}else if(e.snptSituation||e.snptPartnersProduct){n=0,i=u.snptSituation&&u.snptSituation.commonPortion&&u.snptSituation.commonPortion.length?u.snptSituation.commonPortion:3;if(u.snptSituation=e.snptSituation||e.snptPartnersProduct,e.snptPartnersProduct&&(u.snptPartnersProduct=e.snptPartnersProduct),u.snptSituation.commonPortion=[],u.snptSituation.children&&u.snptSituation.children.length)for(var a=n;a<u.snptSituation.children.length&&!(i<=a);a++)u.snptSituation.commonPortion.push(u.snptSituation.children[a])}else e.snptInformation&&(u.snptInformation=e.snptInformation,e.snptInformation.passports)&&e.snptInformation.passports.length&&(e.snptInformation.passports.length=3<e.snptInformation.passports.length?3:e.snptInformation.passports.length);u.empty=!1,u.search.existResults=l.from+l.size<o,u.results=u.prevResult.concat(e.kmdata.epgu.kms.rs[0].rs),u.userData=u.results&&u.results.length&&u.results[0].ud?u.results[0].ud:{},u.userBlocks=u.userData&&u.userData.userData&&u.userData.userData.blocks||u.userData&&u.userData.user_data&&u.userData.user_data.blocks||"",u.docs=[],u.userData&&u.userBlocks&&u.userBlocks.forEach(function(e){e.documents&&u.docs.push(e.documents)}),u.hasDocs=u.docs&&0<u.docs.length,u.userData.products&&u.userData.products.length&&(u.catalogProducts=u.userData.products),u.catalogProducts&&(r=0,u.catalogProducts.forEach(function(e){r++,u.catalogProducts.length>r?e.title=e.title+", ":e.title=e.title+"."}));for(var s=0;s<u.searchFilter.length;s++)if(u.searchFilter[s].type==c){u.searchFilter[s].active=!0,u.searchFilter[s].existResults=u.search.existResults,u.searchFilter[s].results=u.results,u.searchFilter[s].from=e.next,u.searchFilter[s].snptDepartment={},u.searchFilter[s].snptInformation={},u.searchFilter[s].snptPassport={},u.searchFilter[s].snptSituation={},e.snptPassport?(u.searchFilter[s].snptPassport=e.snptPassport,u.searchFilter[s].snptPassport.commonServicesPortion=u.snptPassport.commonServicesPortion):e.snptDepartment?(u.searchFilter[s].snptDepartment=u.snptDepartment,u.searchFilter[s].snptDepartment.passportsPortion=u.snptDepartment.passportsPortion):e.snptInformation?u.searchFilter[s].snptInformation=u.snptInformation:(e.snptSituation||e.snptPartnersProduct)&&(u.searchFilter[s].snptSituation=u.snptSituation,u.searchFilter[s].snptSituation.commonPortion=u.snptSituation.commonPortion);break}}else u.results=[],u.empty=!0,u.clearSearch(),u.popupSettings.data.reason="E",u.popupSettings.showSearchPopup=!0,u.sendMetric("searchProblem",t);else u.correct="",u.clearSearch(),u.popupSettings.data.reason="E",u.popupSettings.showSearchPopup=!0,u.sendMetric("searchProblem",t)},function(e){u.empty=!0,u.results=[],u.loading=!1;var t=["searchProblem",u.search.query,u.platform];u.sendMetric("searchProblem",t),g("search",1,u.search.query,null,e&&e.status)}))}if(e)u.loading=!0,m.measureStart("tabs"),o.simpleRequest({url:a.searchApiUrl+"search/tabs",headers:{"Content-Type":"application/json; charset=utf-8"},method:"GET",params:s,cache:!1,withCredentials:!0},function(e){u.recipientFilter=u.serviceRecipient.find(function(e){return e.value==u.search.recipient});for(var t=!1,r=0;r<e.length;r++)if(e[r].tab)for(var o,n,i=0;i<u.searchFilter.length;i++)if(u.searchFilter[i].type==e[r].tab){u.searchFilter[i].count=e[r].rs,u.search.filter==u.searchFilter[i].type&&u.searchFilter[i].count&&(t=!0),SmartPhone.isAny()&&u.searchFilter[i].count&&(i?(u.searchFilterMob.push(u.searchFilter[i]),o=u.searchFilterMob.length-1,u.searchFilterMob[o].type==u.search.filter&&(u.searchFilterCurrent=u.searchFilterMob[o])):o=0,n=u.searchFilterMob[o].text.indexOf("("),u.searchFilterMob[o].text=-1==n?u.searchFilterMob[o].text+" ("+u.searchFilter[i].count+")":u.searchFilterMob[o].text.substring(0,n)+"("+u.searchFilter[i].count+")");break}if(u.search.filter=t?u.search.filter:"all",t||u.searchFilter[0].count){for(c=0;c<u.searchFilter.length;c++)if(u.searchFilter[c].type==u.search.filter){l(s,u.search.filter,1);break}}else{u.empty=!0,u.results=[],u.loading=!1,u.clearSearch(),u.popupSettings.data.reason="E",u.popupSettings.showSearchPopup=!0;var a=["searchProblem",u.search.query,u.platform];u.sendMetric("searchProblem",a)}!e||e.error&&0!==e.error.code?g("tabs",1,u.search.query,e&&e.error&&e.error.code,null):g("tabs",0,u.search.query,null,null)},function(e){u.empty=!0,u.results=[],u.loading=!1;var t=["searchProblem",u.search.query,u.platform];u.sendMetric("searchProblem",t),g("tabs",1,u.search.query,null,e&&e.status)});else for(var c=0;c<u.searchFilter.length;c++)if(u.searchFilter[c].type==u.search.filter){l(s,t,u.prevResult.length?u.searchFilter[c].from:1);break}},h=function(e){e=e.replace(/  +/g," ");return 32<(e=e.split(" ")).length&&(e.length=32),e.join(" ")},f=(o.simpleRequest({url:a.catalogApi+"passports/popular",headers:{"Content-Type":"application/json; charset=utf-8"},method:"GET",params:{_:a.cacheRequestStamp,region:i.getFederalNum(),type:"TOP_SPUTNIK",withCredentials:!0}},function(e){if(e&&e.length){for(var t=[],r=[],o=0;o<e.length;o++){var n,i="";e[o].icons&&(i=(n=e[o].icons.find(function(e){return"small"===e.iconType}))?n.path:""),r.push({shortTitle:e[o].shortTitle,icon:i,content:e[o].descr,staticHref:(e[o].isHab?"/group/":"/")+e[o].epguId}),o&&o%2&&(t.push({elements:r}),r=[])}u.popularConfig={rows:t}}}),u.getSearch=function(e,t){u.valueByUserTyped=t,u.search.query=u.search.query||e,u.search.query&&(u.prevResult=[],u.snptPassport={},u.snptDepartment={},u.snptInformation={},u.snptSituation={},angular.forEach(u.searchFilter,function(e){e.active&&(e.active=!1),e.results=[],e.snptPassport={},e.snptDepartment={},e.snptInformation={},e.snptSituation={}}),SmartPhone.isAny()?(u.searchFilterMob&&u.searchFilterMob.length?u.searchFilterMob.length=1:(u.searchFilterMob=[],u.searchFilterMob.push(u.searchFilter[0])),u.searchFilterCurrent=u.searchFilterMob[0]):(r.search("serviceRecipient",u.search.recipient||null),r.search("serviceType",u.search.serviceType||null),null!=u.search.online?r.search("online",u.search.online.toString()):r.search("online",null)),r.search("query",u.search.query),u.myRegion&&u.myRegion.id?c(!0,u.search.filter):n.get().then(function(e){u.myRegion=e,c(!0,u.search.filter)}))},t.query&&n.get().then(function(e){t.serviceRecipient&&(u.search.recipient=t.serviceRecipient),t.serviceType&&(u.search.serviceType=t.serviceType),null!=t.online&&(u.search.online="true"==t.online);try{u.search.query=decodeURIComponent(t.query)}catch(e){u.search.query=t.query}u.myRegion=e,u.getSearch()}),a.$on("updateSearchPage",function(e,t){u.search.query=t,u.getSearch()})),g=(u.isInformationType=function(e){return e.fwa.find(function(e){return"information"===e.EPGUtype})},u.goToResultSearch=function(e){window.location.href=e},u.sendStatistics=function(e,t,r,o){var n={eventType:"snpt"===t?4:5,timestamp:(new Date).getTime(),userType:a.userType||"P",userSelectedRegion:a.userSelectedRegion||"00000000000",userAgent:window.navigator.userAgent,query:u.search.query,referrer:window.location.href},i=a.userId||(l("nau")?l("nau"):l("u")),i=(a.userId?n.u=i:n.nau=i,{}),o=("result"===t?(i={url:e&&e.u||o,sntpTitle:u.snptPassport&&(u.snptPassport.title||u.snptPassport.commonServices&&u.snptPassport.commonServices.title)||u.snptSituation&&u.snptSituation.title||u.snptInformation&&u.snptInformation.title||u.snptDepartment&&u.snptDepartment.title||"-",epguType:u.epguTypeForStatistics||"all",serviceRecipient:u.search.recipient||"PERSON",serviceType:u.search.serviceType||"ALL",isOnline:u.search.online||!1,userRegionOkato:u.myRegion.id,pos_source:"serp"},n=Object.assign(n,i)):"snptDocument"===t&&(i={url:e&&e.u||o,sntpTitle:u.snptPassport&&(u.snptPassport.title||u.snptPassport.commonServices&&u.snptPassport.commonServices.title)||u.snptSituation&&u.snptSituation.title||u.snptInformation&&u.snptInformation.title||u.snptDepartment&&u.snptDepartment.title||"-",ttl:e&&(e.name||e.fullName)||"-",pos:r,pos_source:"widget"},n=Object.assign(n,i)),a.sputnikLogsSearchUrl+("snpt"===t?"widget_expand_log":"search_clicks_log"));return s({method:"POST",url:o,withCredentials:!0,data:n})},function(e,t,r,o,n){r={query:r,userSelectedRegion:a.userSelectedRegion,uid:a.userId||(l("nau")?l("nau"):l("u"))};o&&(r.ServerError=o),n&&(r.BrowserError=n),u.valueByUserTyped&&(r.search_text=u.valueByUserTyped),m.measureEnd(e,t,r)});u.$on("$destroy",function(){f()})}])}(),function(){"use strict";angular.module("catalogPage",["ngRoute"]).config(["$routeProvider",function(r){var o;window.catalogEnabled&&(o={"/catalog":{redirectTo:function(e,t){return t.replace("/catalog","/category")}},"/category":{controller:"categoriesCtrl",resolve:{checkUserType:["userTypeService",function(e){e.redirectToMain()}]},templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/catalog/categories-mob-07f69177cc.html":"/tpl/catalog/categories-pad-3820a7417f.html":"/tpl/catalog/categories-37a968c5b4.html")},"/category/health/exports/diary":{controller:"categoryHealthDiaryExport",templateUrl:window.templatePath+"/tpl/catalog/health-diary-export-a29d437954.html",resolve:{checkUserType:["userTypeService",function(e){e.redirectToMain()}]}},"/category/health":{controller:"categoryHealth",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/catalog/health-mob-05e2498cf9.html":"/tpl/catalog/health-pad-856aa4c4ea.html":"/tpl/catalog/health-817bc424c4.html"),resolve:{checkUserType:["userTypeService",function(e){e.redirectToMain()}]}},"/category/:id":{controller:"categoryCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/catalog/category-mob-bd89b55e6d.html":"/tpl/catalog/category-pad-1b3d1b0a8f.html":"/tpl/catalog/category-c99d06e84b.html"),resolve:{checkUserType:["userTypeService","$ocLazyLoad","$rootScope","$route","GetLazyLoadFile",function(e,t,r,o,n){if(e.redirectToMain(),r.userId&&("transport"===o.current.params.id||"family"===o.current.params.id))return n.get(window.templatePath+"/js/lib/profile-info-4eaecc6884.1682593322983.js",r.staticDomainUrl+"htdocs/js/lib/profile-info-min-a1f574eda0.1682593322983.js")}]}}},Object.keys(o).forEach(function(e){var t=o[e];"/catalog"!==e&&(t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}]),"/category/health/exports/diary"!==e?r.when(e,o[e]).when(e+"/o/:okato",t):r.whenAuthorized(e,o[e])}))}]).controller("categoriesCtrl",["$scope","$rootScope","$routeParams","$timeout","CatalogService","PerformanceService","userTypeService","$location",function(o,n,e,t,r,i,a,s){i.measureStart("allServices"),o.userTypeForTabs=a.getCurrentUserType(),n.breadcrumbs=[{text:"Категории услуг",href:"/catalog"}],n.serviceGroup="",n.pageNameCls="catalog-page categories-page guideline",n.documentTitle("Категории услуг"),o.loading=!0;var l=[];o.$on("catalog-tab-search",function(e,r){o.loading=!0,t(function(){var e=l.filter(function(e){if(e.title&&~e.title.toLowerCase().indexOf(r)||e.description&&~e.description.toLowerCase().indexOf(r))return!0;if(e.passports)for(var t=0;t<e.passports.length;t++)if(e.passports[t].title&&~e.passports[t].title.toLowerCase().indexOf(r)||e.passports[t].description&&~e.passports[t].description.toLowerCase().indexOf(r))return!0});o.categories=splitRows("dk"===n.version?splitRows(e,3):"pad"===n.version?splitRows(e,2):e,3),o.loading=!1},0)}),o.$watchGroup(["userTypeGosBar","changeHeaderFilter"],function(){("F"===n.changeHeaderFilter||n.filterGosBarValue&&"F"===n.filterGosBarValue.userTypeGosBar)&&s.path("/foreign-citizen").hash("landing-popular-services"),o.hideTab=a.hideForUserType(),r.getRootCategories().then(function(e){var t,r;e.data?(l=e.data,i.measureEnd("allServices"),e.data.forEach(function(e){t=e.passports&&e.passports.length||0,r=e.ls&&e.ls.length||0,3<=t&&3<=r?(e.passportsCount=3,e.lsCount=3):t<3?(e.passportsCount=t,e.lsCount=Math.min(r,6-t)):(e.passportsCount=Math.min(t,6-r),e.lsCount=r)}),o.categories="dk"===n.version?splitRows(e.data,3):"pad"===n.version?splitRows(e.data,2):e.data):(i.measureEnd("allServices",1),o.error=!0),o.loading=!1},function(e){i.measureEnd("allServices",1,{BrowserError:e.status}),o.error=!0,o.loading=!1})},!0),o.changeFeed=function(e){LkService.notificationsFilter.feed=e,s.search("type",e),reloadFeed()},o.getIcon=function(e,t,r){if(e.icons&&0<e.icons.length){e=e.icons.find(function(e){if(e.iconType==t)return!0});if(e)return e.path}return r},o.getSearch=function(e){e&&(e=function(e){e=e.replace(/  +/g," ");return 32<(e=e.split(" ")).length&&(e.length=32),e.join(" ")}(e),location.href="/search?query="+e)}}]).controller("categoryCtrl",["$scope","$rootScope","$routeParams","$timeout","PsoWidgetInitializer","CatalogService","userTypeService","$anchorScroll","CMSService","$controller","$location",function(a,s,l,r,o,c,u,n,e,t,i){s.userId&&("transport"===l.id||20<=s.user.al&&"family"===l.id)&&(console.log(a),t("profileInfoCtrl",{$scope:a}),a.infoBlockName=l.id),a.occasionsObj={title:"Жизненные ситуации",sign:"Узнайте как правильно действовать в вашей жизненной ситуации: <br> куда обращаться, как подготовить и подать документы и какие нормы законодательства вам помогут"},$("#footer-placeholder").remove(),l.id=l.id||"health",a.linksList=[],s.breadcrumbs=[{text:"Категории услуг",href:"/catalog"},{text:"Категория",href:"/catalog/"+l.id}],s.pageNameCls="catalog-page passport-page guideline without-bottom-padding",s.documentTitle("Категории услуг"),a.loading=!0,a.popular={shown:!0},a.scrollToAnchorLink=function(e,t){e.preventDefault(),n(t),r(function(){n(t)},50)},a.voteCatalogClick=function(e){"312414"!==e&&"340139"!==e||window.metricReachGoal24845174("312414"===e?"voteregCatalogClick":"votedumCatalogClick",{okato:s.userSelectedRegion}),i.path("/"+e)},c.getCategory(l.id).then(function(e){var t,n,i=e.data;i?(s.serviceGroup=i.code,t={},Object.keys(i).forEach(function(e){"children"==e?(t.children=[],i[e].forEach(function(e){(e.passports||e.children&&e.children.some(function(e){return e.passports}))&&t.children.push(e)})):t[e]=i[e]}),a.category=t,i.passports&&0<i.passports.length&&(i.passports.forEach(function(e){var t;e.icons&&(t=e.icons.find(function(e){if("small"==e.iconType)return!0})),e.icon=t?t.path:s.imgPath+"services/nut_arrow.svg"}),a.category.splittedPassports=splitRows(i.passports,2),a.category.splittedHealthPassports=(s.version,splitRows(i.passports,2))),s.documentTitle(i.title),s.breadcrumbs=[{text:"Категории услуг",href:"/catalog"},{text:i.title}],(s.filterGosBarValue||u.getUserType()).occasionType,a.$watchGroup(["userTypeGosBar","changeHeaderFilter","userSelectedRegion"],function(){var e;a.typeForElm="L"==s.userTypeGosBar||"L"==s.userType?"legal":"B"==s.userTypeGosBar||"B"==s.userType?"entrepreneurs":"F"==s.userTypeGosBar||"F"==s.userType?"foreign":null,"health"==l.id&&(e="health"),s.userSelectedRegion&&c.getElmDetails("serviceCategories",e||l.id,a.typeForElm).then(function(e){if(a.linksList=[],a.categorySeo=[],a.categoryFaq=[],a.categoryFaqLinks=[],a.categoryLS=[],a.categoryTargets=[],a.categoryPassports=[],a.categoryHabs=[],a.categoryNews=[],a.categoryPromo=[],a.allCategoriesAnchor=e.data.news&&e.data.news.items&&e.data.news.items.length||e.data.faq&&e.data.faq.items&&e.data.faq.items.length||e.data.faqCategories&&e.data.faqCategories.items&&e.data.faqCategories.items.length?"allCategories":"custom-footer",i.passports&&0<i.passports.length&&a.linksList.push({title:"Популярные услуги",anchor:"popServices"}),e.data){var t=[];if(e.data.seo&&e.data.seo.items&&e.data.seo.items.length&&(a.categorySeo=e.data.seo.items[0]),e.data.ls&&e.data.ls.items&&e.data.ls.items.length&&(a.categoryLS=e.data.ls.items,a.lsRows=splitRows(a.categoryLS,2),e.data.lsCategory&&e.data.lsCategory.items&&e.data.lsCategory.items.length&&(a.lsButton=e.data.lsCategory.items[0]),a.linksList.push({title:"Жизненные ситуации",anchor:"lifeSituations"})),a.haveChildrenPassportsOrChildren=a.category.children&&a.category.children.some(function(e){return e.children||e.passports}),!a.haveChildrenPassportsOrChildren&&$.isEmptyObject(a.regional)&&"00000000000"!=s.userSelectedRegion||a.linksList.push({title:"Категории услуг",anchor:a.allCategoriesAnchor}),e.data.faq&&e.data.faq.items&&e.data.faq.items.length&&(a.categoryFaq=e.data.faq.items),e.data.faqCategories&&e.data.faqCategories.items&&e.data.faqCategories.items.length&&(a.categoryFaqLinks=e.data.faqCategories.items),(a.categoryFaq.length||a.categoryFaqLinks.length)&&a.linksList.push({title:"Частые вопросы",anchor:"faq"}),e.data.target&&e.data.target.items&&e.data.target.items.length&&(a.categoryTargets=e.data.target.items.slice(0,3),t.push(a.categoryTargets)),e.data.passport&&e.data.passport.items&&e.data.passport.items.length&&(a.categoryPassports=e.data.passport.items.slice(0,3),t.push(a.categoryPassports)),e.data.hab&&e.data.hab.items&&e.data.hab.items.length&&(a.categoryHabs=e.data.hab.items.slice(0,3),t.push(a.categoryHabs)),t.length){var r=t[0].concat(t[1],t[2]);a.elmServices=[];for(var o=0;o<3;o++)void 0!==r[o]&&a.elmServices.push(r[o]);a.linksList.push({title:"Связанные услуги",anchor:"services"}),a.elmServices=splitRows(a.elmServices,2)}e.data.news&&e.data.news.items&&e.data.news.items.length&&(a.categoryNews=e.data.news.items,a.linksList.push({title:"Полезные материалы",anchor:"custom-footer"})),!a.categoryNews.length&&a.categorySeo.content?a.seoAnchor="custom-footer":a.seoAnchor="",e.data.banner&&e.data.banner.items&&e.data.banner.items.length&&e.data.banner.items[0].content&&(a.categoryPromo=e.data.banner.items[0],a.categoryPromo.needShow=!0),a.linksList="pad"==s.version?d(a.linksList,3):a.linksList}else i.passports&&0<i.passports.length&&a.linksList.push({title:"Популярные услуги",anchor:"popServices"}),a.category.children&&0<a.category.children.length&&a.linksList.push({title:"Категории услуг",anchor:a.allCategoriesAnchor});return e}).then(function(e){e=e&&e.data;o.manualCompletePsoLazyWidgetInitializationDataAcquiring({explicitContextFaqs:e&&e.faq&&e.faq.items||null})})}),a.category.children&&0<a.category.children.length&&(a.category.children.length=6<a.category.children.length?6:a.category.children.length,n=!1,a.category.children.forEach(function(r,e){var t,o=!(r.categories=[]);r.passports&&0<r.passports.length&&((t={title:""}).id=r.id,"health"==l.id?t.passports="dk"==s.version?splitRows(r.passports,2):r.passports:t.passports=r.passports,r.categories.push(t),o=!0),r.children&&r.children.forEach(function(e){var t;e.passports&&((t={title:e.title}).id=e.id,"health"==l.id?t.passports="dk"==s.version?splitRows(e.passports,2):e.passports:t.passports=e.passports,r.categories.push(t),o=!0)}),r.shown=n,o&&(n=!1)})),e=s.userSelectedRegion&&s.userSelectedRegion.slice(0,2),"culture"===i.code&&(e&&"92"!==e&&"91"!==e)&&(a.incomingWidget={url:s.cultureWidgetUrl,urlParams:{okato:s.userSelectedRegion},requestMethod:"get",widgetId:"widgetCulture",widgetMetrics:{name:"minkult",onload:"view",onclick:"action"}})):a.error=!0,a.loading=!1},function(){a.error=!0,a.loading=!1});var d=function(e,r){for(var o=[],t=0;t<r;t++)o.push([]);return e.forEach(function(e,t){o[t%r].push(e)}),o};c.getCategoriesByRegion(l.id).then(function(e){var r={};e.data&&e.data.length&&e.data.forEach(function(e){var t=e.stateStructure;r[t]||(r[t]=[],r[t].habsCount=0),r[t].push(e),e.isHab&&r[t].habsCount++}),a.regional=r}),c.getOtherOccasions("category",l.id).then(function(e){(e=e)&&e.data&&200==e.status?a.occasions=e.data.filter(function(e){return!e.personType}):(a.loading=!0,a.occasionsError=!0)}),"transport"===a.infoBlockName&&e.getTargetPlaces("action_card_MIR",!0).then(function(e){a.actionCardMirBanner=e.action_card_MIR&&e.action_card_MIR.list}),a.showCardMirBanner=function(){return"transport"===this.infoBlockName&&a.actionCardMirBanner&&a.actionCardMirBanner.length}}]).controller("categoryHealth",["$scope","$http","$routeParams","$rootScope","CatalogService","$controller","animatedClickScroll","$moment","RegionService","PerformanceService","HealthInformers","CMSService",function(r,e,t,o,n,i,a,s,l,c,u,d){function p(e){console.log(e)}function m(){r.medicalHelp.emptyCardList=!0}function h(){r.medicalHelp.isLoad=!0,r.medicalHelp.notLoginedState=!0}function f(e){r.doctorInformers[e].isLoad=!0,r.doctorInformers[e].notLoginedState=!0}i("categoryCtrl",{$scope:r}),o.pageNameCls="catalog-page passport-page catalog-health-page guideline",o.breadcrumbs=[{text:"Категории услуг",href:"/catalog"},{text:"Моё здоровье"}],r.elnBannerEnabled=!1,r.healthObj={pageLinks:[{title:"Запись и вызов врача",id:0},{title:"Сведения о медицинской помощи",id:1},{title:"Популярные услуги",id:2},{title:"Категории услуг",id:3},{title:"Остались вопросы",id:5},{title:"Полезные ресурсы",id:6}]},r.goToBlock=function(e,t){t&&t.preventDefault(),a.scrollToElement("health",e)},r.doctorInformers=u.getInformersConfig(),r.medicalHelp={iconUrl:"https://gu-st.ru/content/catalog/pas/23.svg",title:"Сведения об оказанной медицинской помощи",lastUpdateText:"Последнее обновление выписки",emptyDataText:"Посмотрите все записи из вашей медицинской карты прямо сейчас",link:"94757/1/",passportId:"94757",formLink:"94757/1/form",errorText:"Извините, временно нет доступа к информации об оказанных медицинских услугах. Попробуйте обновить страницу через некоторое время.",epguUrlTitle:"",refresh:function(e,t){t.preventDefault(),this[e](!0)},extractMedicalCard:function(e){r.medicalHelp.isLoad=!1,r.medicalHelp.informerError=!1,c.measureStart("medicalCardInformer"),n.healthCard(e).then(function(e){e.error&&0!=e.error.errorCode?(c.measureEnd("medicalCardInformer",1,{BrowserError:e.error.errorCode}),r.medicalHelp.informerError=!0):e&&e.content&&(c.measureEnd("medicalCardInformer",0),(e=JSON.parse(e.content)).lastUpdated&&(r.medicalHelp.lastUpdated=s(e.lastUpdated).format("HH:mm DD.MM.YYYY")),e.elements)&&e.elements.length?(r.medicalHelp.informerData=e.elements,r.medicalHelp.informerData.sort(function(e,t){e=e.cureEndDate||e.cureStartDate,t=t.cureEndDate||t.cureStartDate;return s(t)._d.getTime()-s(e)._d.getTime()})):(c.measureEnd("medicalCardInformer",0),m()),r.medicalHelp.isLoad=!0},function(e){e&&e.status&&c.measureEnd("medicalCardInformer",1,{ServiceError:e.status}),p(e),r.medicalHelp.informerError=!0,r.medicalHelp.isLoad=!0})}};i=function(){var e=["10066","10067","10068"];if(o.assuranceLevel!=="AL10")e.push("94757");else h();if(o.recipePageEnabled==="true")e.push("10078");if(o.userId&&o.userType==="P")if(o.assuranceLevel==="AL20")r.elnBannerEnabled=true;else f(1);else{f(0);f(1);h()}return e}(),l.checkRegions(i).then(function(e){e&&e.data?((e.data.hasOwnProperty("10066")||e.data.hasOwnProperty("10068"))&&(r.doctorInformers[0].show=e.data[10068]||e.data[10066]||!1,r.doctorInformers[0].link=e.data[10068]?"/10068/1/":e.data[10066]?"/10066/1/":"",r.doctorInformers[0].formLink=e.data[10068]?"/10068/1/form":e.data[10066]?"/10066/1/form":"",r.doctorInformers[0].passportId=e.data[10068]?"10068":e.data[10066]?"10066":"",o.logined)&&r.doctorInformers[1].makeDoctor(),e.data.hasOwnProperty("10067")&&(r.doctorInformers[1].show=e.data[10067]||!1,o.logined)&&r.doctorInformers[0].callDoctor(),e.data.hasOwnProperty("94757")&&(r.medicalHelp.show=e.data[94757]||!1,o.logined)&&r.medicalHelp.extractMedicalCard(!1),e.data.hasOwnProperty("10078")&&(r.showRecipesLink=e.data[10078]||!1)):(f(0),f(1),h())}),d.getFaqAnswers("zdravoohranenie").then(function(e){r.healthObj.questions={children:[]},e&&e.data&&200==e.status&&e.data.children.forEach(function(e){e.faqs.forEach(function(e){r.healthObj.questions.children.push(e)})})},function(e){p(e)}),n.healthResources().then(function(e){e&&e.data&&200==e.status?r.healthObj.resources=e.data:p(e)},function(e){p(e)}),d.getTargetPlaces("mobapp_simple_full").then(function(e){for(var t in e)r[t]=e[t].list,r[t+"_len"]=e[t].list?e[t].list.length:0,0==e[t].list.length&&(r[t]=e[t][t+"_bg"])})}]).controller("categoryHealthDiaryExport",["$scope","$http","$routeParams","$rootScope","CatalogService","$controller","$moment",function(o,e,t,n,r,i,a){i("categoryCtrl",{$scope:o}),n.pageNameCls="catalog-page passport-page catalog-health-page guideline",n.breadcrumbs=[{text:"Категории услуг",href:"/catalog"},{text:"Моё здоровье"}],o.exportParams={dateFrom:"",dateTo:"",exportPulse:!1,exportTemp:!1,exportSympth:!1,exportSuppl:!1},o.$watchGroup(["exportParams.dateFrom","exportParams.dateTo","exportParams.exportPulse","exportParams.exportTemp","exportParams.exportSympth","exportParams.exportSuppl"],function(e,t){var r;""!=o.exportParams.dateFrom&&""!=o.exportParams.dateTo&&((r=Object.assign({},o.exportParams)).dateFrom=a(o.exportParams.dateFrom,"DD.MM.YYYY").format("YYYY-MM-DD"),r.dateTo=a(o.exportParams.dateTo,"DD.MM.YYYY").format("YYYY-MM-DD"),o.exportUrl=n.lkApi+"coronavirus/questionnaire/journal?"+$.param(r))})}])}(),function(){"use strict";angular.module("invintation",["ngRoute","ui.mask"]).config(["$routeProvider",function(e){e.when("/invintation/sign",{controller:"invintationResults",templateUrl:window.templatePath+"/tpl/invintation/"+(SmartPhone.isAny()?"invintation-mob.html":"invintation.html")}).when("/invintation/requestAgreement",{controller:"invintationResults",templateUrl:window.templatePath+"/tpl/invintation/"+(SmartPhone.isAny()?"invintation-mob.html":"invintation.html")}).whenAuthorized("/invitation/europrotocol",{controller:"invintationEuroprotocol",templateUrl:window.templatePath+"/tpl/invintation/invintation-europrotocol-f1ed6e192c.html"})}]).factory("simpleResults",["$http","$rootScope",function(n,i){return{simpleRequest:function(e,t,r){n(e).success(function(e){t(e)}).error(function(e,t){r&&r(e,t)})},getEurprotocolUserBData:function(e,t,o){return n({url:i.lkApi+"europrotocol/"+e,headers:{"Content-Type":"application/json; charset=utf-8"},method:"GET",cache:!1,withCredentials:!0,params:{_:Math.random()}}).success(function(e){t(e)}).error(function(e,t,r){o(t,e)})},sendEurprotocolUserBData:function(e,t,r,o){return n({url:i.lkApi+"europrotocol/"+t,headers:{"Content-Type":"application/json; charset=utf-8"},method:"POST",cache:!1,withCredentials:!0,data:e}).success(function(e){r(e)}).error(function(e,t){o(t,e)})}}}]).controller("invintationResults",["$scope","$rootScope","$routeParams","$location","simpleResults",function(o,e,t,r,n){o.routeParams=t,o.loading=!0,o.error=!1,e.pageNameCls="invitation-page";var i=r.$$path.split("/").reverse()[0];n.simpleRequest({url:e.bigBroUrl+"/api/lk/v1/orders/invitations/"+{sign:"inviteToSign/",requestAgreement:"requestAgreement/",europrotocol:"inviteToEuroprotocol/"}[i]+t.ac,headers:{"Content-Type":"application/json; charset=utf-8"},method:"GET",cache:!1,withCredentials:!0},function(e){o.loading=!1;e=e.servicePassportId+"/"+e.serviceEpguId+"/order/"+e.id;r.url(e)},function(e,t){if(o.loading=!1,o.error=!0,t&&409==t&&e){if(o.cls="",e.title&&(o.title=e.title),e.errors&&e.errors.length){o.message="";for(var r=0;r<e.errors.length;r++)o.message+=e.errors[r].message}}else if(t&&400==t&&e)if(o.cls="unvisible",e.title&&(o.title=e.title),e.errors&&e.errors.length){o.message="";for(r=0;r<e.errors.length;r++)o.message+=e.errors[r].message}else o.message="Извините, сервис временно не доступен.</br>Попробуйте еще раз перейти по ссылке из электронного письма с приглашением через некоторое время.";else o.cls="unvisible",o.message="Извините, сервис временно не доступен.</br>Попробуйте еще раз перейти по ссылке из электронного письма с приглашением через некоторое время."})}]).controller("invintationEuroprotocol",["$scope","$rootScope","$routeParams","$location","$timeout","simpleResults","$moment","ProfileTabService","RolesConfig","animatedIdScroll","$window","$document",function(r,t,e,o,n,i,a,s,l,c,u,d){r.routeParams=e,r.loading=!0,r.error=!1,r.conditionalsIsApproved=!1,t.pageNameCls="invitation-europrotocol-page",t.breadcrumbs=[{text:"Категории услуг",href:"/catalog"}];function p(e){r.orderId?"ORDER_SENT"===r.invintationStatus?location.href=t.lkUrl+"/notifications/details/ORDER/"+r.orderId:location.href=t.betaUrl+t.europrotocolServiceId+"/form/order/"+r.orderId:m(e)}function m(e){r.invintationError=!0,r.errorType=e,r.loading=!1}function h(){var e;r.birthDate=a(r.euroFormData.main.birthDate).format("DD.MM.YYYY"),r.euroFormData.owner||(r.euroFormData.owner={},r.euroFormData.owner.owner=!0),r.euroFormData.main.birthDate=r.formatDate(r.euroFormData.main.birthDate),r.euroFormData.driverLicense&&(r.euroFormData.driverLicense.seriesNumber=r.euroFormData.driverLicense.series+" "+r.euroFormData.driverLicense.number,r.euroFormData.driverLicense.issued=r.euroFormData.driverLicense.issued&&r.formatDate(r.euroFormData.driverLicense.issued),r.euroFormData.driverLicense.expired=r.euroFormData.driverLicense.expired&&r.formatDate(r.euroFormData.driverLicense.expired)),r.euroFormData.main.address&&r.euroFormData.main.address.length&&80<r.euroFormData.main.address.length&&(r.euroFormData.main.address=r.euroFormData.main.address.substring(0,79)),r.tsCategories=[{name:"A, М",selected:!1,value:"A"},{name:"B, BЕ",selected:!1,value:"B"},{name:"C, CЕ",selected:!1,value:"C"},{name:"D, DЕ",selected:!1,value:"D"},{name:"Tm, Tb",selected:!1,value:"E"}],r.vehicleChoose=[{text:"Добавить новое",value:null}],r.euroFormData.driverLicense&&r.euroFormData.driverLicense.category&&r.euroFormData.driverLicense.category.split(",").forEach(function(t){r.tsCategories.forEach(function(e){t===e.value&&(e.selected=!0,r.categoriesValid=!0)})}),r.euroFormData.profileVehicles&&r.euroFormData.profileVehicles.length&&(e=r.euroFormData.profileVehicles.map(function(e){return{text:e.name||e.regmark,value:e}}),r.vehicleChoose=e.concat(r.vehicleChoose),!(e.length<=1))||(r.euroFormData.vehicleSelection=r.vehicleChoose[0]),r.conditionalsIsApproved="INVITE_CHECKED"!==r.invintationStatus,r.euroFormData.vehicleNotRegistered=!r.euroFormData.vehicleSelection&&"INVITE_CHECKED"!==r.invintationStatus,r.personType="fiz",r.loading=!1,r.euroFormData.vehicle=r.euroFormData.vehicle||{},r.euroFormData.driverLicense=r.euroFormData.driverLicense||{}}u.addEventListener("offline",function(){r.showToast("Нет соединения с интернетом","warning")}),u.addEventListener("online",function(){r.showToast("Соединение с интернетом восстановлено","info")}),r.showToast=function(e,t){var r=d.getElementById("toast-container"),o=(r||((r=d.createElement("div")).id="toast-container",d.body.appendChild(r)),d.createElement("div")),n=d.createElement("div"),i=d.createElement("div");o.classList.add("toast","toast--"+t),i.className="toast__close",n.className="toast__body",n.innerText=e,o.append(n,i),r.append(o),setTimeout(function(){o.remove(),r.childElementCount||r.remove()},5e3),i.onclick=function(){o.remove()}},r.formatDate=function(e,t){return t?a(e,"DD.MM.YYYY").format(t):a(e).format("DD.MM.YYYY")},r.changeOwner=function(){r.formDisabled||(r.euroFormData.owner.owner=!r.euroFormData.owner.owner)},r.selectCategories=function(e,t){r.formDisabled||(r.tsCategories[t].selected=!r.tsCategories[t].selected,r.categoriesValid=r.tsCategories.some(function(e){return!0===e.selected}))},r.changeSelection=function(e,t){r.formDisabled||(r[t]=e)},r.approveConditionals=function(){r.conditionalsIsApproved=!0},r.redirectToForm=function(){r.invintationStatus="INVITE_CHECKED"},r.isDisclaimersShow=function(){return-1!==["INVITE_SAVED","DATA_SAVED","ORDER_WAIT"].indexOf(r.invintationStatus)},r.checkIntervalRef=null,r.startIntervalCheck=function(){clearInterval(r.checkIntervalRef),r.checkIntervalRef=setInterval(()=>{r.isDisclaimersShow()?r.checkOrder():clearInterval(r.checkIntervalRef)},1e4)},"P"===t.userType?i.getEurprotocolUserBData(r.routeParams.ac,function(e){if(e&&e.status)switch(r.euroFormData=e.data,r.invintationStatus=e.status,r.message=e.message,r.orderId=e.orderId,r.invintationStatus){case"INVITE_CHECKED":h();break;case"INVITE_UNKNOWN_PERSON":case"INVITE_NOT_CONFIRM_PERSON":m("bad");break;case"INVITE_SAVED":case"ORDER_WAIT":h(),r.startIntervalCheck();break;case"ORDER_CREATED":p("search");break;case"ORDER_SENT":p("good");break;default:m("bad")}},function(e,t){if(e)switch(e){case 409:m("bad"),r.errorCode=t&&t.code,r.message=t&&t.message,r.invintationStatus="INVALID";break;case 404:o.url("/404");break;case 500:m("bad"),r.message="Извините, сервис временно недоступен.",r.invintationStatus="Internal_Server_Error";break;default:m("bad")}else m("bad")}):(r.message='Страница доступна только для физических лиц. Пожалуйста, <a ng-click="switchRole()">переключите роль</a>.',r.invintationStatus="INVITE_NOT_CONFIRM_PERSON",m("bad"),t.profile=l.get(),s.getUserRoles()),r.regmarkRegexp=/^(([ABCEHKMOPXYTabcehkmopxytАВСЕНКМОРХУТавсенкморхут]{2}((\d{3}[ABCEHKMOPXYTabcehkmopxytАВСЕНКМОРХУТавсенкморхут]\d{2})|(\d{5})))|([ABCEHKMOPXYTabcehkmopxytАВСЕНКМОРХУТавсенкморхут]{1,2}\d{6})|(\d{3}[ABCEHKMOPXYTabcehkmopxytАВСЕНКМОРХУТавсенкморхут]{1,2}\d{2})|([ABCEHKMOPXYTabcehkmopxytАВСЕНКМОРХУТавсенкморхут]\d{3}[ABCEHKMOPXYTabcehkmopxytАВСЕНКМОРХУТавсенкморхут]{2}(\d{2,3})?)|(\d{9})|(\d{3}(([ABCEHKMOPXYTabcehkmopxytАВСЕНКМОРХУТавсенкморхут]\d{5})|(\d[ABCEHKMOPXYTabcehkmopxytАВСЕНКМОРХУТавсенкморхут]{1,2}\d{2})))|(\d{4}[а-яА-ЯёЁ]{2,3})|([а-яА-ЯёЁ]\d{4}[а-яА-ЯёЁ]{2})|([а-яА-ЯёЁ]{3}\d{4})|(\d{3}(CD|cd)\d{3}))$| (^$)/,r.checkOrder=function(){i.getEurprotocolUserBData(r.routeParams.ac,function(e){e&&-1!==["INVITE_SAVED","DATA_SAVED","ORDER_WAIT"].indexOf(e.status)&&r.startIntervalCheck(),e&&e.orderId?"ORDER_SENT"===e.status?location.href=t.lkUrl+"/notifications/details/ORDER/"+ +e.orderId:location.href=t.betaUrl+t.europrotocolServiceId+"/form/order/"+e.orderId:e.status&&(r.invintationStatus=e.status)})},r.addErrorState=function(e){document.getElementById(e).classList.add("error-validation-europrotocol")},r.validate=function(){r.isValid=!0,r.categoriesValid=null!=r.categoriesValid&&r.categoriesValid;function e(t){Object.keys(t).every(function(e){return t[e]?n(function(){document.getElementById(e).classList.remove("error-validation-europrotocol")},0):(r.addErrorState(e),r.isValid=!1),!0})}return e({mainPhone:r.euroFormData.main.phone,mainAddress:r.euroFormData.main.address,dlSeriesNumber:r.euroFormData.driverLicense.seriesNumber,dlIssued:r.euroFormData.driverLicense.issued,dlExpired:r.euroFormData.driverLicense.expired,tsCategory:r.categoriesValid,vehicleSelectors:r.euroFormData.vehicleSelection}),r.euroFormData.vehicleSelection?null!==r.euroFormData.vehicleSelection.value||r.euroFormData.vehicleNotRegistered||e({vehicleSelectManualRegmark:r.euroFormData.vehicle.regmark,vehicleSelectManualCertSeries:r.euroFormData.vehicle.certSeries,vehicleSelectManualCertNumber:r.euroFormData.vehicle.certNumber,vehicleSelectManualName:r.euroFormData.vehicle.name}):(r.addErrorState("vehicleSelectors"),r.isValid=!1),r.euroFormData.owner.owner||(r.personType?r.euroFormData&&("fiz"===r.personType&&e({notOwnerFizFullname:r.euroFormData.owner.fullname,notOwnerBusinessAddress:r.euroFormData.owner.address}),"business"===r.personType)&&e({notOwnerBusinessName:r.euroFormData.owner.orgName,notOwnerBusinessAddress:r.euroFormData.owner.address}):(r.addErrorState("notOwnerType"),r.isValid=!1)),r.isValid},r.saveDetails=function(){var e,t;r.validate()&&((e=angular.copy(r.euroFormData)).vehicleSelection&&e.vehicleSelection.value&&(e.vehicle=e.vehicleSelection.value),e.driverLicense.issued=r.formatDate(e.driverLicense.issued,"YYYY-MM-DD"),e.driverLicense.expired=r.formatDate(e.driverLicense.expired,"YYYY-MM-DD"),e.driverLicense.series=e.driverLicense.seriesNumber.slice(0,4).trim(),e.driverLicense.number=e.driverLicense.seriesNumber.slice(4).trim(),e.vehicleNotRegistered&&delete e.vehicle,e.driverLicense.category=r.tsCategories.filter(function(e){return e.selected}).map(function(e){return e.value}).join(", "),r.orderMessage=null,e.owner.owner&&!0===e.owner.owner?e.owner={owner:!0}:e.owner.fullname&&(t=e.owner.fullname.split(" "),e.owner.surname=(t[0]||"").trim(),e.owner.firstname=(t[1]||"").trim(),e.owner.middlename=(t[2]||"").trim(),delete e.owner.fullname),delete e.main.birthDate,delete e.profileVehicles,delete e.vehicleSelection,delete e.driverLicense.seriesNumber,delete e.vehicleNotRegistered,i.sendEurprotocolUserBData(e,r.routeParams.ac,function(e){r.checkOrder(),r.invintationStatus="INVITE_SAVED"},function(e,t){e&&409==e&&t&&t.message?r.showToast(t.message,"warning"):e&&500==e?r.showToast("Извините, сервис временно недоступен.","warning"):e&&400==e?r.showToast("Не удалось сохранить данные. Пожалуйста, проверьте корректность введенных сведений и повторите попытку.","warning"):(r.showToast("Не удалось сохранить данные. Пожалуйста, проверьте корректность введенных сведений и повторите попытку.","warning"),r.invintationStatus="DATA_NOT_SAVED")}))},r.switchRole=function(){var e;t.profile&&t.profile.roles?(e=t.profile.roles.find(function(e){return"PERSON"===e.personType})).onClickRole(e.active):location.href=t.lkUrl+"roles"}}])}(),function(){"use strict";angular.module("frgu",["ngRoute","bindHtmlCompile"]).constant("regionalServiceData",[]).config(["$routeProvider","regionalServiceData",function(r,e){var o,t={controller:"vaccineCtrl",templateUrl:window.templatePath+"/tpl/frgu/vaccine-69016f3932.html"},n=Object.assign({},t,{resolve:{loadFrguCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/frgu-a0ae920dc6.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/frgu-min-ba5396f519.1682593322983.js")}]}}),i={controller:"covidPdfCtrl",templateUrl:window.templatePath+"/tpl/frgu/covid-pdf-0281fb80e9.html"},a=Object.assign({},i,{resolve:{loadFrguCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/frgu-a0ae920dc6.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/frgu-min-ba5396f519.1682593322983.js")}]}});window.isEmbedded?r.when("/mobile/card/10600/1",t).when("/mobile/card/10600/2",i).when("/mobile/card/:passportId:\\d{5,6}/:targetId:\\d{1,3}",{controller:"handcraftCtrl",templateUrl:function(e){return"327605"==e.passportId&&"1"==e.targetId?window.templatePath+(SmartPhone.isAny()&&SmartPhone.isPhone()?"/tpl/frgu/election-mob-3ffaf4e7ec.html":"/tpl/frgu/election-9aed54a95b.html"):window.templatePath+"/tpl/frgu/handcraft-f85c402270.html"}}):(e.forEach(function(e){var t={controller:"regsvcController",templateUrl:window.templatePath+"/tpl/frgu/regsvc-"+e.serviceCode+".html",resolve:{loadFrguCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/frgu-a0ae920dc6.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/frgu-min-ba5396f519.1682593322983.js")}],regionalService:function(){return e}}};r.when("/regsvc/"+e.serviceCode,t),r.when(e.originalUrl,t)}),o={"/10600/1/info":Object.assign({redirectTo:function(){return"/10600/1"}},n),"/:passportId:\\d{5,6}/:targetId:\\d{1,3}/info":{controller:"frguCtrl",templateUrl:window.templatePath+(window.mobileVersion?"/tpl/frgu-mob-4361e2f678.html":"/tpl/frgu-1d9c75bc28.html"),resolve:{loadFrguCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/frgu-a0ae920dc6.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/frgu-min-ba5396f519.1682593322983.js")}]}},"/:passportId:\\d{5,6}|mfc/:targetId:\\d{1,3}":{controller:"handcraftCtrl",templateUrl:function(e){return"327605"==e.passportId&&"1"==e.targetId?window.templatePath+(SmartPhone.isAny()&&SmartPhone.isPhone()?"/tpl/frgu/election-mob-3ffaf4e7ec.html":"/tpl/frgu/election-9aed54a95b.html"):window.templatePath+"/tpl/frgu/handcraft-f85c402270.html"},resolve:{loadFrguCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/frgu-a0ae920dc6.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/frgu-min-ba5396f519.1682593322983.js")}]}},"/:passportId:\\d{5,6}/:targetId:/info/:block":{controller:"frguCtrl",templateUrl:window.templatePath+"/tpl/frgu-info-mob-ea10825364.html",resolve:{loadFrguCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/frgu-a0ae920dc6.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/frgu-min-ba5396f519.1682593322983.js")}]}},"/:passportId:\\d{5,6}/info":{redirectTo:function(e){return"/"+e.passportId+"/1/info"}},"/:passportId:\\d{5,6}/:targetId:\\d{1,3}/info/:block":{controller:"frguCtrl",templateUrl:window.templatePath+"/tpl/frgu-info-mob-ea10825364.html",resolve:{loadFrguCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/frgu-a0ae920dc6.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/frgu-min-ba5396f519.1682593322983.js")}]}},"/:id:\\d{5,6}|mfc":{controller:"passportCtrl",templateUrl:function(e){return"10005"==e.id||"10010"==e.id||"10011"==e.id?window.templatePath+"/tpl/frgu/handcraft-f85c402270.html":window.templatePath+"/tpl/catalog/passport-a02dc23a71.html"},resolve:{loadFrguCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/frgu-a0ae920dc6.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/frgu-min-ba5396f519.1682593322983.js")}]}},"/group/:id":{controller:"passportCtrl",templateUrl:function(e){return window.templatePath+"/tpl/catalog/passport-a02dc23a71.html"},resolve:{loadFrguCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/frgu-a0ae920dc6.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/frgu-min-ba5396f519.1682593322983.js")}]}}},Object.keys(o).forEach(function(e){Math.random();var t=o[e];"/:passportId:\\d{5,6}/info"!==e?(t.resolve=t.resolve||{},t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}]):t.redirectTo=function(e){return"/"+e.passportId+"/1/info/o/"+e.okato},r.whenAuthorized("/10600/1",n).whenAuthorized("/10600/2",a).when(e,o[e]).when(e+"/o/:okato",t).when(e+"/r/:region",t)}))}])}(),function(){"use strict";angular.module("zkhPage",["epguNgRoute"]).config(["$routeProvider",function(r){var o;window.isEmbeddedZkh?r.whenAuthorized("/mobile/zkh",{controller:"zkhController",templateUrl:window.templatePath+"/tpl/gkh/zkh-001bce9774.html",reloadOnSearch:!1}):(o={"/10373/form":{controller:"zkhController",templateUrl:window.templatePath+"/tpl/gkh/zkh-001bce9774.html",reloadOnSearch:!1,resolve:{loadZkhPageCtrl:["$ocLazyLoad","$rootScope",function(e,t){return e.load(t.pageCtrlPath+"zkh"+(t.disableMetric?".js":"-min.js"))}]}}},Object.keys(o).forEach(function(e){var t=o[e];"/10777/1/form"!==e&&(t.resolve=t.resolve||{},t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}]),r.whenAuthorized(e,o[e]).whenAuthorized(e+"/o/:okato",t)}))}])}(),function(){"use strict";angular.module("structurePage",["ngRoute"]).config(["$routeProvider",function(r){var o={"/structure":{controller:"structuresCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/structure/structures-mob-ca96636ba1.html":"/tpl/structure/structures-pad-03f3d155d0.html":"/tpl/structure/structures-f3605abce5.html"),reloadOnSearch:!1,resolve:{checkUserType:["userTypeService",function(e){e.redirectToMain()}],loadStructureCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/structure-64616478f8.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/structure-min-83478772dd.1682593322983.js")}]}},"/structure/:id":{controller:"structureCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/structure/structure-mob-a7db5e4d2d.html":"/tpl/structure/structure-pad-ead97b3fe4.html":"/tpl/structure/structure-faba940e57.html"),reloadOnSearch:!1,resolve:{checkUserType:["userTypeService",function(e){e.redirectToMain()}],loadStructureCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/structure-64616478f8.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/structure-min-83478772dd.1682593322983.js")}]}},"/structure/:id/:currentTab":{controller:"structureCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/structure/structure-mob-a7db5e4d2d.html":"/tpl/structure/structure-pad-ead97b3fe4.html":"/tpl/structure/structure-faba940e57.html"),reloadOnSearch:!1,resolve:{checkUserType:["userTypeService",function(e){e.redirectToMain()}],loadStructureCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/structure-64616478f8.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/structure-min-83478772dd.1682593322983.js")}]}}};Object.keys(o).forEach(function(e){var t=o[e];t.resolve=t.resolve||{},t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}],r.when(e,o[e]).when(e+"/o/:okato",t)})}])}(),function(){"use strict";angular.module("occasionPage",["ngRoute"]).config(["$routeProvider",function(r){var o={"/situation":{controller:"occasionsCtrl",templateUrl:window.templatePath+"/tpl/occasion/occasions-5ffef39466.html",reloadOnSearch:!1,resolve:{checkUserType:["userTypeService",function(e){e.redirectToMain()}],loadOccasionCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/occasion-5c7a9b38f1.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/occasion-min-6856cb1621.1682593322983.js")}]}}};Object.keys(o).forEach(function(e){var t=o[e];t.resolve=t.resolve||{},t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}],r.when(e,o[e]).when(e+"/o/:okato",t)})}])}(),function(){"use strict";angular.module("informationPage",["ngRoute"]).config(["$routeProvider",function(r){var o={"/information":{redirectTo:function(e,t){return t.replace("/information","/help")}},"/information/mobile":{redirectTo:function(e,t){return t.replace("/information/mobile","/help/mobile")}},"/help/mobile":{controller:"informationMobileAppCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/information/information-mobile-app-mob-0aefc3cfae.html":"/tpl/information/information-mobile-app-pad-2d06376b13.html":"/tpl/information/information-mobile-app-11af9f162e.html"),resolve:{loadInformationCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/information-c724d46d09.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/information-min-f121b430b2.1682593322983.js")}]}},"/help/calculator-allowance":{controller:"calculatorAllowanceCtrl",templateUrl:window.templatePath+"/tpl/information/calculator-allowance-f15700daf2.html",resolve:{loadInformationCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/information-c724d46d09.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/information-min-f121b430b2.1682593322983.js")}]}},"/information/mobile/os-detect":{redirectTo:function(e,t){return t.replace("/information/mobile/os-detect","/help/mobile/os-detect")}},"/help/mobile/os-detect":{controller:"informationMobileAppDetectOsCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/information/information-mobile-app-os-detect-mob-de83f84a8a.html":"/tpl/information/information-mobile-app-os-detect-pad-de83f84a8a.html":"/tpl/information/information-mobile-app-os-detect-270821bb48.html"),resolve:{loadInformationCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/information-c724d46d09.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/information-min-f121b430b2.1682593322983.js")}]}},"/information/mobile/sms-:result":{redirectTo:function(e,t){return t.replace("/information/mobile/","/help/mobile/")}},"/help/mobile/sms-:result":{controller:"informationMobileSmsResultCtrl",templateUrl:window.templatePath+"/tpl/information/information-mobile-result-0c87685b6a.html",resolve:{loadInformationCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/information-c724d46d09.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/information-min-f121b430b2.1682593322983.js")}]}},"/information/:linkUrl:address|payment|personal|news|obratitsya_v_vedomstvo":{redirectTo:function(e){return"/help/"+e.linkUrl}},"/help/:linkUrl:address|payment|personal|news|obratitsya_v_vedomstvo|obratitsya_v_pos|obratitsya_skoraya|obratitsya_v_pravitelstvo|obratitsya_universal|obratitsya_viplaty|":{controller:"informationSubCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/information/information-sub-mob-f30b287964.html":"/tpl/information/information-sub-pad-c4da1c56c5.html":"/tpl/information/information-8e54624172.html"),resolve:{loadInformationCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/information-c724d46d09.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/information-min-f121b430b2.1682593322983.js")}]}},"/information/obratitsya_v_vedomstvo/:code":{redirectTo:function(e,t){return t.replace("/information/news/","/help/obratitsya_v_vedomstvo/")}},"/information/news/:code":{redirectTo:function(e,t){return t.replace("/information/news/","/help/news/")}},"/help/news/:code":{controller:"informationNewsCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/information/information-news-adv-mob-7ae4bcc6c7.html":"/tpl/information/information-news-adv-pad-20540f0464.html":"/tpl/information/information-news-adv-6aa993896e.html"),resolve:{loadInformationCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/information-c724d46d09.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/information-min-f121b430b2.1682593322983.js")}]}},"/help/:linkUrl:obratitsya_v_vedomstvo/:code":{controller:"informationSubCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/information/information-sub-mob-f30b287964.html":"/tpl/information/information-sub-pad-c4da1c56c5.html":"/tpl/information/information-8e54624172.html"),resolve:{loadInformationCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/information-c724d46d09.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/information-min-f121b430b2.1682593322983.js")}]}}},n=["obratitsya_v_vedomstvo","obratitsya_v_pos","obratitsya_skoraya","obratitsya_v_pravitelstvo","obratitsya_universal","obratitsya_viplaty"].join("|"),i=["/information","/information/mobile","/information/mobile/os-detect","/information/mobile/sms-:result","/information/:linkUrl:address|payment|personal|news|"+n,"/information/news/:code"];Object.keys(o).forEach(function(e){var t=o[e];-1===i.indexOf(e)?(t.resolve=t.resolve||{},t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}]):e==="/information/:linkUrl:address|payment|personal|news|"+n&&(t.redirectTo=function(e){return"/help/"+e.linkUrl+"/1/info/o/"+e.okato}),r.when(e,o[e]).when(e+"/o/:okato",t)})}])}(),function(){"use strict";angular.module("landingPages",["ngRoute"]).config(["$routeProvider",function(r){var o={"/foreign-citizen":{controller:"landingIgCtrl",template:"<div data-ng-include=\"'"+window.templatePath+"/tpl/landings/ig-' + $root.lang + '.html'\"></div>",resolve:{loadLandingsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/landings-69b3bd73f1.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/landings-min-70ef5414cf.1682593322983.js")}]}},"/pay":{controller:window.userId?"landingPaymentAuthCtrl":"landingPaymentCtrl",reloadOnSearch:!1,templateUrl:function(e){return window.userId?window.templatePath+"/tpl/landings/payAuth/payment-auth-7cf9121e89.html":window.templatePath+"/tpl/landings/payment-ee7aebe56c.html"},resolve:{loadLandingsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+(window.userId?"/js/js/landingPay-49fc2eb79a.1682593322983.js":"/js/js/landings-69b3bd73f1.1682593322983.js"),e.staticDomainUrl+(window.userId?"htdocs/js/js/landingPay-49fc2eb79a.1682593322983.js":"htdocs/js/lib/landings-min-70ef5414cf.1682593322983.js"))}],loadFormProfileCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/lib/profile-info-4eaecc6884.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/profile-info-min-a1f574eda0.1682593322983.js")}]}},"/migrant":{controller:"landingUkraineCtrl",templateUrl:window.templatePath+"/tpl/landings/ukraine-15cb8fc2cd.html",resolve:{loadLandingsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/landings-69b3bd73f1.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/landings-min-70ef5414cf.1682593322983.js")}]}},"/new":{controller:"landingMainCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()?"/tpl/landings/main-phone-c97f1fc2ca.html":"/tpl/landings/main-pad-1017b133da.html":"/tpl/landings/main-23fe3b8372.html"),resolve:{loadLandingsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/landings-69b3bd73f1.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/landings-min-70ef5414cf.1682593322983.js")}]}},"/rating":{controller:"landingPopularServicesCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()?"/tpl/landings/popular-rating-mob-51fd0ab703.html":"/tpl/landings/popular-rating-pad-fbd6478c65.html":"/tpl/landings/popular-rating-a7f5a18a1f.html"),resolve:{loadLandingsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/landings-69b3bd73f1.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/landings-min-70ef5414cf.1682593322983.js")}]}},"/eds":{controller:"landingEdsCtrl",templateUrl:window.templatePath+(window.mobileVersion,"/tpl/landings/eds-8cfd13214f.html"),resolve:{loadLandingsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/landings-69b3bd73f1.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/landings-min-70ef5414cf.1682593322983.js")}]}},"/quiz-minzdrav":{controller:"landingQuizMinzdrav",templateUrl:window.templatePath+"/tpl/landings/quiz-minzdrav-9771d07504.html",resolve:{loadLandingsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/landings-69b3bd73f1.1682593322983.js",window.templatePath+"/js/lib/landings-min-70ef5414cf.1682593322983.js")}]}},"/ppn2018":{controller:"ppn2018Ctrl",templateUrl:window.templatePath+"/tpl/landings/ppn2018-1551197bb6.html",resolve:{loadLandingsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/landings-69b3bd73f1.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/landings-min-70ef5414cf.1682593322983.js")}]}},"/ppn2020":{controller:"ppn2020Ctrl",templateUrl:window.templatePath+"/tpl/landings/ppn2020-68e3f440a0.html",resolve:{loadLandingsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/landings-69b3bd73f1.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/landings-min-70ef5414cf.1682593322983.js")}]}},"/constitution2020/amendment":{controller:"amendmentCtrl",templateUrl:window.templatePath+"/tpl/landings/amendment-41aab2148e.html",resolve:{loadLandingsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/landings-69b3bd73f1.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/landings-min-70ef5414cf.1682593322983.js")}]}},"/constitution2020":{controller:"constitution2020Ctrl",templateUrl:window.templatePath+"/tpl/landings/constitution2020-bf85446cf0.html",resolve:{loadLandingsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/landings-69b3bd73f1.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/landings-min-70ef5414cf.1682593322983.js")}]}},"/coronavirus":{controller:"coronavirusCtrl",templateUrl:window.templatePath+"/tpl/landings/coronavirus-8b329f29bf.html",redirectTo:function(){return"/"}},"/coronavirus/freecatalog":{controller:"coronavirusServiceCtrl",templateUrl:window.templatePath+"/tpl/landings/coronavirus-service-18e420d557.html",redirectTo:function(){return"/"}},"/digitalpass":{controller:"digitalpassCtrl",templateUrl:window.templatePath+"/tpl/landings/digitalpass-3051682d79.html",resolve:{loadLandingsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/landings-69b3bd73f1.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/landings-min-70ef5414cf.1682593322983.js")}]}},"/socialsupport":{controller:"socialSupportCtrl",templateUrl:window.templatePath+"/tpl/landings/socialSupport-f50c148b8d.html",resolve:{loadLandingsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/landings-69b3bd73f1.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/landings-min-70ef5414cf.1682593322983.js")}]}},"/domestic_abuse":{controller:"domesticAbuseCtrl",templateUrl:window.templatePath+"/tpl/landings/domesticAbuse-e8e7fd97c0.html",resolve:{loadLandingsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/landings-69b3bd73f1.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/landings-min-70ef5414cf.1682593322983.js")}]}},"/vezemdomoy_rf":{controller:"vezemdomoyRfCtrl",templateUrl:window.templatePath+"/tpl/landings/vezemdomoy_rf-6179e9e2dd.html",resolve:{loadLandingsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/landings-69b3bd73f1.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/landings-min-70ef5414cf.1682593322983.js")}]}},"/edg2020":{controller:"edg2020Ctrl",templateUrl:window.templatePath+"/tpl/landings/edg2020-840a934728.html",resolve:{loadLandingsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/landings-69b3bd73f1.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/landings-min-70ef5414cf.1682593322983.js")}]}},"/gospost":{controller:"gospostCtrl",templateUrl:window.templatePath+"/tpl/landings/gospost-3db26db2cb.html",resolve:{loadLandingsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/landings-69b3bd73f1.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/landings-min-70ef5414cf.1682593322983.js")}]}}};Object.keys(o).forEach(function(e){var t=o[e];t.resolve=t.resolve||{},t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}],r.when(e,o[e]).when(e+"/o/:okato",t)})}])}(),function(){"use strict";angular.module("partnersPages",["ngRoute"]).config(["$routeProvider",function(e){var t;"PARTNERS"===window.viewType&&(t=window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/partners/partners-categories-mob-0943cde91f.html":"/tpl/partners/partners-categories-pad-108944e989.html":"/tpl/partners/partners-categories-8308f197b4.html"),e.when("/",{controller:"partnersMainCtrl",templateUrl:window.templatePath+"/tpl/landings/partners-52e1186bb9.html",resolve:{loadPartnersMainCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/partners/partners-2f434b27d7.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/partners-min-7df62bd1eb.1682593322983.js")}]}}).when("/catalog",{controller:"partnersCategoriesCtrl",resolve:{loadPartnersInnerCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/partners/partners-2f434b27d7.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/partners-min-7df62bd1eb.1682593322983.js")}]},templateUrl:t}).when("/docs",{controller:"partnersDocsCtrl",templateUrl:window.templatePath+"/tpl/partners/partners_all_documents-40caf141c9.html",resolve:{loadPartnersInnerCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/partners/partners-2f434b27d7.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/partners-min-7df62bd1eb.1682593322983.js")}]}}).when("/news",{controller:"partnersNewsCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/partners/partners-news-all-mob-e120922f53.html":"/tpl/partners/partners-news-all-pad-703f66a252.html":"/tpl/partners/partners-news-all-ddef85c5d4.html"),resolve:{loadPartnersInnerCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/partners/partners-2f434b27d7.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/partners-min-7df62bd1eb.1682593322983.js")}]}}).when("/news/:code",{controller:"partnersNewsDetailCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/partners/news-detail-mob-62a786cbb7.html":"/tpl/partners/news-detail-pad-480f0e4f25.html":"/tpl/partners/news-detail-25c072aa4a.html"),resolve:{loadPartnersInnerCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/partners/partners-2f434b27d7.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/partners-min-7df62bd1eb.1682593322983.js")}]}}))}])}(),function(){"use strict";angular.module("landingPlayerPage",["ngRoute"]).config(["$routeProvider",function(t){"PARTNERS"==window.viewType?t.when("/catalog/:id",{controller:"landingPlayerCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/landingPlayer/landing-player-mob-de74ad1c48.html":"/tpl/landingPlayer/landing-player-pad-1d31376c14.html":"/tpl/landingPlayer/landing-player-e9e3b28305.html"),resolve:{loadLandingPlayer:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/landingPlayer/landingPlayer-78ab0082ae.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/landingPlayer-min-5977f3c5a0.1682593322983.js")}]}}).when("/catalog/:id/:code?",{controller:"landingPlayerCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/landingPlayer/landing-player-mob-de74ad1c48.html":"/tpl/landingPlayer/landing-player-pad-1d31376c14.html":"/tpl/landingPlayer/landing-player-e9e3b28305.html"),resolve:{loadLandingPlayer:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/landingPlayer/landingPlayer-78ab0082ae.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/landingPlayer-min-5977f3c5a0.1682593322983.js")}]}}):(window.isEmbedded?t.when("/mobile/situation/:id*",{controller:"landingPlayerCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?"/tpl/landingPlayer/landing-player-mp-1ecb92b4a3.html":"/tpl/landingPlayer/landing-player-e9e3b28305.html"),reloadOnSearch:!1,resolve:{checkUserType:["userTypeService",function(e){e.redirectToMain()}]}}):t.when("/situation/:id*",{controller:"landingPlayerCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/landingPlayer/landing-player-mob-de74ad1c48.html":"/tpl/landingPlayer/landing-player-pad-1d31376c14.html":"/tpl/landingPlayer/landing-player-e9e3b28305.html"),reloadOnSearch:!1,resolve:{checkUserType:["userTypeService",function(e){e.redirectToMain()}],loadLandingPlayer:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/lib/landingPlayer-78ab0082ae.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/landingPlayer-min-5977f3c5a0.1682593322983.js")}]}}),window.landingPagesUrl&&window.landingPagesUrl.split(",").forEach(function(e){t.when(e,{controller:"landingPlayerCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/landingPlayer/landing-player-mob-de74ad1c48.html":"/tpl/landingPlayer/landing-player-pad-1d31376c14.html":"/tpl/landingPlayer/landing-player-e9e3b28305.html"),reloadOnSearch:!1,resolve:{checkUserType:["userTypeService",function(e){e.redirectToMain()}],return:["GetLazyLoadFile","$rootScope",function(e,t){return e.get(window.templatePath+"/js/js/landingPlayer/landingPlayer-78ab0082ae.1682593322983.js",t.staticDomainUrl+"htdocs/js/lib/landingPlayer-min-5977f3c5a0.1682593322983.js")}]}})}))}])}(),function(){"use strict";angular.module("faqsPage",["ngRoute"]).config(["$routeProvider",function(r){var o={"/help":{controller:"faqsMainCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()?"/tpl/faqs/faqMain-mob-47626010e0.html":"/tpl/faqs/faqMain-pad-7462dd8d4f.html":"/tpl/faqs/faqMain-b717e62056.html"),resolve:{loadFaqsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/faqs-7a72da6e5c.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/faqs-min-4562209b69.1682593322983.js")}]}},"/help/faq/:code?/:id?":{controller:"faqAnswersCtrl",resolve:{checkOldLinkService:["CMSService",function(e){return e.checkOldLink("help/faq/")}],loadFaqsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/faqs-7a72da6e5c.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/faqs-min-4562209b69.1682593322983.js")}]},templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()?"/tpl/faqs/faqAnswers-mob-f587cff702.html":"/tpl/faqs/faqAnswers-pad-a850eff65a.html":"/tpl/faqs/faqAnswers-954af00a0f.html")}};Object.keys(o).forEach(function(e){var t=o[e];t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}],r.when(e,o[e]).when(e+"/o/:okato",t)})}])}(),function(){"use strict";angular.module("quizPage",["ngRoute"]).config(["$routeProvider",function(r){var o={"/quiz/:orderId":{controller:"quizCtrl",templateUrl:window.templatePath+"/tpl/quiz/"+(SmartPhone.isAny()?SmartPhone.isPhone()?"quiz-mob.html":"quiz-pad.html":"quiz.html"),resolve:{loadQuizCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/quiz-1d1b23650e.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/quiz-min-a906c68428.1682593322983.js")}]}},"/quiz/:passportId/:targetId":{controller:"quizCtrl",templateUrl:window.templatePath+"/tpl/quiz/"+(SmartPhone.isAny()?SmartPhone.isPhone()?"quiz-mob.html":"quiz-pad.html":"quiz.html"),resolve:{loadQuizCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/quiz-1d1b23650e.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/quiz-min-a906c68428.1682593322983.js")}]}}};Object.keys(o).forEach(function(e){var t=o[e];t.resolve=t.resolve||{},t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}],r.whenAuthorized(e,o[e]).whenAuthorized(e+"/o/:okato",t)})}])}(),function(){"use strict";angular.module("mapPage",["ngRoute"]).config(["$routeProvider",function(e){"MAP"===window.viewType&&e.when("/layer-404",{controller:"mapPageLayerNotExistCtrl",templateUrl:window.templatePath+"/tpl/mapPage/layer-404-130e7a1f2a.html",reloadOnSearch:!1,resolve:{mapPageLayerNotExistCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/lib/map-page-e101c83e2e.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/map-page-min-38dfe9eaf4.1682593322983.js")}]}}).when("/",{controller:"mapPageMainCtrl",reloadOnSearch:!1,redirectTo:function(e,t,r){return window.availableMapLayers&&window.availableMapLayers.length?"/map/"+(window.availableMapLayers.some(function(e){return"co"===e.code})?"co":window.availableMapLayers[0].code)+(r.filter?"?filter="+encodeURIComponent(r.filter):""):"/layer-404"}}).when("/:layerCode",{controller:"mapPageMainCtrl",reloadOnSearch:!1,redirectTo:function(t,e,r){return window.availableMapLayers&&window.availableMapLayers.length&&window.availableMapLayers.some(function(e){return e.code===t.layerCode})?"/map/"+t.layerCode+(r.filter?"?filter="+encodeURIComponent(r.filter):""):"/layer-404"}}).when("/:mapLayout/:layerCode",{controller:"mapPageMainCtrl",templateUrl:window.templatePath+"/tpl/mapPage/map-page-1e5032bd6c.html",reloadOnSearch:!1,redirectTo:function(t,e){return["list","map"].includes(t.mapLayout.toLowerCase())&&window.availableMapLayers&&window.availableMapLayers.length&&window.availableMapLayers.some(function(e){return e.code===t.layerCode})?void 0:"/layer-404"},resolve:{mapPageMainCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/lib/map-page-e101c83e2e.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/map-page-min-38dfe9eaf4.1682593322983.js")}]}})}])}(),function(){"use strict";angular.module("requests",["ngRoute"]).config(["$routeProvider",function(r){var o={"/requests":{controller:"requestsCtrl",templateUrl:window.templatePath+(SmartPhone.isAny()?SmartPhone.isPhone()||SmartPhone.isIPhone()?"/tpl/requests/requests-mob-d41d8cd98f.html":"/tpl/requests/requests-pad-d41d8cd98f.html":"/tpl/requests/requests-9c078b300a.html"),reloadOnSearch:!1,resolve:{checkUserType:["userTypeService",function(e){e.redirectToMain()}],loadRequestsCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/requests-fb7088fe40.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/requests-min-922d3d3a7c.1682593322983.js")}]}}};Object.keys(o).forEach(function(e){var t=o[e];t.resolve=t.resolve||{},t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}],r.whenAuthorized(e,o[e]).whenAuthorized(e+"/o/:okato",t)})}])}(),function(){"use strict";angular.module("universityPage",["ngRoute"]).config(["$routeProvider",function(e){}])}(),function(){"use strict";angular.module("fsspProceedJud",["ngRoute","ui.mask"]).config(["$routeProvider",function(r){var o={"/orders/fssp/result/:id":{controller:"fsspProceedJudInfo",templateUrl:window.templatePath+"/tpl/fsspProceedJud/"+(SmartPhone.isAny()&&SmartPhone.isPhone(),"fsspProceedJud.html"),resolve:{loadPfrCtrl:["$rootScope","GetLazyLoadFile",function(e,t){return t.get(window.templatePath+"/js/js/fssp-proceed-jud-9f3bdcacd7.1682593322983.js",e.staticDomainUrl+"htdocs/js/lib/fssp-proceed-jud-min-49929d051a.1682593322983.js")}]}}};Object.keys(o).forEach(function(e){var t=o[e];"/10042/form"!==e&&(t.resolve=t.resolve||{},t.resolve.checkRegionCtrl=["$rootScope","$route",function(e,t){e.checkRegionCtrl(t.current.params)}]),r.whenAuthorized(e,o[e]).whenAuthorized(e+"/o/:okato",t)})}])}();